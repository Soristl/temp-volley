--[[ src/balls.lua ]]--

local balls = {
  [1] = { id = 6, isImage = false, image = '', name = 'Default ball' },
  [2] = { id = 608, isImage = false, image = '', name = 'Futuristic ball'},
  [3] = { id = 611, isImage = false, image = '', name = 'Dino egg ball'},
  [4] = { id = 612, isImage = false, image = '', name = 'Basketball' },
  [5] = { id = 616, isImage = false, image = '', name = 'Earth ball' },
  [6] = { id = 619, isImage = false, image = '', name = 'Poisoned apple ball' },
  [7] = { id = 621, isImage = false, image = '', name = 'Snow globe ball' },
  [8] = { id = 626, isImage = false, image = '', name = 'Bubble ball' },
  [9] = { id = 630, isImage = false, image = '', name = 'Moon ball' },
  [10] = { id = 635, isImage = false, image = '', name = 'Crystal ball' },
  [11] = { id = 6, isImage = true, image = '18fd18e2334.png', name = 'White Volley ball' },
  [12] = { id = 6, isImage = true, image = '18fd18e5dc6.png', name = 'Original Volley ball' },
  [13] = { id = 604, isImage = true, image = '197d9275c53.png', name = 'Morocco ball' },
  [14] = { id = 604, isImage = false, image = '', name = 'Soccer ball' },
  [15] = { id = 6, isImage = true, image = '19a63e144c6.png', name = 'Uruguay ball'}
  -- [99] = {
  --   id = 6,
  --   isImage = no,
  --   image = '',
  --   name = 'Custom ball'
  -- }
}



--[[ src/maps.lua ]]--

local customMaps = {
  [1] = {
    [1] = '@7976180',
    [2] = '@7976181',
    [3] = 'Water barrier',
    [4] = 'Refletz#6472',
    [6] = '19554042aaf.png'
  },
  [2] = {
    [1] = '@7976183',
    [2] = '@7976184',
    [3] = 'Circle grounds on the sky',
    [4] = 'Refletz#6472',
    [6] = '1955400e807.png'
  },
  [3] = {
    [1] = '@7976186',
    [2] = '@7976187',
    [3] = 'Trampoline on the edges',
    [4] = 'Refletz#6472',
    [6] = '19554039e06.png'
  },
  [4] = {
    [1] = '@7976188',
    [2] = '@7976189',
    [3] = 'Invisible rectangles',
    [4] = 'Refletz#6472',
    [6] = '19554020158.png'
  },
  [5] = {
    [1] = '@7976190',
    [2] = '@7976191',
    [3] = 'Water cannon',
    [4] = 'Refletz#6472',
    [6] = '19554044221.png'
  },
  [6] = {
    [1] = '@7976192',
    [2] = '@7976193',
    [3] = 'Default',
    [4] = 'Refletz#6472',
    [6] = '19539e5756b.png'
  },
  [7] = {
    [1] = '@7976194',
    [2] = '@7976195',
    [3] = 'Ice barrier',
    [4] = '+Mimounaaa#0000',
    [6] = '1955401d276.png'
  },
  [8] = {
    [1] = '@7976196',
    [2] = '@7976197',
    [3] = 'The floor is chocolate',
    [4] = 'Refletz#6472',
    [6] = '1955402f9ee.png'
  },
  [9] = {
    [1] = '@7976198',
    [2] = '@7976199',
    [3] = 'No jump',
    [4] = 'Deteraprio#4457',
    [6] = '19539e5756b.png'
  },
  [10] = {
    [1] = '@7976200',
    [2] = '@7976201',
    [3] = 'Collision',
    [4] = 'Deteraprio#4457',
    [6] = '19539e5756b.png'
  },
  [11] = {
    [1] = '@7976202',
    [2] = '@7976203',
    [3] = 'Top player',
    [4] = 'Deteraprio#4457',
    [6] = '195540357b1.png'
  },
  [12] = {
    [1] = '@7976204',
    [2] = '@7976205',
    [3] = 'Inclined',
    [4] = 'Deteraprio#4457',
    [6] = '1955401e9e8.png'
  },
  [13] = {
    [1] = '@7976206',
    [2] = '@7976207',
    [3] = 'Trambolines in the sky',
    [4] = 'Kralizmox#0000',
    [6] = '19554036f23.png'
  },
  [14] = {
    [1] = '@7976208',
    [2] = '@7976209',
    [3] = 'Rotating trampolines',
    [4] = 'Artgir#0000',
    [6] = '19554029c25.png'
  },
  [15] = {
    [1] = '@7976210',
    [2] = '@7976211',
    [3] = 'Black water',
    [4] = 'Asdfghjkkk#8564',
    [6] = '1955400b924.png'
  },
  [16] = {
    [1] = '@7976212',
    [2] = '@7976213',
    [3] = 'Chaos',
    [4] = 'Raf02#4942',
    [6] = '1955400d095.png'
  },
  [17] = {
    [1] = '@7976214',
    [2] = '@7976215',
    [3] = 'Cowebs',
    [4] = 'Hxejss#7104',
    [6] = '1955400ff78.png'
  },
  [18] = {
    [1] = '@7976216',
    [2] = '@7976217',
    [3] = 'The floor is lava',
    [4] = 'Kralizmox#0000',
    [6] = '195540328d1.png'
  },
  [19] = {
    [1] = '@7976218',
    [2] = '@7976219',
    [3] = 'Black water with chocolate floor',
    [4] = 'Asdfghjkkk#8564',
    [6] = '1955400a1b1.png'
  },
  [20] = {
    [1] = '@7976220',
    [2] = '@7976221',
    [3] = 'Trampoline rhombuses',
    [4] = 'Ppoppohaejuseyo#2315',
    [6] = '19554038694.png'
  },
  [21] = {
    [1] = '@7976222',
    [2] = '@7976223',
    [3] = 'Honeymoon',
    [4] = 'Wnawn#0000',
    [6] = '19554018c22.png'
  },
  [22] = {
    [1] = '@7976224',
    [2] = '@7976225',
    [3] = 'Black water (small)',
    [4] = 'Asdfghjkkk#8564',
    [6] = '19554008a40.png'
  },
  [23] = {
    [1] = '@7976226',
    [2] = '@7976227',
    [3] = 'Kst small',
    [4] = 'Aeselia#9926',
    [6] = '195540218e1.png'
  },
  [24] = {
    [1] = '@7976228',
    [2] = '@7976229',
    [3] = 'Date',
    [4] = 'Ppoppohaejuseyo#2315',
    [6] = '19554012e5d.png'
  },
  [25] = {
    [1] = '@7976230',
    [2] = '@7976231',
    [3] = 'Snowy Mountains',
    [4] = 'Hxejss#7104',
    [6] = '1955402cb0a.png'
  },
  [26] = {
    [1] = '@7976232',
    [2] = '@7976233',
    [3] = 'Eclipse',
    [4] = 'Lacoste#8972',
    [6] = '195540145dc.png'
  },
  [27] = {
    [1] = '@7976234',
    [2] = '@7976235',
    [3] = 'Small bat 2',
    [4] = 'Tanatosl#0000 and Tanarchosl#4785',
    [6] = '1955402b39a.png'
  },
  [28] = {
    [1] = '@7976236',
    [2] = '@7976237',
    [3] = 'Very small ice barrier and mice collision',
    [4] = 'Kralizmox#0000',
    [6] = '1955403fbce.png'
  },
  [29] = {
    [1] = '@7976238',
    [2] = '@7976239',
    [3] = 'Uranus is cold',
    [4] = 'Tanatosl#0000 and Tanarchosl#4785',
    [6] = '1955403e45c.png'
  },
  [30] = {
    [1] = '@7976240',
    [2] = '@7976241',
    [3] = 'Lacostes',
    [4] = 'Tanatosl#0000 and Milkavegeta#6450 and Tanarchosl#4785',
    [6] = '195540255d2.png'
  },
  [31] = {
    [1] = '@7976242',
    [2] = '@7976243',
    [3] = 'Ice barrier booster',
    [4] = 'Kralizmox#0000',
    [6] = '1955401bb06.png'
  },
  [32] = {
    [1] = '@7976244',
    [2] = '@7976245',
    [3] = 'Lightness and Darkness',
    [4] = 'Kralizmox#0000',
    [6] = '19554026d42.png'
  },
  [33] = {
    [1] = '@7976246',
    [2] = '@7976247',
    [3] = 'Cyberpink 2',
    [4] = 'Tanatosl#0000',
    [6] = '195540116ec.png'
  },
  [34] = {
    [1] = '@7976248',
    [2] = '@7976249',
    [3] = 'Volley 2.0',
    [4] = 'Refletz#6472',
    [6] = '1955404133e.png'
  },
  [35] = {
    [1] = '@7976250',
    [2] = '@7976251',
    [3] = 'Soccer',
    [4] = 'Refletz#6472',
    [6] = '1955402e27a.png'
  },
  [36] = {
    [1] = '@7976252',
    [2] = '@7976253',
    [3] = 'Pink date',
    [4] = 'Ppoppohaejuseyo#2315',
    [6] = '195540284b2.png'
  },
  [37] = {
    [1] = '@7976254',
    [2] = '@7976255',
    [3] = 'The floor is kralizmox',
    [4] = 'Sfjoud#8638',
    [6] = '1955403115e.png'
  },
  [38] = {
    [1] = '@7976256',
    [2] = '@7976257',
    [3] = 'The Rainbow',
    [4] = 'Kralizmox#0000',
    [6] = '19554034040.png'
  },
  [39] = {
    [1] = '@7976258',
    [2] = '@7976259',
    [3] = 'Platforms',
    [4] = 'Refletz#6472',
    [6] = '196599446e1.png'
  },
  -- version 2.2.1
  [40] =
  {
    [1] = '@7976260',
    [2] = '@7976261',
    [3] = 'Some chords',
    [4] = 'Tanarchosl#4785 and Tanatosl#0000',
    [6] = '1984ac70c05.png'
  },
  [41] =
  {
    [1] = '@7976262',
    [2] = '@7976263',
    [3] = 'Revamped soccer',
    [4] = 'Tanarchosl#4785 and Tanatosl#0000',
    [6] = '1984ac7569a.png'
  },
  [42] =
  {
    [1] = '@7976264',
    [2] = '@7976265',
    [3] = 'Brazhell soccer',
    [4] = 'Tanarchosl#5748, Tanatosl#0000, Emperor#6297 and Basker#2338',
    [6] = '1984ac66b5a.png'
  },
  [43] =
  {
    [1] = '@7976266',
    [2] = '@7976267',
    [3] = 'No jump tower',
    [4] = 'Tanarchosl#5748 and Maferyjhonat#0000',
    [6] = '1984ac63277.png'
  },
  [44] = {
    [1] = '@7976268',
    [2] = '@7976269',
    [3] = 'Quad water cannon',
    [4] = 'Tanarchosl#4785 and K1ng#7286',
    [6] = '1984ac73e2e.png'
  },
  [45] = {
    [1] = '@7976270',
    [2] = '@7976271',
    [3] = 'Frozen desert soccer',
    [4] = 'Tanarchosl#4785 and Ramasevosaff#0000',
    [6] = '1984ac6cd89.png'
  },
  [46] = {
    [1] = '@7976272',
    [2] = '@7976273',
    [3] = 'Der Lifter',
    [4] = 'Tanatosl#0000 and Tanarchosl#4785',
    [6] = '1984ac686ce.png'
  },
  [47] = {
    [1] = '@7976274',
    [2] = '@7976275',
    [3] = 'Handball',
    [4] = 'Tanarchosl#4785 and Tanatosl#0000',
    [6] = '1984ac61a64.png'
  },
  -- version 2.2.2
  [48] = {
    [1] = '<C><P F="3" G="0,4" playerForce="1.03"/> <Z><S><S T="13" X="665" Y="240" L="20" P="0,0,0.3,0.2,0,0,0,0" o="214D44" c="4"/><S T="12" X="648" Y="280" L="10" H="290" P="0,0,0.3,0.2,-10,0,0,0" o="214D44" c="4"/><S T="13" X="192" Y="120" L="72" P="0,0,0.2,1,0,0,0,0" o="210054" c="2"/><S T="12" X="133" Y="293" L="15" H="70" P="0,0,0.3,0.2,45,0,0,0" o="214D44" c="4"/><S T="12" X="121" Y="255" L="15" H="60" P="0,0,0.3,0.2,-45,0,0,0" o="214D44" c="4"/><S T="12" X="120" Y="200" L="15" H="53" P="0,0,0.3,0.2,-45,0,0,0" o="214D44" c="4"/><S T="12" X="144" Y="170" L="15" H="70" P="0,0,0.3,0.2,45,0,0,0" o="214D44" c="4"/><S T="12" X="136" Y="230" L="15" H="60" P="0,0,0.3,0.2,45,0,0,0" o="214D44" c="4"/><S T="13" X="192" Y="120" L="54" P="0,0,0,0.2,0,0,0,0" o="310076" c="4"/><S T="12" X="400" Y="320" L="10" H="200" P="0,0,0,0.2,0,0,0,0" o="E2DB60"/><S T="12" X="136" Y="338" L="15" H="90" P="0,0,0.3,0.2,-45,0,0,0" o="214D44" c="4"/><S T="12" X="612" Y="120" L="96" H="96" P="0,0,0.3,1,-60,0,0,0" o="E7B500" c="2"/><S T="12" X="612" Y="120" L="96" H="96" P="0,0,0.3,1,-30,0,0,0" o="E7B500" c="2"/><S T="12" X="612" Y="120" L="96" H="96" P="0,0,0.3,1,0,0,0,0" o="E7B500" c="2"/><S T="12" X="400" Y="-135" L="840" H="20" P="0,0,0,0.2,0,0,0,0" o="FF0000" m=""/><S T="12" X="400" Y="-5" L="800" H="10" P="0,0,0,0.2,0,0,0,0" o="FF0000" c="3" m=""/><S T="12" X="400" Y="85" L="800" H="10" P="0,0,0.3,0.2,0,0,0,0" o="FF0000" c="3" m=""/><S T="12" X="400" Y="295" L="800" H="10" P="0,0,0.2,0.3,0,0,0,0" o="E2DB60" c="3"/><S T="1" X="400" Y="185" L="10" H="200" P="0,0,0,0.2,0,0,0,0" c="3" m="" friction="-100,-20"/><S T="12" X="140" Y="320" L="10" H="70" P="0,0,0.2,0.3,0,0,0,0" o="E2DB60" c="3"/><S T="12" X="540" Y="320" L="10" H="70" P="0,0,0.2,0.3,0,0,0,0" o="E2DB60" c="3"/><S T="12" X="680" Y="320" L="10" H="70" P="0,0,0.2,0.3,0,0,0,0" o="E2DB60" c="3"/><S T="12" X="280" Y="320" L="10" H="70" P="0,0,0.2,0.3,0,0,0,0" o="E2DB60" c="3"/><S T="12" X="400" Y="500" L="1600" H="300" P="0,0,0.3,0.2,0,0,0,0" o="6a7495" c="4" N=""/><S T="6" X="400" Y="400" L="800" H="100" P="0,0,0.1,0.2,0,0,0,0" c="3" N=""/><S T="12" X="316" Y="-129" L="20" H="200" P="0,0,0.2,0.2,0,0,0,0" o="6a7495" c="3"/><S T="12" X="407" Y="-133" L="20" H="200" P="0,0,0.2,0.2,0,0,0,0" o="6a7495" c="3"/><S T="12" X="363" Y="-92" L="20" H="100" P="0,0,0.2,0.2,90,0,0,0" o="6a7495" c="3"/><S T="12" X="360" Y="-206" L="20" H="100" P="0,0,0.2,0.2,90,0,0,0" o="6a7495" c="3"/><S T="13" X="612" Y="120" L="38" P="0,0,0.3,0.2,0,0,0,0" o="2C0F00" c="4"/><S T="13" X="612" Y="120" L="29" P="0,0,0.3,0.2,0,0,0,0" o="0F0500" c="4"/><S T="13" X="192" Y="120" L="36" P="0,0,0,0.2,0,0,0,0" o="47009E" c="4"/><S T="12" X="400" Y="530" L="840" H="20" P="0,0,0,0,0,0,0,0" o="FF0000" c="3" N="" m=""/><S T="9" X="400" Y="470" L="840" H="20" P="0,0,0,0,0,0,0,0" m="" archAcc="-1" archMax="1"/><S T="12" X="-10" Y="200" L="20" H="700" P="0,0,0.2,0.2,0,0,0,0" o="FF0000" N="" m=""/><S T="12" X="400" Y="470" L="10" H="140" P="0,0,0,0,0,0,0,0" o="FF0000" N="" m=""/><S T="12" X="810" Y="200" L="20" H="700" P="0,0,0.2,0.2,0,0,0,0" o="FF0000" N="" m=""/></S><D><P X="40" Y="348" T="307" P="1,0"/><P X="236" Y="350" T="297" P="1,0"/><P X="319" Y="351" T="298" P="1,1"/><P X="760" Y="351" T="306" P="1,1"/><P X="186" Y="350" T="241" P="1,0"/><P X="706" Y="350" T="242" P="1,1"/><P X="625" Y="352" T="242" P="1,1"/><P X="440" Y="351" T="243" P="1,1"/><P X="107" Y="350" T="244" P="1,1"/><P X="367" Y="350" T="244" P="1,1"/><P X="569" Y="350" T="245" P="1,1"/><P X="505" Y="350" T="245" P="1,0"/><P X="740" Y="136" T="219" P="0,1"/><P X="86" Y="115" T="221" P="0,0"/><P X="293" Y="144" T="220" P="0,0"/><P X="255" Y="28" T="220" P="0,0"/><P X="340" Y="130" T="131" C="21344B" P="0,0"/><P X="490" Y="130" T="131" C="1C2C48" P="0,0"/><P X="400" Y="145" T="43" P="0,0"/><T X="195" Y="135" spawn="1"/><T X="610" Y="135" spawn="1"/><DS X="365" Y="-141"/></D><O/><L/></Z></C>',
    [2] = '<C><P L="1200" F="3" G="0,4" mc=""/> <Z><S><S T="13" X="945" Y="260" L="14" P="0,0,0.1,0.1,0,0,0,0" o="124018" c="2" N=""/><S T="12" X="930" Y="264" L="10" H="191" P="0,0,0.1,0.1,-10,0,0,0" o="124018" c="2"/><S T="13" X="300" Y="120" L="79" P="0,0,0.2,1.2,0,0,0,0" o="210054" c="2"/><S T="12" X="263" Y="335" L="10" H="55" P="0,0,0.1,0.1,-45,0,0,0" o="214D44" c="2" N=""/><S T="12" X="265" Y="335" L="10" H="60" P="0,0,0.3,0.2,-45,0,0,0" o="214D44" c="4"/><S T="12" X="260" Y="200" L="10" H="70" P="0,0,0.1,0.1,-45,0,0,0" o="214D44" c="2"/><S T="12" X="275" Y="235" L="10" H="50" P="0,0,0.3,0.2,45,0,0,0" o="214D44" c="4"/><S T="12" X="260" Y="160" L="10" H="50" P="0,0,0.1,0.1,45,0,0,0" o="214D44" c="2"/><S T="13" X="300" Y="120" L="59" P="0,0,0,0.2,0,0,0,0" o="310076" c="4"/><S T="12" X="275" Y="300" L="10" H="70" P="0,0,0.1,0.1,45,0,0,0" o="214D44" c="2"/><S T="12" X="267" Y="260" L="10" H="60" P="0,0,0.1,0.1,-45,0,0,0" o="214D44" c="2"/><S T="12" X="900" Y="120" L="120" H="120" P="0,0,0.3,1.2,-60,0,0,0" o="E7B500" c="2"/><S T="12" X="900" Y="120" L="120" H="120" P="0,0,0.3,1.2,-30,0,0,0" o="E7B500" c="2"/><S T="12" X="900" Y="120" L="120" H="120" P="0,0,0.3,1.2,0,0,0,0" o="E7B500" c="2"/><S T="12" X="600" Y="-135" L="1240" H="20" P="0,0,0,0.2,0,0,0,0" o="FF0000" N="" m=""/><S T="12" X="600" Y="-5" L="1200" H="10" P="0,0,0,0.2,0,0,0,0" o="FF0000" c="3" m=""/><S T="12" X="600" Y="85" L="1200" H="10" P="0,0,0.3,0.2,0,0,0,0" o="FF0000" c="3" m=""/><S T="12" X="600" Y="295" L="1200" H="10" P="0,0,0.2,0.3,0,0,0,0" o="E2DB60" c="3"/><S T="1" X="600" Y="185" L="10" H="200" P="0,0,0,0.2,0,0,0,0" c="3" m="" friction="-100,-20"/><S T="12" X="600" Y="320" L="10" H="200" P="0,0,0,0.2,0,0,0,0" o="E2DB60"/><S T="12" X="200" Y="320" L="10" H="70" P="0,0,0.2,0.3,0,0,0,0" o="E2DB60" c="3"/><S T="12" X="1000" Y="320" L="10" H="70" P="0,0,0.2,0.3,0,0,0,0" o="E2DB60" c="3"/><S T="12" X="400" Y="320" L="10" H="70" P="0,0,0.2,0.3,0,0,0,0" o="E2DB60" c="3"/><S T="12" X="800" Y="320" L="10" H="70" P="0,0,0.2,0.3,0,0,0,0" o="E2DB60" c="3"/><S T="12" X="600" Y="500" L="2000" H="300" P="0,0,0.3,0.2,0,0,0,0" o="6a7495" c="4" N=""/><S T="6" X="600" Y="400" L="1200" H="100" P="0,0,0.1,0.2,0,0,0,0" c="3" N=""/><S T="12" X="600" Y="470" L="10" H="140" P="0,0,0,0,0,0,0,0" o="FF0000" c="3" N="" m=""/><S T="12" X="-10" Y="200" L="20" H="700" P="0,0,0.2,0.2,0,0,0,0" o="FF0000" N="" m=""/><S T="12" X="1210" Y="200" L="20" H="700" P="0,0,0.2,0.2,0,0,0,0" o="FF0000" N="" m=""/><S T="12" X="316" Y="-129" L="20" H="200" P="0,0,0.2,0.2,0,0,0,0" o="6a7495" c="3"/><S T="12" X="407" Y="-133" L="20" H="200" P="0,0,0.2,0.2,0,0,0,0" o="6a7495" c="3"/><S T="12" X="363" Y="-92" L="20" H="100" P="0,0,0.2,0.2,90,0,0,0" o="6a7495" c="3"/><S T="12" X="360" Y="-206" L="20" H="100" P="0,0,0.2,0.2,90,0,0,0" o="6a7495" c="3"/><S T="13" X="900" Y="120" L="45" P="0,0,0.3,0.2,0,0,0,0" o="2C0F00" c="4"/><S T="13" X="900" Y="120" L="35" P="0,0,0.3,0.2,0,0,0,0" o="0F0500" c="4"/><S T="13" X="300" Y="120" L="40" P="0,0,0,0.2,0,0,0,0" o="47009E" c="4"/><S T="12" X="600" Y="530" L="1200" H="20" P="0,0,0.2,0.3,0,0,0,0" o="FF0000" c="3" N="" m=""/><S T="9" X="600" Y="470" L="1200" H="20" P="0,0,0,0,0,0,0,0" m="" archAcc="-1" archMax="1"/></S><D><P X="42" Y="348" T="307" P="1,0"/><P X="450" Y="350" T="297" P="1,0"/><P X="575" Y="351" T="298" P="1,1"/><P X="258" Y="351" T="300" P="1,0"/><P X="340" Y="351" T="300" P="1,0"/><P X="1020" Y="350" T="283" P="1,0"/><P X="1043" Y="350" T="283" P="1,0"/><P X="643" Y="351" T="306" P="1,0"/><P X="165" Y="351" T="241" P="1,0"/><P X="696" Y="350" T="242" P="1,0"/><P X="900" Y="352" T="242" P="1,0"/><P X="955" Y="352" T="242" P="1,0"/><P X="756" Y="351" T="243" P="1,0"/><P X="105" Y="350" T="244" P="1,1"/><P X="510" Y="350" T="244" P="1,1"/><P X="850" Y="350" T="245" P="1,0"/><P X="1095" Y="350" T="245" P="1,0"/><P X="1165" Y="348" T="306" P="1,0"/><P X="1020" Y="91" T="219" P="0,0"/><P X="191" Y="63" T="221" P="0,0"/><P X="393" Y="158" T="220" P="0,0"/><P X="188" Y="164" T="220" P="0,0"/><P X="460" Y="150" T="131" C="253B4F" P="0,0"/><P X="750" Y="150" T="131" C="5D6C80" P="0,0"/><P X="600" Y="135" T="43" P="0,0"/><T X="300" Y="135" spawn="1"/><T X="905" Y="135" spawn="1"/><DS X="365" Y="-141"/></D><O/><L/></Z></C>',
    [3] = 'Secret garden',
    [4] = 'Tanarchosl#4785 and Doctor#3475',
    [6] = '1984ac6e71b.png'
  },
  [49] = {
    [1] = '@7976276',
    [2] = '@7976277',
    [3] = 'Portal soccer',
    [4] = 'Tanarchosl#4785 and Tornaduuzin#4305',
    [6] = '1984ac65465.png'
  },
  [50] = {
    [1] = '@7976278',
    [2] = '@7976279',
    [3] = 'Water cannon soccer',
    [4] = 'Tanarchosl#4785 and K1ng#7286',
    [6] = '1984ac7252c.png'
  },
  [51] = 
  {
    [1] = '@7976280',
    [2] = '@7976281',
    [3] = 'Eeerie basement',
    [4] = 'Tanarchosl#4785',
    [6] = '1984ac69df5.png'
  },
  [52] = {
    [1] = '@7976282',
    [2] = '@7976283',
    [3] = 'Impostor',
    [4] = 'Ppoppohaejuseyo#2315',
    [6] = '198a96b6d56.png'
  },
  [53] = {
    [1] = '@7976284',
    [2] = '@7976285',
    [3] = 'Ocean',
    [4] = 'Ppoppohaejuseyo#2315',
    [6] = '198a96b57ff.png'
  }
  -- [99] = {
  --   [1] = 'small map',
  --   [2] = 'large map',
  --   [3] = 'map name',
  --   [4] = 'author name',
  --   [6] = '19539e5756b.png'
  -- },
}

local customMapsThreeTeamsMode = {
  [1] = {
    [1] = '<C><P L="1800" G="0,4" MEDATA="15,1;;;;-0;0:::1-" F="3" /><Z><S><S Y="400" T="7" P="0,0,0.1,0.2,0,0,0,0" H="100" L="1800" X="900" c="3" N="" /><S Y="430" T="9" P="0,0,0,0,0,0,0,0" L="1600" H="10" X="800" /><S Y="350" T="1" P="0,0,0,0.2,0,0,0,0" L="10" H="200" X="600" /><S Y="455" T="12" P="0,0,0.3,0.2,0,0,0,0" L="800" o="6a7495" X="400" H="10" /><S Y="200" T="12" m="" P="0,0,0.2,0.2,0,0,0,0" L="20" o="FF0000" X="-10" H="2000" /><S Y="45" T="12" P="0,0,0.3,0.2,0,0,0,0" H="105" L="100" o="324650" X="900" c="4" /><S Y="45" T="12" P="0,0,0.3,0.2,0,0,0,0" H="105" L="100" o="324650" X="1400" c="4" /><S Y="200" T="12" m="" P="0,0,0.2,0.2,0,0,0,0" L="20" o="FF0000" X="1810" H="2000" /><S Y="45" T="12" P="0,0,0.3,0.2,0,0,0,0" H="105" L="100" o="324650" X="400" c="4" /><S Y="-5" T="12" m="" P="0,0,0,0,0,0,0,0" H="10" L="1800" o="FFF200" X="900" c="3" /><S Y="95" T="12" m="" P="0,0,0.3,0.2,0,0,0,0" H="10" L="1800" o="FFF200" X="900" c="3" /><S Y="50" T="12" m="" P="0,0,0.3,0.2,0,0,0,0" H="100" L="10" o="FFF200" X="455" c="3" /><S Y="50" T="12" m="" P="0,0,0.3,0.2,0,0,0,0" H="100" L="10" o="FFF200" X="1345" c="3" /><S Y="225" T="12" m="" P="0,0,0.3,0.2,0,0,0,0" H="10" L="1800" o="FFF200" X="900" c="3" /><S Y="239" T="12" m="" P="0,0,0,0,0,0,0,0" H="30" L="10" o="FFF200" X="600" c="3" /><S Y="791" T="12" m="" P="0,0,0.3,0.2,90,0,0,0" L="800" o="FF0000" X="600" H="10" /><S Y="-129" T="12" P="0,0,0.2,0.2,0,0,0,0" H="200" L="20" o="6a7495" X="316" c="3" /><S Y="-133" T="12" P="0,0,0.2,0.2,0,0,0,0" H="200" L="20" o="6a7495" X="407" c="3" /><S Y="-92" T="12" P="0,0,0.2,0.2,90,0,0,0" H="100" L="20" o="6a7495" X="363" c="3" /><S Y="-206" T="12" P="0,0,0.2,0.2,90,0,0,0" H="100" L="20" o="6a7495" X="360" c="3" /><S Y="460" T="12" P="0,0,0.3,0.2,0,0,0,0" H="120" L="2600" o="6a7495" X="800" c="4" N="" /><S Y="-800" T="12" m="" P="0,0,0,0.2,0,0,0,0" L="1840" o="FF0000" X="900" H="20" /><S Y="1190" T="12" m="" P="0,0,0,0.2,0,0,0,0" L="1800" o="FF0000" X="900" H="20" /><S Y="350" T="1" P="0,0,0,0.2,0,0,0,0" L="10" H="200" X="1200" /><S Y="239" T="12" m="" P="0,0,0,0,0,0,0,0" H="30" L="10" o="FFF200" X="1200" c="3" /><S Y="790" T="12" m="" P="0,0,0.3,0.2,90,0,0,0" L="800" o="FF0000" X="1200" H="10" /></S><D><DS Y="-141" X="365" /></D><O /><L /></Z></C>',
    [2] = customMaps[6][2],
    [3] = 'Default',
    [4] = 'Refletz#6472',
    [6] = '19539e5756b.png'
  },
  [2] = {
    [1] = '<C><P L="1800" G="0,4" MEDATA=";;1,1;;-0;0:::1-" F="0" /><Z><S><S Y="430" T="9" P="0,0,0,0,0,0,0,0" L="1200" H="10" X="600" /><S Y="350" T="1" P="0,0,0,0.2,0,0,0,0" L="10" H="200" X="600" /><S Y="350" T="1" P="0,0,0,0.2,0,0,0,0" L="10" H="200" X="1200" /><S Y="200" T="12" m="" P="0,0,0.2,0.2,0,0,0,0" L="20" o="FF0000" X="-10" H="2000" N="" /><S Y="200" T="12" m="" P="0,0,0.2,0.2,0,0,0,0" L="20" o="FF0000" X="1810" H="2000" /><S Y="45" T="12" P="0,0,0.3,0.2,0,0,0,0" H="105" L="100" o="324650" X="400" c="4" /><S Y="45" T="12" P="0,0,0.3,0.2,0,0,0,0" H="105" L="100" o="324650" X="1400" c="4" /><S Y="45" T="12" P="0,0,0.3,0.2,0,0,0,0" H="105" L="100" o="324650" X="900" c="4" /><S Y="95" T="12" m="" P="0,0,0.3,0.2,0,0,0,0" H="10" L="1800" o="FFF200" X="900" c="3" N="" /><S Y="50" T="12" m="" P="0,0,0,0,0,0,0,0" H="100" L="10" o="FFF200" X="455" c="3" /><S Y="50" T="12" m="" P="0,0,0,0,0,0,0,0" H="100" L="10" o="FFF200" X="1345" c="3" /><S Y="225" T="12" m="" P="0,0,0.3,0.2,0,0,0,0" H="10" L="1800" o="FFF200" X="900" c="3" /><S Y="240" T="12" m="" P="0,0,0,0,0,0,0,0" H="40" L="10" o="FFF200" X="600" c="3" /><S Y="240" T="12" m="" P="0,0,0,0,0,0,0,0" H="40" L="10" o="FFF200" X="1200" c="3" /><S Y="790" T="12" m="" P="0,0,0.3,0.2,180,0,0,0" L="10" o="FF0000" X="600" H="800" /><S Y="790" T="12" m="" P="0,0,0.3,0.2,180,0,0,0" L="10" o="FF0000" X="1200" H="800" /><S Y="-129" T="12" P="0,0,0.2,0.2,0,0,0,0" H="200" L="20" o="6a7495" X="316" c="3" /><S Y="-133" T="12" P="0,0,0.2,0.2,0,0,0,0" H="200" L="20" o="6a7495" X="407" c="3" /><S Y="-92" T="12" P="0,0,0.2,0.2,90,0,0,0" H="100" L="20" o="6a7495" X="363" c="3" /><S Y="-206" T="12" P="0,0,0.2,0.2,90,0,0,0" H="100" L="20" o="6a7495" X="360" c="3" /><S Y="-800" T="12" m="" P="0,0,0,0.2,0,0,0,0" L="1840" o="FF0000" X="900" H="20" /><S Y="1190" T="12" m="" P="0,0,0,0.2,0,0,0,0" L="1840" o="FF0000" X="900" H="20" /><S Y="-5" T="12" m="" P="0,0,0,0,0,0,0,0" H="10" L="1800" o="FFF200" X="900" c="3" /><S Y="137" T="1" P="1,987654,0,0.2,-90,0,0,0" L="80" H="10" X="600" /><S Y="137" T="1" P="1,987654,0,0.2,90,0,0,0" L="80" H="10" X="1200" /><S Y="400" T="1" P="0,0,0,0.2,0,0,0,0" H="100" L="1800" X="900" c="3" N="" /><S Y="460" T="12" P="0,0,0.3,0.2,0,0,0,0" H="120" L="2400" o="6a7495" X="800" c="4" N="" /></S><D><P Y="365" T="258" X="100" P="1,0" /><P Y="365" T="258" X="900" P="1,0" /><P Y="365" T="258" X="1500" P="1,0" /><P Y="0" T="138" X="0" P="0,0" /><P Y="0" T="138" X="1600" P="0,1" /><P Y="0" T="138" X="1800" P="0,1" /><DS Y="-141" X="365" /></D><O><O Y="140" P="0" X="600" C="12" /><O Y="140" P="0" X="1200" C="12" /></O><L /></Z></C>',
    [2] = customMaps[7][2],
    [3] = 'Ice barrier',
    [4] = '+Mimounaaa#0000',
    [6] = '1955401d276.png'
  },
  [3] = {
    [1] = '<C><P L="1800" G="0,4" MEDATA=";;;;-0;0:::1-" F="3" /><Z><S><S Y="400" T="7" P="0,0,0.1,0.2,0,0,0,0" H="100" L="1800" X="900" c="3" N="" /><S Y="430" T="9" P="0,0,0,0,0,0,0,0" L="1600" H="10" X="800" /><S Y="350" T="1" P="0,0,0,0.2,0,0,0,0" L="10" H="200" X="600" /><S Y="455" T="12" P="0,0,0.3,0.2,0,0,0,0" L="800" o="6a7495" X="400" H="10" /><S Y="200" T="12" m="" P="0,0,0.2,0.2,0,0,0,0" L="20" o="FF0000" X="-10" H="2000" /><S Y="45" T="12" P="0,0,0.3,0.2,0,0,0,0" H="105" L="100" o="324650" X="900" c="4" /><S Y="45" T="12" P="0,0,0.3,0.2,0,0,0,0" H="105" L="100" o="324650" X="1400" c="4" /><S Y="200" T="12" m="" P="0,0,0.2,0.2,0,0,0,0" L="20" o="FF0000" X="1810" H="2000" /><S Y="45" T="12" P="0,0,0.3,0.2,0,0,0,0" H="105" L="100" o="324650" X="400" c="4" /><S Y="-5" T="12" m="" P="0,0,0,0,0,0,0,0" H="10" L="1800" o="FFF200" X="900" c="3" /><S Y="95" T="12" m="" P="0,0,0.3,0.2,0,0,0,0" H="10" L="1800" o="FFF200" X="900" c="3" /><S Y="50" T="12" m="" P="0,0,0.3,0.2,0,0,0,0" H="100" L="10" o="FFF200" X="455" c="3" /><S Y="50" T="12" m="" P="0,0,0.3,0.2,0,0,0,0" H="100" L="10" o="FFF200" X="1345" c="3" /><S Y="225" T="12" m="" P="0,0,0.3,0.2,0,0,0,0" H="10" L="1800" o="FFF200" X="900" c="3" /><S Y="239" T="12" m="" P="0,0,0,0,0,0,0,0" H="30" L="10" o="FFF200" X="600" c="3" /><S Y="791" T="12" m="" P="0,0,0.3,0.2,90,0,0,0" L="800" o="FF0000" X="600" H="10" /><S Y="-129" T="12" P="0,0,0.2,0.2,0,0,0,0" H="200" L="20" o="6a7495" X="316" c="3" /><S Y="-133" T="12" P="0,0,0.2,0.2,0,0,0,0" H="200" L="20" o="6a7495" X="407" c="3" /><S Y="-92" T="12" P="0,0,0.2,0.2,90,0,0,0" H="100" L="20" o="6a7495" X="363" c="3" /><S Y="-206" T="12" P="0,0,0.2,0.2,90,0,0,0" H="100" L="20" o="6a7495" X="360" c="3" /><S Y="460" T="12" P="0,0,0.3,0.2,0,0,0,0" H="120" L="2600" o="6a7495" X="800" c="4" N="" /><S Y="-800" T="12" m="" P="0,0,0,0.2,0,0,0,0" L="1840" o="FF0000" X="900" H="20" /><S Y="1190" T="12" m="" P="0,0,0,0.2,0,0,0,0" L="1840" o="FF0000" X="900" H="20" /><S Y="350" T="1" P="0,0,0,0.2,0,0,0,0" L="10" H="200" X="1200" /><S Y="239" T="12" m="" P="0,0,0,0,0,0,0,0" H="30" L="10" o="FFF200" X="1200" c="3" /><S Y="790" T="12" m="" P="0,0,0.3,0.2,90,0,0,0" L="800" o="FF0000" X="1200" H="10" /><S Y="140" T="13" P="0,0,0.3,0.2,0,0,0,0" L="15" o="324650" X="600" H="10" /><S Y="140" T="13" P="0,0,0.3,0.2,0,0,0,0" L="15" o="324650" X="50" H="10" /><S Y="140" T="13" P="0,0,0.3,0.2,0,0,0,0" L="15" o="324650" X="1200" H="10" /><S Y="137" T="13" P="0,0,0.3,0.2,0,0,0,0" L="15" o="324650" X="1750" H="10" /></S><D><DS Y="-141" X="365" /></D><O /><L /></Z></C>',
    [2] = customMaps[2][2],
    [3] = 'Circle grounds on the sky',
    [4] = 'Refletz#6472',
    [6] = '1955400e807.png'
  },
  [4] = {
    [1] = '<C><P L="1800" G="0,4" MEDATA=";;;;-0;0:::1-" C="" F="0" /><Z><S><S Y="50" T="12" m="" P="0,0,0.3,0.2,0,0,0,0" H="100" L="10" o="FFF200" X="455" c="3" /><S Y="50" T="12" m="" P="0,0,0.3,0.2,0,0,0,0" H="100" L="10" o="FFF200" X="1345" c="3" /><S Y="440" T="1" P="0,0,0,0.2,0,0,0,0" L="10" H="200" X="600" /><S Y="440" T="1" P="0,0,0,0.2,0,0,0,0" L="10" H="200" X="1200" /><S Y="400" T="7" P="0,0,0.1,0.2,0,0,0,0" H="100" L="1800" X="900" c="3" N="" /><S Y="200" T="12" m="" P="0,0,0.2,0.2,0,0,0,0" L="20" o="FF0000" X="-10" H="2000" /><S Y="200" T="12" m="" P="0,0,0.2,0.2,0,0,0,0" L="20" o="FF0000" X="1810" H="2000" /><S Y="45" T="12" P="0,0,0.3,0.2,0,0,0,0" H="105" L="100" o="324650" X="400" c="3" /><S Y="45" T="12" P="0,0,0.3,0.2,0,0,0,0" H="105" L="100" o="324650" X="1400" c="3" /><S Y="45" T="12" P="0,0,0.3,0.2,0,0,0,0" H="105" L="100" o="324650" X="900" c="4" /><S Y="-5" T="12" m="" P="0,0,0,0,0,0,0,0" H="10" L="1800" o="FFF200" X="900" c="3" /><S Y="95" T="12" m="" P="0,0,0.3,0.2,0,0,0,0" H="10" L="1800" o="FFF200" X="900" c="3" /><S Y="-129" T="12" P="0,0,0.2,0.2,0,0,0,0" H="200" L="20" o="6a7495" X="316" c="3" /><S Y="-133" T="12" P="0,0,0.2,0.2,0,0,0,0" H="200" L="20" o="6a7495" X="407" c="3" /><S Y="-92" T="12" P="0,0,0.2,0.2,90,0,0,0" H="100" L="20" o="6a7495" X="363" c="3" /><S Y="-206" T="12" P="0,0,0.2,0.2,90,0,0,0" H="100" L="20" o="6a7495" X="360" c="3" /><S Y="500" T="12" P="0,0,0.3,0.2,0,0,0,0" H="200" L="2400" o="6a7495" X="800" c="4" N="" /><S Y="791" T="12" m="" P="0,0,0.3,0.2,90,0,0,0" L="800" o="FF0000" X="600" H="10" /><S Y="791" T="12" m="" P="0,0,0.3,0.2,90,0,0,0" L="800" o="FF0000" X="1200" H="10" /><S Y="-800" T="12" m="" P="0,0,0,0.2,0,0,0,0" L="1840" o="FF0000" X="900" H="20" /><S Y="1190" T="12" m="" P="0,0,0,0.2,0,0,0,0" L="1840" o="FF0000" X="900" H="20" /></S><D><DS Y="-141" X="365" /></D><O /><L /></Z></C>',
    [2] = customMaps[28][2],
    [3] = 'Very small ice barrier and mice collision',
    [4] = 'Kralizmox#0000',
    [6] = '1955403fbce.png'
  },-- @7977012
  [5] = {
    [1] = '<C><P L="1800" G="0,4" MEDATA=";;;;-0;0:::1-" /><Z><S><S Y="400" T="7" P="0,0,0.1,0.2,0,0,0,0" c="3" L="1800" X="900" H="100" N="" /><S Y="350" T="1" P="0,0,0,0.2,0,0,0,0" L="10" X="1200" H="200" /><S Y="350" T="1" P="0,0,0,0.2,0,0,0,0" L="10" X="600" H="200" /><S Y="330" T="12" m="" P="0,0,0.2,0.2,0,0,0,0" L="20" o="FFF200" X="-10" H="200" /><S Y="330" T="12" m="" P="0,0,0.2,0.2,0,0,0,0" L="20" o="FFF200" X="1810" H="200" /><S Y="45" T="12" P="0,0,0.3,0.2,0,0,0,0" c="4" L="100" o="324650" H="105" X="400" /><S Y="45" T="12" P="0,0,0.3,0.2,0,0,0,0" c="4" L="100" o="324650" H="105" X="900" /><S Y="45" T="12" P="0,0,0.3,0.2,0,0,0,0" c="4" L="100" o="324650" H="105" X="1400" /><S Y="-5" T="12" m="" P="0,0,0,0.2,0,0,0,0" c="3" L="1800" o="FFF200" H="10" X="900" N="" /><S Y="95" T="12" m="" P="0,0,0.3,0.2,0,0,0,0" c="3" L="1800" o="FFF200" H="10" X="900" N="" /><S Y="50" T="12" m="" P="0,0,0,0,0,0,0,0" c="3" L="10" o="FFF200" H="100" X="455" /><S Y="50" T="12" m="" P="0,0,0,0,0,0,0,0" c="3" L="10" o="FFF200" H="100" X="1345" /><S Y="225" T="12" m="" P="0,0,0.3,0.2,0,0,0,0" c="3" L="1800" o="FFF200" H="10" X="900" /><S Y="240" T="12" m="" P="0,0,0,0,0,0,0,0" c="3" L="10" o="FFF200" H="40" X="1200" /><S Y="240" T="12" m="" P="0,0,0,0,0,0,0,0" c="3" L="10" o="FFF200" H="40" X="600" /><S Y="790" T="12" m="" P="0,0,0.3,0.2,0,0,0,0" L="10" o="FF0000" X="1200" H="800" /><S Y="790" T="12" m="" P="0,0,0.3,0.2,0,0,0,0" L="10" o="FF0000" X="600" H="800" /><S Y="1190" T="12" m="" P="0,0,0,0,0,0,0,0" c="2" L="1800" o="FF0000" H="20" X="900" /><S Y="-129" T="12" P="0,0,0.2,0.2,0,0,0,0" c="3" L="20" o="6a7495" H="200" X="316" /><S Y="-133" T="12" P="0,0,0.2,0.2,0,0,0,0" c="3" L="20" o="6a7495" H="200" X="407" /><S Y="-92" T="12" P="0,0,0.2,0.2,90,0,0,0" c="3" L="20" o="6a7495" H="100" X="363" /><S Y="-206" T="12" P="0,0,0.2,0.2,90,0,0,0" c="3" L="20" o="6a7495" H="100" X="360" /><S Y="460" T="12" P="0,0,0.3,0.2,0,0,0,0" c="4" L="2400" o="6a7495" H="120" X="800" N="" /><S Y="-795" T="1" P="0,0,0,0.2,180,0,0,0" L="2150" X="900" H="30" N="" /><S Y="270" T="1" P="0,0,0,0.2,-1,0,0,0" c="4" L="170" X="-85" H="40" /><S Y="270" T="1" P="0,0,0,0.2,1,0,0,0" c="4" L="170" X="1885" H="40" /><S Y="212" T="9" P="0,0,0,0,0,0,0,0" L="120" X="-60" H="80" /><S Y="212" T="9" P="0,0,0,0,0,0,0,0" L="120" X="1860" H="80" /><S Y="-705" T="1" P="0,0,0,0.1,-40,0,0,0" L="250" X="-65" H="10" /><S Y="-705" T="1" P="0,0,0,0.1,40,0,0,0" L="250" X="1865" H="10" /><S Y="-185" T="9" P="0,0,0,0,0,0,0,0" L="80" X="-80" H="760" /><S Y="-185" T="9" P="0,0,0,0,0,0,0,0" L="80" X="1880" H="760" /><S Y="790" T="12" m="" P="0,0,0.2,0.2,0,0,0,0" L="20" o="FF0000" X="-10" H="800" /><S Y="790" T="12" m="" P="0,0,0.2,0.2,0,0,0,0" L="20" o="FF0000" X="1810" H="800" /><S Y="-670" T="9" P="0,0,0,0,0,0,0,0" L="110" X="-90" H="100" /><S Y="-670" T="9" P="0,0,0,0,0,0,0,0" L="110" X="1890" H="100" /><S Y="-595" T="9" P="0,0,0,0,0,0,0,0" L="80" X="-90" H="35" /><S Y="-595" T="9" P="0,0,0,0,0,0,0,0" L="80" X="1890" H="35" /><S Y="-255" T="1" P="0,0,200,0.1,0,0,0,0" c="2" L="60" X="-140" H="1050" N="" /><S Y="-255" T="1" P="0,0,200,0.1,0,0,0,0" c="2" L="60" X="1940" H="1050" N="" /><S Y="-225" T="1" P="0,0,0.2,0.2,0,0,0,0" c="2" L="50" X="-25" H="800" N="" /><S Y="-225" T="1" P="0,0,0.2,0.2,0,0,0,0" c="2" L="50" X="1825" H="800" N="" /><S Y="250" T="12" m="" P="0,0,0,0.2,0,0,0,0" c="3" L="40" o="FFF200" H="60" X="-20" N="" /><S Y="250" T="12" m="" P="0,0,0,0.2,0,0,0,0" c="3" L="40" o="FFF200" H="60" X="1820" N="" /></S><D><P Y="365" T="10" X="200" P="1,0" /><P Y="365" T="10" X="1600" P="1,1" /><P Y="365" T="10" X="900" P="1,1" /><DS Y="-151" X="360" /></D><O /><L /></Z></C>',
    [2] = customMaps[5][2],
    [3] = 'Water cannon',
    [4] = 'Refletz#6472',
    [6] = '19554044221.png'
  }
}

local customMapsFourTeamsMode = {
  [1] = {
    [1] = '@7976288',
    [2] = '@7976289',
    [3] = 'Water cannon',
    [4] = 'Refletz#6472',
    [5] = customMaps[5][1],
    [6] = '19554044221.png'
  },
  [2] = {
    [1] = '@7976290',
    [2] = '@7976291',
    [3] = 'Ice barrier',
    [4] = '+Mimounaaa#0000',
    [5] = customMaps[7][1],
    [6] = '1955401d276.png'
  },
  [3] = {
    [1] = '@7976292',
    [2] = '@7976293',
    [3] = 'Circle grounds on the sky',
    [4] = 'Refletz#6472',
    [5] = customMaps[2][1],
    [6] = '1955400e807.png'
  },
  [4] = {
    [1] = '@7976294',
    [2] = '@7976295',
    [3] = 'Trambolines in the sky',
    [4] = 'Kralizmox#0000',
    [5] = customMaps[13][1],
    [6] = '19554036f23.png'
  },
  [5] = {
    [1] = '@7976296',
    [2] = '@7976297',
    [3] = 'Trampoline rhombuses',
    [4] = 'Ppoppohaejuseyo#2315',
    [5] = customMaps[20][1],
    [6] = '19554038694.png'
  },
  [6] = {
    [1] = '@7976298',
    [2] = '@7976299',
    [3] = 'Black water',
    [4] = 'Asdfghjkkk#8564',
    [5] = customMaps[15][1],
    [6] = '1955400b924.png'
  },
  [7] = {
    [1] = '@7976300',
    [2] = '@7976301',
    [3] = 'Top player',
    [4] = 'Hxejss#7104',
    [5] = customMaps[11][1],
    [6] = '195540357b1.png'
  },
  [8] = {
    [1] = '@7976302',
    [2] = '@7976303',
    [3] = 'Water barrier',
    [4] = 'Hxejss#7104',
    [5] = customMaps[1][1],
    [6] = '19554042aaf.png'
  },
  [9] = {
    [1] = '@7976304',
    [2] = '@7976305',
    [3] = 'Cowebs',
    [4] = 'Ndisondoiasn#0148',
    [5] = customMaps[17][1],
    [6] = '1955400ff78.png'
  },
  [10] = {
    [1] = '@7976306',
    [2] = '@7976307',
    [3] = 'Ice Angle',
    [4] = 'Ppoppohaejuseyo#2315',
    [5] = '@7976308',
    [6] = '1955401a394.png'
  },
  [11] = {
    [1] = '@7976309',
    [2] = '@7976311',
    [3] = 'Rotating trampolines',
    [4] = 'Artgir#0000',
    [5] = customMaps[14][1],
    [6] = '19554029c25.png'
  },
  [12] = {
    [1] = '@7976312',
    [2] = '@7976313',
    [3] = 'The floor is lava',
    [4] = 'Kralizmox#0000',
    [5] = customMaps[18][1],
    [6] = '195540328d1.png'
  },
  [13] = {
    [1] = '@7976314',
    [2] = '@7976315',
    [3] = 'Black water with chocolate floor',
    [4] = 'Asdfghjkkk#8564',
    [5] = customMaps[19][1],
    [6] = '1955400a1b1.png'
  },
  [14] = {
    [1] = '@7976316',
    [2] = '@7976317',
    [3] = 'Two trambolines at bottom',
    [4] = 'Kralizmox#0000',
    [5] = '@7976318',
    [6] = '1955403cceb.png'
  },
  [15] = {
    [1] = '@7976319',
    [2] = '@7976320',
    [3] = 'Black water (small)',
    [4] = 'Asdfghjkkk#8564',
    [5] = customMaps[22][1],
    [6] = '19554008a40.png'
  },
  [16] = {
    [1] = '@7976321',
    [2] = '@7976322',
    [3] = 'No jump',
    [4] = 'Raf02#4942',
    [5] = customMaps[9][1],
    [6] = '19539e5756b.png'
  },
  [17] = {
    [1] = '@7976323',
    [2] = '@7976324',
    [3] = 'Honeymoon',
    [4] = 'Boczek#7535',
    [5] = customMaps[21][1],
    [6] = '19554018c22.png'
  },
  [18] = {
    [1] = '@7976325',
    [2] = '@7976326',
    [3] = 'Collision',
    [4] = 'Raf02#4942',
    [5] = customMaps[10][1],
    [6] = '19539e5756b.png'
  },
  [19] = {
    [1] = '@7976327',
    [2] = '@7976328',
    [3] = 'Snowy Mountains',
    [4] = 'Hxejss#7104',
    [5] = customMaps[25][1],
    [6] = '1955402cb0a.png'
  },
  [20] = {
    [1] = '@7976329',
    [2] = '@7976330',
    [3] = 'Halloween',
    [4] = 'Ppoppohaejuseyo#2315',
    [5] = '@7976331',
    [6] = '195540174b1.png'
  },
  [21] = {
    [1] = '@7976332',
    [2] = '@7976333',
    [3] = 'Halloween No Jump',
    [4] = 'Ppoppohaejuseyo#2315',
    [5] = '@7976334',
    [6] = '19554015d3f.png'
  },
  [22] = {
    [1] = '@7976335',
    [2] = '@7976336',
    [3] = 'Eclipse',
    [4] = 'Lacoste#8972',
    [5] = customMaps[26][1],
    [6] = '195540145dc.png'
  },
  [23] = {
    [1] = '@7976337',
    [2] = '@7976338',
    [3] = 'Tube cannon',
    [4] = 'Ppoppohaejuseyo#2315',
    [5] = '@7976339',
    [6] = '1955403b578.png'
  },
  [24] = {
    [1] = '@7976340',
    [2] = '@7976341',
    [3] = 'Very small ice barrier and mice collision',
    [4] = 'Kralizmox#0000',
    [5] = customMaps[28][1],
    [6] = '1955403fbce.png'
  },
  [25] = {
    [1] = '@7976342',
    [2] = '@7976343',
    [3] = 'Ice barrier booster',
    [4] = 'Kralizmox#0000',
    [5] = customMaps[31][1],
    [6] = '1955401bb06.png'
  },
  [26] = {
    [1] = '@7976344',
    [2] = '@7976345',
    [3] = 'Lightness and darkness',
    [4] = 'Kralizmox#0000',
    [5] = customMaps[32][1],
    [6] = '19554026d42.png'
  },
  [27] = {
    [1] = '@7976346',
    [2] = '@7976347',
    [3] = 'Volley 2.0',
    [4] = 'Refletz#6472',
    [5] = customMaps[34][1],
    [6] = '1955404133e.png'
  },
  [28] = {
    [1] = '@7976348',
    [2] = '@7976349',
    [3] = 'Pink date',
    [4] = 'Ppoppohaejuseyo#2315',
    [5] = customMaps[36][1],
    [6] = '195540284b2.png'
  },
  [29] = {
    [1] = '@7976350',
    [2] = '@7976351',
    [3] = 'The floor is kralizmox',
    [4] = 'Sfjoud#8638',
    [5] = customMaps[37][1],
    [6] = '1955403115e.png'
  },
  [30] = {
    [1] = '@7976353',
    [2] = '@7976354',
    [3] = 'The Rainbow',
    [4] = 'Kralizmox#0000',
    [5] = customMaps[38][1],
    [6] = '19554034040.png'
  },
  [31] = {
    [1] = '<C><P L="1600" F="7" G="0,4"/><Z><S><S T="12" X="-10" Y="200" L="20" H="2000" P="0,0,0.2,0.2,0,0,0,0" o="FF0000" N="" m=""/><S T="1" X="400" Y="350" L="10" H="200" P="0,0,0,0.2,0,0,0,0" N=""/><S T="1" X="1200" Y="350" L="10" H="200" P="0,0,0,0.2,0,0,0,0" N=""/><S T="1" X="800" Y="350" L="10" H="200" P="0,0,0,0.2,0,0,0,0" N=""/><S T="12" X="1610" Y="200" L="20" H="2000" P="0,0,0.2,0.2,0,0,0,0" o="FF0000" N="" m=""/><S T="12" X="800" Y="1190" L="1640" H="20" P="0,0,0,0.2,0,0,0,0" o="FF0000" N="" m=""/><S T="12" X="250" Y="45" L="100" H="105" P="0,0,0.3,0.2,0,0,0,0" o="324650" c="3"/><S T="12" X="800" Y="-5" L="1600" H="10" P="0,0,0,0.2,0,0,0,0" o="FFF200" c="3" N="" m=""/><S T="12" X="800" Y="95" L="1600" H="10" P="0,0,0.3,0.2,0,0,0,0" o="FFF200" c="3" N="" m=""/><S T="12" X="400" Y="175" L="10" H="170" P="0,0,0.2,0,0,0,0,0" o="FFF200" c="3" m=""/><S T="12" X="1200" Y="175" L="10" H="170" P="0,0,0.2,0,0,0,0,0" o="FFF200" c="3" m=""/><S T="12" X="800" Y="175" L="10" H="170" P="0,0,0.2,0,0,0,0,0" o="FFF200" c="3" m=""/><S T="12" X="400" Y="790" L="800" H="10" P="0,0,0.3,0.2,90,0,0,0" o="FF0000" m=""/><S T="12" X="1200" Y="790" L="800" H="10" P="0,0,0.3,0.2,90,0,0,0" o="FF0000" m=""/><S T="12" X="800" Y="790" L="800" H="10" P="0,0,0.3,0.2,90,0,0,0" o="FF0000" m=""/><S T="12" X="316" Y="-129" L="20" H="200" P="0,0,0.2,0.2,0,0,0,0" o="6a7495" c="3"/><S T="12" X="407" Y="-133" L="20" H="200" P="0,0,0.2,0.2,0,0,0,0" o="6a7495" c="3"/><S T="12" X="363" Y="-92" L="20" H="100" P="0,0,0.2,0.2,90,0,0,0" o="6a7495" c="3"/><S T="12" X="360" Y="-206" L="20" H="100" P="0,0,0.2,0.2,90,0,0,0" o="6a7495" c="3"/><S T="12" X="800" Y="460" L="2400" H="120" P="0,0,0.3,0.2,0,0,0,0" o="6a7495" c="4" N=""/><S T="12" X="1350" Y="45" L="100" H="105" P="0,0,0.3,0.2,0,0,0,0" o="324650" c="3"/><S T="12" X="600" Y="45" L="100" H="105" P="0,0,0.3,0.2,0,0,0,0" o="324650" c="4"/><S T="12" X="1000" Y="45" L="100" H="105" P="0,0,0.3,0.2,0,0,0,0" o="324650" c="4"/><S T="12" X="800" Y="-790" L="1640" H="20" P="0,0,0,0.2,0,0,0,0" o="FF0000" N="" m=""/><S T="10" X="400" Y="265" L="230" H="10" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="1200" Y="265" L="230" H="10" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="800" Y="265" L="230" H="10" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="400" Y="155" L="100" H="10" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="1200" Y="155" L="100" H="10" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="800" Y="155" L="100" H="10" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="320" Y="214" L="80" H="10" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="1120" Y="214" L="80" H="10" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="720" Y="214" L="80" H="10" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="480" Y="214" L="80" H="10" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="1280" Y="214" L="80" H="10" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="880" Y="214" L="80" H="10" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="355" Y="185" L="10" H="65" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="1155" Y="185" L="10" H="65" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="755" Y="185" L="10" H="65" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="445" Y="185" L="10" H="65" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="1245" Y="185" L="10" H="65" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="845" Y="185" L="10" H="65" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="50" Y="210" L="10" H="70" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="1550" Y="210" L="10" H="70" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="25" Y="180" L="50" H="10" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="1575" Y="180" L="50" H="10" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="285" Y="240" L="10" H="60" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="1085" Y="240" L="10" H="60" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="685" Y="240" L="10" H="60" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="515" Y="240" L="10" H="60" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="1315" Y="240" L="10" H="60" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="915" Y="240" L="10" H="60" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="190" Y="380" L="140" H="10" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="1410" Y="380" L="140" H="10" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="600" Y="380" L="140" H="10" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="1010" Y="380" L="140" H="10" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="190" Y="325" L="140" H="10" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="1410" Y="325" L="140" H="10" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="600" Y="325" L="140" H="10" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="1010" Y="325" L="140" H="10" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="255" Y="355" L="10" H="60" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="1345" Y="355" L="10" H="60" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="945" Y="355" L="10" H="60" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="535" Y="355" L="10" H="60" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="125" Y="355" L="10" H="60" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="1475" Y="355" L="10" H="60" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="665" Y="355" L="10" H="60" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="1075" Y="355" L="10" H="60" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="55" Y="300" L="110" H="10" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="1545" Y="300" L="110" H="10" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="75" Y="240" L="60" H="10" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="1525" Y="240" L="60" H="10" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="105" Y="270" L="10" H="70" P="0,0,0.1,0.2,0,0,0,0" c="3"/><S T="10" X="1495" Y="270" L="10" H="70" P="0,0,0.1,0.2,0,0,0,0" c="3"/></S><D><T X="335" Y="251" spawn="2"/><T X="1135" Y="251" spawn="2"/><T X="735" Y="251" spawn="2"/><T X="465" Y="251" spawn="2"/><T X="1265" Y="251" spawn="2"/><T X="865" Y="251" spawn="2"/><T X="190" Y="366" spawn="1"/><T X="1410" Y="366" spawn="1"/><T X="600" Y="366" spawn="1"/><T X="1011" Y="366" spawn="1"/><T X="41" Y="281" spawn="3"/><T X="1559" Y="281" spawn="3"/><DS X="360" Y="-151"/></D><O/><L/></Z></C>',
    [2] = '@7976355',
    [3] = 'Platforms',
    [4] = 'Refletz#6472',
    [5] = customMaps[39][1],
    [6] = '196599446e1.png'
  },
  [32] = {
    [1] = '@7976356',
    [2] = '@7976375',
    [3] = 'Some chords',
    [4] = 'Tanarchosl#4785 and Tanatosl#0000',
    [5] = customMaps[40][1],
    [6] = '1984ac70c05.png'
  },
  [33] = {
    [1] = '@7976357',
    [2] = '@7976358',
    [3] = 'Quad water cannon',
    [4] = 'Tanarchosl#4785 and K1ng#7286',
    [5] = customMaps[44][1],
    [6] = '1984ac73e2e.png'
  },
  [34] = {
    [1] = '@7976359',
    [2] = '@7976360',
    [3] = 'Default map',
    [4] = 'Refletz#6472',
    [5] = customMaps[6][1],
    [6] = '19539e5756b.png'
  },
  [35] = {
    [1] = '@7976361',
    [2] = '@7976362',
    [3] = 'Impostor',
    [4] = 'Ppoppohaejuseyo#2315',
    [5] = customMaps[52][1],
    [6] = '198a96b6d56.png'
  },
  [36] = {
    [1] = '@7976363',
    [2] = '@7976364',
    [3] = 'Ocean',
    [4] = 'Ppoppohaejuseyo#2315',
    [5] = customMaps[53][1],
    [6] = '198a96b57ff.png'
  },
  -- version <2.3.0, Tanarchosl#4785>
  [37] = {
    [1] = '@7976365',
    [2] = '@7976366',
    [3] = 'Dusty journey',
    [4] = 'Lacoste#8972',
    [5] = '@7976367',
    [6] = '19ad0d36704.png'
  },
  [38] = {
    [1] = '@7977045',
    [2] = '@7976368',
    [3] = 'The morning of departure',
    [4] = 'Lacoste#8972',
    [5] = '@7976369',
    [6] = '19ad0d34e62.png'
  },
  [39] = {
    [1] = '@7976370',
    [2] = '@7976371',
    [3] = 'Simple neon',
    [4] = 'Lacoste#8972',
    [5] = '@7976372',
    [6] = '19ad0d33685.png'
  }
  -- [99] =
  -- {
  --   [1] = 'map1',
  --   [2] = 'map2',
  --   [3] = 'name',
  --   [4] = 'author',
  --   [5] = 'small map',
  --   [6] = '19539e5756b.png'
  -- }
}


--[[ src/printf.lua ]]--

-- local tfm.exec.chatMessage_colors = { 
--     cep = "#f0a78e", fc = "#ff8547", ce = "#e88f4f",
--     o = "#f79337", cs = "#efce8f", d = "#ffd991",
--     j = "#babd2f", t = "#a4cf9e", vp = "#2ecf73",
--     pt = "#2eba7e", v = "#009d9d", ch = "#98e2eb",
--     bv = "#2f7fcc", bl = "#6c77c1", g = "#60608f",
--     n = "#c2c2da", n2 = "#9393aa", vi = "#c53dff",
--     s = "#caa4cb", ps = "#f1c4f6", ch2 = "#feb1fc",
--     rose = "#ed67ea", r = "#cb546b"
-- }

-- local branch = "test"

-- if branch == "test" then
--     printCallback = print
-- else
--     printCallback = tfm.exec.chatMessage
-- end

-- -- ui.addTextArea(3232, "<font size = 14px>Debug zone", 
-- --                 nil, -310, 5, 300, 600,
-- -- 			    0x000000, 0x00ffaa, 0.9, 
-- -- 			    true)

-- function debug_textArea(text, target)
--     ui.updateTextArea(3232, text, target)
-- end


-- function split(inputstr, sep)
--   if sep == nil then
--     sep = "%s"
--   end
--   local t={}
--   for str in string.gmatch(inputstr, "([^"..sep.."]+)") do
--     table.insert(t, str)
--   end
--   return t
-- end

-- local tfm.exec.chatMessage_categories = 
-- {
--     warning, info, err, debug, sensible 
-- }

-- -- function tfm.exec.chatMessage(type, message, target)
-- --     --print("Type:"..type)
-- -- 	--print("Message:"..message)
-- -- 	--print(target)

-- --     if type == "info" then
-- --         printCallback(message)
-- --     elseif type == "debug" then
-- --         debug_textArea(message)
-- --     end

-- -- end

-- -- tfm.exec.chatMessage("info", "<br><j>Welcome to the Volley, created by Refletz#6472", name)
-- -- tfm.exec.chatMessage("info", "<n>#Volley Version: <j>2.3.0<n>", name)
-- -- tfm.exec.chatMessage("info", "<n>Join our #Volley Discord server: <ce>https://discord.com/invite/pWNTesmNhu<n><br>", name)

-- message = "<font size = '12x'>"

-- --tfm.exec.chatMessage("debug", message, name)


--[[ src/translate.lua ]]--

local lang = {}
local languages = "[AR/BR/EN/FR/PL]"

local gameVersion = "V2.3.0"

lang.br = {
  welcomeMessage = "<j>Bem vindo ao Volley, jogo criado por Refletz#6472<n>",
  welcomeMessage2 = "<j>Digite !join para entrar na partida<n>",
  msgRedWinner = "O time vermelho venceu!",
  msgBlueWinner = "O time azul venceu!",
  menuOpenText = "<br><br><a href='event:howToPlay'>Como jogar</a><br><a href='event:realmode'>Vôlei Modo Real</a><br><a href='event:ranking'>Ranking</a><br><a href='event:credits'>Creditos</a><br>",
  closeUIText = "<p align='center'><font size='12px'><a href='event:closeWindow'>Fechar",
  helpTitle = "<p align='center'><font size='16px'>Como jogar Volley ("..gameVersion..")",
  helpText = {
    [1] = { text = "<br><br><p align='left'><font size='12px'>O objetivo do vôlei é evitar que a bola caia no chão de sua quadra, e para evitar isso, você pode transformar seu rato em um objeto circular apertando a tecla <j>[ Espaço ]<n>, o rato se destransforma 3 segundos depois. A equipe que fazer 7 pontos primeiro vence!<br>Criar uma sala com admin: <bv><a href='event:roomadmin'>/sala *#volley0SeuNome#0000</a><n><br><br>Comandos (<rose>*<n> = durante a partida | <vp>*<n> = comandos do admin):<br><br><j>!lang<n> <ch>"..languages.."<n> - Para modificar o idioma do minigame<br><j>!join<n> <rose>*<n> - Para entrar na partida <br><j>!leave<n> <rose>*<n> - Para sair da partida e ir para a área de espectador<br><j>!resettimer<n> <vp>*<n> - Resetar o tempo no lobby antes de começar a partida<br><j>!setmap<n> <ch>[small/large/extra-large]<n> <vp>*<n> - Para selecionar um mapa em especifico antes de começar uma partida<br><j>!pw<n> <ch>[senha]<n> <vp>*<n> - Colocar uma senha na sala"},
    [2] = { text = "<p align='left'><font size='12px'><br><br>Comandos (<rose>*<n> = durante a partida | <vp>*<n> = comandos do admin):<br><br><j>!winscore<n> <ch>[número]<n> <rose>*<n> <vp>*<n> - Mudar o numero máximo de pontos para vencer uma partida<br><j>!customMap<n> <ch>[true ou false]<n> <ch>[index do mapa]<n> <vp>*<n> - Selecionar um mapa costumizado<br><j>!maps<n> - Mostra a lista de mapas<br><j>!votemap<n> <ch>[numero]<n> - Votar em um mapa costumizado para a próxima partida<br><j>!setscore<n> <ch>[nome do jogador]<n> <ch>[numero]<n> <rose>*<n> <vp>*<n> - Troca a score do jogador pelo numero<br><j>!setscore<n> <ch>[nome do jogador]<n> <rose>*<n> <vp>*<n> - Adiciona +1 a score do jogador<br><j>!setscore<n> <ch>[red ou blue]<n> <ch>[numero]<n> <rose>*<n> <vp>*<n> - Troca a score do time pelo numero<br><j>!4teamsmode<n> <ch>[true ou false]<n> <vp>*<n> - Seleciona o modo de 4 times do Volley<br>"},
    [3] = { text = "<p align='left'><font size='12px'><br><br>Comandos (<rose>*<n> = durante a partida | <vp>*<n> = comandos do admin):<br><br><j>!setmaxplayers <ch>[6 - 20]<n> <vp>*<n> - Seleciona o máximo de jogadores para entrar na sala<br><j>!balls<n> - Mostra a lista de bolas costumizadas do #Volley<br><j>!customball<n> <ch>[Número]<n> <vp>*<n> - Seleciona uma bola costumizável para a próxima partida<br><j>!lobby<n> <rose>*<n> <vp>*<n> - Encerra uma partida que estava em andamento e retorna para o lobby<br><j>!setplayerforce<n> <ch>[Número: 0 - 1.05]<n> <vp>*<n> - Seleciona a força para o objeto esférico do rato<br><j>!2teamsmode<n> <ch>[true ou false]<n> <vp>*<n> - Seleciona o modo especial de 2 times<br><j>!sync<n> <vp>*<n> - O sistema escolhe o jogador com a menor latência para sincronizar a sala<br><j>!synctfm<n> <vp>*<n> - O sistema do TFM escolhe o jogador com a menor latência para sincronizar"},
    [4] = { text = "<p align='left'><font size='12px'><br><br>Comandos (<rose>*<n> = durante a partida | <vp>*<n> = comandos do admin):<br><br><j>!skiptimer<n> <vp>*<n> - Inicia a partida o mais rápido possível<br><j>!realmode<n> <ch>[true ou false]<n> <vp>*<n> - Seleciona Volley Real Mode<br><j>!twoballs<n> <ch>[true ou false]<n> <vp>*<n> - Ativa duas bolas em jogo<br><j>!consumables<n> <ch>[true ou false]<n> <vp>*<n> - Escolha um consumível com as teclas (7, 8, 9 e 0) e ative eles apertando M no modo normal<br><j>!settings<n> <vp>*<n> - Comando para fazer configurações globais na sala<br><j>!setsync<n> <vp>*<n> - Seleciona a sync para o jogador<br><j>!crown<n> <ch>[true ou false]<n> - Ativa/desativa imagens de coroa" },
    [5] = { text = "<p align='left'><font size='12px'><br><br>Comandos (<rose>*<n> = durante a partida | <vp>*<n> = comandos do admin):<br><br><j>!profile<n> <vp>*<n> - Mostra o seu perfil no Volley, você também pode abrir o seu perfil usando a tecla P<br><j>!profile<n> <ch>[playerName#0000]<n> <vp>*<n> - Mostra o perfil do jogador selecionado no Volley<br><j>!stoptimer<n> <vp>*<n> - Para o temporizador do lobby<br><j>!3teamsmode<n> <ch>[true ou false]<n> <vp>*<n> - ativa o modo 3 teams<br><j>!threeballs<n> <ch>[true ou false]<n> <vp>*<n> - Ativa 3 bolas no modo 3 teams mode" }
  },
  creditsTitle = "<p align='center'><font size='16px'>Créditos (Volley)",
  creditsText = "<br><br><p align='left'><font size='12px'>O jogo foi desenvolvido por <j>Refletz#6472 (Soristl)<n><br><br>Tradução BR/EN: <j>Refletz#6472 (Soristl)<n><br><br>Tradução AR: <j>Ionut_eric_pro#1679<n><br><br>Tradução FR: <j>Rowed#4415<n><br><br>Tradução PL: <j>Prestige#5656<n>",
  messageSetMaxPlayers = "Número máximo de jogadores colocado para",
  newPassword = "Nova senha:",
  passwordRemoved = "<bv>Senha removida<n>",
  messageMaxPlayersAlert = "<bv>O número máximo de jogadores deve ser no mínimo 6 e no máximo 20<n>",
  previousMessage = "<p align='center'>Voltar",
  nextMessage = "<p align='center'>Próximo",
  realModeRules = "<p align='center'><font size='16px'>Volley Real Mode Regras<br><br><p align='left'><font size='12px'><b>- Cada time pode se <b>transformar</b> em um <vi>objeto esférico<n> somente 3x (exceto no <b>saque</b> que é apenas 1x)<br><br>- Se a bola for para a fora do lado do seu time e <b>ninguém</b> do seu time se transformou em um <vi>objeto esférico<n> o ponto é do seu time<br><br>- Se a bola foi para fora e o seu time se <b>transformou no</b> <vi><b>objeto esférico<b><n> o ponto é do adversário<br><br>- Cada jogador irá sacar a bola uma vez conforme o andamento da partida<br><br>- Se o jogador sair da quadra, o jogador poderá realizar uma ação por <j>7 segundos<n>, caso contrário o jogador não poderá usar a <j>tecla de espaço<n><br><br>- As teclas 1, 2, 3 e 4 alteram a força do jogador",
  titleSettings = "<p align='center'><font size='16px'>Configurações da sala</p>",
  textSettings = "<p align='left'><font size='12px'><textformat leading='30'>Selecione o modo de jogo<br>Ativar o comando !randomball</textformat><br><br>Ativar o comando !randommap<br><br><br>Ativar o comando !twoballs</p>",
  textSettings2 = "<p align='left'><font size='12px'><textformat leading='30'>Selecione o tamanho do mapa (!setmap) (modo normal)<br>Ativar o comando !consumables (modo normal)</textformat><br>Ativar o modo de três bolas em três equipes",
  msgAchievements = "<p align='left'><font size='14px'>Conquistas:",
  msgsTrophies = {
    [1] = "Troféu Copa do Mundo de Vôlei",
    [2] = "Futevôlei Ultimate Team Badge",
    [3] = "Copa do mundo de Futebol",
    [4] = "Volley Roulette badge",
    [5] = "Volley Wild Card badge"
  },
  mapSelect = 'Selecionar um mapa',
}

lang.en = {
  welcomeMessage = "<j>Welcome to the Volley, game was created by Refletz#6472<n>",
  welcomeMessage2 = "<j>Type !join to join on the match<n>",
  msgRedWinner = "Team red won!",
  msgBlueWinner = "Team blue won!",
  menuOpenText = "<br><br><a href='event:howToPlay'>How to play</a><br><a href='event:realmode'>Volley Real Mode</a><br><a href='event:ranking'>Ranking</a><br><a href='event:credits'>Credits</a><br>",
  closeUIText = "<p align='center'><font size='12px'><a href='event:closeWindow'>Close",
  helpTitle = "<p align='center'><font size='16px'>How to play Volley ("..gameVersion..")",
  helpText = {
    [1] = { text = "<br><br><p align='left'><font size='12px'>The objective of volleyball is to prevent the ball from falling to the floor of your court, and to avoid this, you can turn your mouse into a circular object by pressing the <j>[ Space ]<n> key, the mouse untransforms 3 seconds later. The team that scores 7 points first wins!<br>Create a room with admin: <bv><a href='event:roomadmin'>/room *#volley0YourName#0000</a><n><br><br>Commands (<rose>*<n> = during the match | <vp>*<n> = admin's commands):<br><br><j>!lang<n> <ch>"..languages.."<n> - To modify the minigame language<br><j>!join<n> <rose>*<n> - To join the match<br><j>!leave<n> <rose>*<n> - To leave the match and go to the spectator area<br><j>!resettimer<n> <vp>*<n> - Reset time in the lobby before starting the match<br><j>!setmap<n> <ch>[small/large/extra-large]<n> <vp>*<n> - To select a specific map before starting a match<br><j>!pw<n> <ch>[password]<n> <vp>*<n> - Put a password in the room"},
    [2] = { text = "<p align='left'><font size='12px'><br><br>Commands (<rose>*<n> = during the match | <vp>*<n> = admin's commands):<br><br><j>!winscore<n> <ch>[number]<n> <rose>*<n> <vp>*<n> - Change the maximum number of points to win a match<br><j>!customMap<n> <ch>[true or false]<n> <ch>[map index]<n> <vp>*<n> - Select a custom map<br><j>!maps<n> - Shows the list of maps<br><j>!votemap<n> <ch>[number]<n> - Vote for a custom map for the next match<br><j>!setscore<n> <ch>[Player name]<n> <ch>[number]<n> <rose>*<n> <vp>*<n> - Swap the player's score by number<br><j>!setscore<n> <ch>[Player name]<n> <rose>*<n> <vp>*<n> - Adds +1 to player's score<br><j>!setscore<n> <ch>[red or blue]<n> <ch>[number]<n> <rose>*<n> <vp>*<n> - Swap the team's score for the number<br><j>!4teamsmode<n> <ch>[true or false]<n> <vp>*<n> - Select 4-team Volley mode"},
    [3] = { text = "<p align='left'><font size='12px'><br><br>Commands (<rose>*<n> = during the match | <vp>*<n> = admin's commands)<br><br><j>!setmaxplayers <ch>[6 - 20]<n> <vp>*<n> - Selects the maximum number of players to enter the room<br><j>!balls<n> - Shows the list of #Volley custom balls<br><j>!customball<n> <ch>[Number]<n> <vp>*<n> - Select a customizable ball for the next match<br><j>!lobby<n> <rose>*<n> <vp>*<n> - End a match that was in progress and return to the lobby<br><j>!setplayerforce<n> <ch>[Number: 0 - 1.05]<n> <vp>*<n> - Selects the strength for the spherical mouse object<br><j>!2teamsmode<n> <ch>[true or false]<n> <vp>*<n> - Selects the special 2-team mode<br><j>!sync<n> <vp>*<n> - The system chooses the player with the lowest latency to synchronize the room<br><j>!synctfm<n> <vp>*<n> - The TFM system chooses the player with the lowest latency to synchronize the room"},
    [4] = { text = "<p align='left'><font size='12px'><br><br>Commands (<rose>*<n> = during the match | <vp>*<n> = admin's commands)<br><br><j>!skiptimer<n> <vp>*<n> - Start the game as quickly as possible<br><j>!realmode<n> <ch>[true or false]<n> <vp>*<n> - Selects Volley Real Mode<br><j>!twoballs<n> <ch>[true or false] <n> <vp>*<n> - Activates two balls in game<br><j>!consumables<n> <ch>[true or false]<n> <vp>*<n> - Choose a consumable with the keys (7, 8, 9 and 0) and activate them by pressing M in normal mode<br><j>!settings<n> <vp>*<n> - Command to make global settings in the room<br><j>!setsync<n> <vp>*<n> - Selects sync for the player<br><j>!crown<n> <ch>[true or false]<n> - Enables/disables crown images"},
    [5] = { text = "<p align='left'><font size='12px'><br><br>Commands (<rose>*<n> = during the match | <vp>*<n> = admin's commands)<br><br><j>!profile<n> <vp>*<n> - Shows your profile on Volley, you can also open your profile using the P key<br><j>!profile<n> <ch>[playerName#0000]<n> <vp>*<n> - Shows the profile of the selected player in Volley<br><j>!stoptimer<n> <vp>*<n> - Stops the lobby timer<br><j>!3teamsmode<n> <ch>[true or false]<n> <vp>*<n> - Activates 3 teams mode<br><j>!threeballs<n> <ch>[true or false]<n> <vp>*<n> - Activates 3 balls in 3 teams mode"}
  },
  creditsTitle = "<p align='center'><font size='16px'>Credits (Volley)",
  creditsText = "<br><br><p align='left'><font size='12px'>The game was developed by <j>Refletz#6472 (Soristl)<n><br><br>BR/EN Translation: <j>Refletz#6472 (Soristl)<n><br><br>AR Translation: <j>Ionut_eric_pro#1679<n><br><br>FR Translation: <j>Rowed#4415<n><br><br>PL Translation: <j>Prestige#5656<n>",
  messageSetMaxPlayers = "Maximum number of players placed for",
  newPassword = "New password:",
  passwordRemoved = "<bv>Password removed<n>",
  messageMaxPlayersAlert = "<bv>The maximum number of players must be a minimum of 6 and a maximum of 20<n>",
  previousMessage = "<p align='center'>Back",
  nextMessage = "<p align='center'>Next",
  realModeRules = "<p align='center'><font size='16px'>Volley Real Mode Rules<br><br><p align='left'><font size='12px'><b>- Each team can join <b>transform</b> into a <vi>spherical object<n> only 3 times (except for the <b>serve</b> which is only 1 time)<br><br>- If the ball goes out on your team's side and <b>no one</b> on your team turned into a <vi>spherical object<n> the point is your team's<br><br>- If the ball went out and someone of your team <b>turned into</b> <vi><b>spherical object<b><n> the point belongs to the opponent<br><br>- Each player will serve the ball once <br><br>- If the player leaves the court, the player will be able to perform an action for <j>7 seconds<n>, otherwise the player will not be able to use the <j>space key<n><br><br>- The 1, 2, 3 and 4 keys change the player's strength",
  titleSettings = "<p align='center'><font size='16px'>Room Settings</p>",
  textSettings = "<p align='left'><font size='12px'><textformat leading='30'>Select game mode<br>Activate the !randomball command</textformat><br><br>Activate the !randommap command<br><br><br>Activate the !twoballs command</p>",
  textSettings2 = "<p align='left'><font size='12px'><textformat leading='30'>Select the map size (!setmap) (Normal mode)<br>Activate the !consumables command (Normal mode)</textformat><br>Enable three balls on 3 teams mode",
  msgAchievements = "<p align='left'><font size='14px'>Achievements:",
  msgsTrophies = {
    [1] = "Volleyball World Cup Trophy",
    [2] = "FootVolley Ultimate Team Badge",
    [3] = "Volley Soccer World Cup",
    [4] = "Volley Roulette badge",
    [5] = "Volley Wild Card"
  },
  mapSelect = 'Select a map'
}

lang.ar = {
  welcomeMessage = "<j>مرحبًا بكم في لعبة كرة الطائرة، التي تم إنشاؤها من طرف Refletz#6472<n>",
  welcomeMessage2 = "<j>اكتب  !join للانضمام إلى المباراة.<n>",
  msgRedWinner = "فاز الفريق الأحمر!",
  msgBlueWinner = "فاز الفريق الأزرق!",
  menuOpenText = "<br><br><a href='event:howToPlay'>كيفية اللعب</a><br><a href='event:realmode'>وضع الكرة الطائرة الحقيقي</a><br><a href='event:ranking'>التصنيف</a><br><a href='event:credits'>شكر خاص</a><br>",
  closeUIText = "<p align='center'><font size='12px'><a href='event:closeWindow'>إغلاق",
  helpTitle = "<p align='center'><font size='16px'>كيفية لعب الكرة الطائرة ("..gameVersion..")",
  helpText = {
    [1] = { text = "<br><br><p align='right'><font size='12px'>هدف كرة الطائرة هو منع الكرة من السقوط إلى أرضية ملعب فريقك، ولتحقيق هذا، يمكنك تحويل الفأر الخاص بك إلى كائن دائري عن طريق الضغط على <j>[ مسطرة ]<n> مفتاح, ويعود الفأر إلى شكله الأصلي بعد 3 ثوانٍ. الفريق الذي يسجل 7 نقاط أولاً يفوز!<br>إنشاء غرفة بخاصيات المشرف: <bv><a href='event:roomadmin'>/room *#volley0إسمك#0000</a><n><br><br>الأوامر (<rose>*<n> = أثناء المباراة | <vp>*<n> = أوامر المشرف):<br><br><j>!lang<n> <ch>"..languages.."<n> - لتعديل لغة النمط<br><j>!join<n> <rose>*<n> - للإنضمام للمباراة<br><j>!leave<n> <rose>*<n> - لمغادرة المباراة والذهاب إلى منطقة المتفرجين<br><j>!resettimer<n> <vp>*<n> - قم بإعادة ضبط الوقت في الردهة قبل بدء المباراة<br><j>!setmap<n> <ch>[small/large/extra-large]<n> <vp>*<n> - لتحديد خريطة معينة قبل بدء المباراة<br><j>!pw<n> <ch>[password]<n> <vp>*<n> - ضع كلمة مرور في الغرفة"},
    [2] = { text = "<p align='right'><font size='12px'><br><br>الأوامر (<rose>*<n> = أثناء المباراة | <vp>*<n> = أوامر المشرف):<br><br><j>!winscore<n> <ch>[number]<n> <rose>*<n> <vp>*<n> - تغيير الحد الأقصى لعدد النقاط للفوز بالمباراة<br><j>!customMap<n> <ch>[true or false]<n> <ch>[map index]<n> <vp>*<n> - اختر ماب مخصص<br><j>!maps<n> - تظهر قائمة الخرائط<br><j>!votemap<n> <ch>[number]<n> - التصويت للحصول على ماب مخصص للمباراة القادمة<br><j>!setscore<n> <ch>[Player name]<n> <ch>[number]<n> <rose>*<n> <vp>*<n> - قم بتبديل نتيجة اللاعب بالرقم<br><j>!setscore<n> <ch>[Player name]<n> <rose>*<n> <vp>*<n> - يضيف +1 إلى نتيجة اللاعب<br><j>!setscore<n> <ch>[red or blue]<n> <ch>[number]<n> <rose>*<n> <vp>*<n> - قم بتبديل نتيجة الفريق بالرقم<br><j>!4teamsmode<n> <ch>[true or false]<n> <vp>*<n> - حدد وضع الكرة الطائرة المكون من 4 فرق"},
    [3] = { text = "<p align='right'><font size='12px'><br><br>الأوامر (<rose>*<n> = أثناء المباراة | <vp>*<n> = أوامر المشرف)<br><br><j>!setmaxplayers <ch>[6 - 20]<n> <vp>*<n> - يحدد الحد الأقصى لعدد اللاعبين لدخول الغرفة<br><j>!balls<n> - تظهر قائمة الكرات الخاصة بالنمط <br><j>!customball<n> <ch>[Number]<n> <vp>*<n> - حدد كرة خاصة للمباراة القادمة<br><j>!lobby<n> <rose>*<n> <vp>*<n> - إنهاء المباراة الجارية والعودة إلى الردهة<br><j>!setplayerforce<n> <ch>[Number: 0 - 1.05]<n> <vp>*<n> - تحديد قوة شكل الفأر الكروي<br><j>!2teamsmode<n> <ch>[true or false]<n> <vp>*<n> - يختار الوضع الخاص المكون من فريقين<br><j>!sync<n> <vp>*<n> - يختار النظام اللاعب ذو زمن الاستجابة الأقل لمزامنة الغرفة<br><j>!synctfm<n> <vp>*<n> - يقام نظام TFM باختيار اللاعب صاحب أقل زمن استجابة لمزامنة الغرفة."},
    [4] = { text = "<p align='right'><font size='12px'><br><br>الأوامر (<rose>*<n> = أثناء المباراة | <vp>*<n> = أوامر المشرف)<br><br><j>!skiptimer<n> <vp>*<n> - يتخطى وقت الانتظار لبدء اللعبة إلى 5 ثواني <br><j>!realmode<n> <ch>[true or false خطأ]<n> <vp>*<n> - تحديد الوضع الحقيقي للكرة الطائرة<br><j>!twoballs<n> <ch>[true or false] <n> <vp>*<n> - ينشط كرتين في اللعبة<br><j>!consumables<n> <ch>[true or false]<n> <vp>*<n> - اختر عنصرًا مستهلكًا به المفاتيح (7 و 8 و 9 و 0) وتفعيلها بالضغط على M في الوضع العادي<br><j>!settings<n> <vp>*<n> - الأمر بإجراء الإعدادات العامة في الغرفة<br><j>!setsync<n> <vp>*<n> - يحدد المزامنة للمشغل<br><j>!crown<n> <ch>[true or false]<n> - تمكين/تعطيل صور التاج"},
    [5] = { text = "<p align='right'><font size='12px'><br><br>الأوامر (<rose>*<n> = أثناء المباراة | <vp>*<n> = أوامر المشرف)<br><br><j>!profile<n> <vp>*<n> - يعرض ملفك الشخصي على Volley، ويمكنك أيضًا فتح ملفك الشخصي باستخدام مفتاح P<br><j>!profile<n> <ch>[playerName#0000]<n> <vp>*<n> - يعرض الملف الشخصي للاعب المحدد في الكرة الطائرة<br><j>!stoptimer<n> <vp>*<n> - يوقف وقت الانتظار <br><j>!3teamsmode<n> <ch>[true or false]<n> <vp>*<n> - لتفعيل وضع 3 فرق<br><j>!threeballs<n> <ch>[true or false]<n> <vp>*<n> - لتفعيل وضع 3 كرات في وضع 3 فرق"}
  },
  creditsTitle = "<p align='center'><font size='16px'>شكر خاص (الكرة الطائرة)",
  creditsText = "<br><br><p align='right'><font size='12px'>تم تطوير اللعبة من طرف <j>Refletz#6472 (Soristl)<n><br><br>ترجمة BR/EN: <j>Refletz#6472 (Soristl)<n><br><br>ترجمة AR: <j>Ionut_eric_pro#1679<n><br><br>ترجمة FR: <j>Rowed#4415<n><br><br>ترجمة PL: <j>Prestige#5656<n>",
  messageSetMaxPlayers = "الحد الأقصى لعدد اللاعبين الذين تم وضعهم هو",
  newPassword = "كلمة المرور الجديدة:",
  passwordRemoved = "<bv>تمت إزالة كلمة المرور<n>",
  messageMaxPlayersAlert = "<bv>يجب أن يكون الحد الأقصى لعدد اللاعبين 6 لاعبين كحد أدنى و20 كحد أقصى<n>",
  previousMessage = "<p align='center'>الخلف",
  nextMessage = "<p align='center'>التالي",
  realModeRules = "<p align='center'><font size='16px'>قواعد الوضع الحقيقي للكرة الطائرة<br><br><p align='right'><font size='12px'><b>- يمكن لكل فريق الانضمام <b>يتحول</b> إلى <vi>جسم كروي<n> 3 مرات فقط (باستثناء <b>الإرسال</b> الذي يكون مرة واحدة فقط)<br><br>- إذا ذهبت الكرة خرجت إلى جانب فريقك و<b>لم يتحول أي شخص</b> في فريقك إلى <vi>جسم كروي<n> فالنقطة تخص فريقك<br><br>-  إذا خرجت الكرة وشخص ما من فريقك الفريق <b>الذي تحول إلى</b> <vi><b>جسم كروي<b><n> النقطة مملوكة للخصم<br><br>- سيرسل كل لاعب الكرة مرة واحدة  <br><br>-فسيتمكن اللاعب من تنفيذ إجراء لمدة <j>7 ثوانٍ<n>، وإلا فلن يتمكن اللاعب من استخدام <j>مفتاح المسافة<n><br><br>-تعمل المفاتيح 1 و2 و3 و4 على تغيير قوة اللاعب",
  titleSettings = "<p align='center'><font size='16px'>إعدادات الغرفة</p>",
  textSettings = "<p align='left'><font size='12px'><textformat leading='30'>اختر وضع اللعبة<br>تفعيل أمر !randomball</textformat><br><br>تفعيل أمر !randommap<br><br><br>تفعيل أمر !twoballs</p>",
  textSettings2 = "<p align='left'><font size='12px'><textformat leading='30'>حدد حجم الخريطة (!setmap) (الوضع العادي)<br>قم بتنشيط أمر !consumables (الوضع العادي)</textformat><br>تفعيل وضع ثلاث كرات لثلاثة فرق",
  msgAchievements = "<p align='right'><font size='14px'>الإنجازات:",
  msgsTrophies = {
    [1] = "كأس العالم للكرة الطائرة",
    [2] = "شارة فريق FootVolley Ultimate Team",
    [3] = "كأس العالم لكرة القدم الطائرة",
    [4] = "شارة روليت الطائرة",
    [5] = "شارة الكرة الطائرة البرية"
  },
  mapSelect = 'حدد الخريطة'
}

lang.fr = {
  welcomeMessage = "<j>Bienvenue au Volley, un jeu créé par Refletz#6472<n>",
  welcomeMessage2 = "<j>Tapez !join pour rejoindre la partie<n>",
  msgRedWinner = "L'équipe rouge a gagné!",
  msgBlueWinner = "L'équipe bleue a gagné!",
  menuOpenText = "<br><br><a href='event:howToPlay'>Comment jouer</a><br><a href='event:realmode'>Mode Réel de Volley</a><br><a href='event:ranking'>Ranking</a><br><a href='event:credits'>Crédits</a><br>",
  closeUIText = "<p align='center'><font size='12px'><a href='event:closeWindow'>Fermer",
  helpTitle = "<p align='center'><font size='16px'>Comment jouer au Volley ("..gameVersion..")",
  helpText = {
    [1] = { text = "<br><br><p align='left'><font size='12px'>L'objectif du volley est d'éviter que la balle ne tombe sur le sol de votre côté du terrain, et pour éviter cela, vous pouvez transformer votre souris en un objet circulaire en pressant la touche <j><br>[ Espace ]<n>, la souris reprend sa forme originale 3 secondes plus tard. L'équipe qui marque 7 points en première gagne!<br>Créer un salon avec admin: <bv><a href='event:roomadmin'>/salon *#volley0VotreNom#0000</a><n><br><br>Commandes (<rose>*<n> = durant la partie | <vp>*<n> = commandes admin):<br><br><j>!lang<n> <ch>"..languages.."<n> - Pour modifier la langue du mini-jeu<br><j>!join<n> <rose>*<n> - Pour rejoindre la partie<br><j>!leave<n> <rose>*<n> - Pour quitter la partie et aller dans la zone des spectateurs<br><j>!resettimer<n> <vp>*<n> - Réinitialise le temps dans le lobby avant de commencer la partie<br><j>!setmap<n> <ch>[small/large/extra-large]<n> <vp>*<n> - Pour sélectionner une carte spécifique avant de commencer la partie"},
    [2] = { text = "<p align='left'><font size='12px'><br><br>Commandes (<rose>*<n> = durant la partie | <vp>*<n> = commandes admin):<br><br><j>!pw<n> <ch>[password]<n> <vp>*<n> - Mettre un mot de passe dans le salon<br><j>!winscore<n> <ch>[nombre]<n> <rose>*<n> <vp>*<n> - Change le score à atteindre pour gagner la partie<br><j>!customMap<n> <ch>[true ou false]<n> <ch>[index de la carte]<n> <vp>*<n> - Sélectionne une carte customisée<br><j>!maps<n> - Affiche la liste de cartes<br><j>!votemap<n> <ch>[nombre]<n> - Vote pour une carte customisée pour la prochaine partie<br><j>!setscore<n> <ch>[Nom du joueur]<n> <ch>[nombre]<n> <rose>*<n> <vp>*<n> - Change le score du joueur par le nombre<br><j>!setscore<n> <ch>[Nom du joueur]<n> <rose>*<n> <vp>*<n> - Ajoute +1 au score du joueur<br><j>!setscore<n> <ch>[red ou blue]<n> <ch>[nombre]<n> <rose>*<n> <vp>*<n> - Change le score de l'équipe par le nombre<br><j>!4teamsmode<n> <ch>[true ou false]<n> <vp>*<n> - Sélectionne le mode de 4 équipes au Volley"},
    [3] = { text = "<p align='left'><font size='12px'><br><br>Commandes (<rose>*<n> = durant la partie | <vp>*<n> = commandes admin)<br><br><j>!setmaxplayers <ch>[6 - 20]<n> <vp>*<n> - Sélectionne le nombre maximum de joueurs pouvant entrer dans le salon<br><j>!balls<n> - Affiche la liste des balles customisées du #Volley<br><j>!customball<n> <ch>[Nombre]<n> <vp>*<n> - Sélectionne une balle customisée pour la prochaine partie<br><j>!lobby<n> <rose>*<n> <vp>*<n> - Termine un match en cours et retourne au lobby<br><j>!setplayerforce<n> <ch>[Nombre: 0 - 1.05]<n> <vp>*<n> - Sélectionne la force pour l'objet sphérique de la souris<br><j>!2teamsmode<n> <ch>[true ou false]<n> <vp>*<n> - Sélectionne le mode de jeu spécial à 2 équipes<br><j>!sync<n> <vp>*<n> - Le système choisit le joueur avec la latence la plus faible pour synchroniser le salon<br><j>!synctfm<n> <vp>*<n> - Le système TFM choisit le joueur avec la latence la plus faible pour synchroniser le salon"},
    [4] = { text = "<p align='left'><font size='12px'><br><br>Commandes (<rose>*<n> = durant la partie | <vp>*<n> = commandes amdin)<br><br><j>!skiptimer<n> <vp>*<n> - Commence la partie le plus vite possible<br><j>!realmode<n> <ch>[true ou false]<n> <vp>*<n> - Sélectionne le mode réel de volée<br><j>!twoballs<n> <ch>[true ou false] <n> <vp>*<n> - Active deux balles dans le jeu<br><j>!consumables<n> <ch>[true ou false]<n> <vp>*<n> - Choisissez un consommable avec les touches (7, 8, 9 et 0) et activez-les en appuyant sur M en mode normal<br><j>!settings<n> <vp>*<n> - Commande pour effectuer les réglages globaux dans la pièce<br><j>!setsync<n> <vp>*<n> - Sélectionne la synchronisation pour le lecteur<br><j>!crown<n> <ch>[true ou false]<n> - Activer/désactiver les images de couronne"},
    [5] = { text = "<p align='left'><font size='12px'><br><br>Commandes (<rose>*<n> = durant la partie | <vp>*<n> = commandes amdin)<br><br><j>!profile<n> <vp>*<n> - Affiche votre profil sur Volley, vous pouvez également ouvrir votre profil en utilisant la touche P<br><j>!profile<n> <ch>[playerName#0000]<n> <vp>*<n> - Affiche le profil du joueur sélectionné dans Volley<br><j>!stoptimer<n> <vp>*<n> - Arrête le temps du lobby<br><j>!3teamsmode<n> <ch>[true ou false]<n> <vp>*<n> - Active le mode à 3 équipes<br><j>!threeballs<n> <ch>[true ou false]<n> <vp>*<n> - Active le mode à 3 balles en mode 3 équipes"}
  },
  creditsTitle = "<p align='center'><font size='16px'>Crédits (Volley)",
  creditsText = "<br><br><p align='left'><font size='12px'>Le jeu a été développé par <j>Refletz#6472 (Soristl)<n><br><br>BR/EN Translation: <j>Refletz#6472 (Soristl)<n><br><br>AR Translation: <j>Ionut_eric_pro#1679<n><br><br>FR Translation: <j>Rowed#4415<n><br><br>PL Translation: <j>Prestige#5656<n>",
  messageSetMaxPlayers = "Nombre de joueurs maximum mis à",
  newPassword = "Nouveau mot de passe:",
  passwordRemoved = "<bv>Mot de passe retiré<n>",
  messageMaxPlayersAlert = "<bv>Le maximum de joueurs doit être au minimum de 6 et au maximum de 20<n>",
  previousMessage = "<p align='center'>Précédent",
  nextMessage = "<p align='center'>Suivant",
  realModeRules = "<p align='center'><font size='16px'>Règles du Volley Real Mode<br><br><p align='left'><font size='12px'><b>- Chaque équipe peut se <b>transformer</b> en un <vi>objet sphérique<n> seulement 3 fois (sauf pour le <b>service</b> où ce n'est qu'UNE fois)<br><br>- Si la balle va dehors de votre côté du terrain et que <b>personne</b> de votre équipe ne s'est transformé en un <vi>objet sphérique<n> le point est pour votre équipe<br><br>- Si la balle va dehors et que quelqu'un de votre équipe <b>s'est transformé</b> en un <vi><b>objet sphérique<b><n> le point revient à l'adversaire<br><br>- Chaque joueur servira la balle une fois <br><br>- Si le joueur quitte le terrain, le joueur pourra effectuer une action pendant <j>7 secondes<n>, autrement le joueur ne sera pas capable d'utiliser la <j>touche espace<n><br><br>- Les touches 1, 2, 3 et 4 changent la force du joueur.",
  titleSettings = "<p align='center'><font size='16px'>Paramètres de la salle</p>",
  textSettings = "<p align='left'><font size='12px'><textformat leading='30'>Sélectionner le mode de jeu<br>Activer la commande !randomball</textformat><br><br>Activer la commande !randommap<br><br><br>Activer la commande !twoballs</p>",
  textSettings2 = "<p align='left'><font size='12px'><textformat leading='30'>Sélectionnez la taille de la carte (!setmap) (mode normal)<br>Activez la commande !consumables (mode normal)</textformat><br>Activez le mode à trois balles pour trois équipes.",
  msgAchievements = "<p align='left'><font size='14px'>Réalisations:",
  msgsTrophies = {
    [1] = "Trophée de la Coupe du Monde de Volleyball",
    [2] = "FootVolley Ultimate Team Badge",
    [3] = "Coupe de monde de soccer volley",
    [4] = "Volley Roulette badge",
    [5] = "Volley Wild Card badge"
  },
  mapSelect = 'Sélectionner une carte'
}

lang.pl = {
  welcomeMessage = "<j>Witaj w Volley, gra została stworzona przez Refletz#6472<n>",
  welcomeMessage2 = "<j>Wpisz !join, by dołączyć do meczu<n>",
  msgRedWinner = "Drużyna czerwonych wygrała!",
  msgBlueWinner = "Drużyna niebieskich wygrała!",
  menuOpenText = "<br><br><a href='event:howToPlay'>Jak grać</a><br><a href='event:realmode'>Volley Real Mode</a><br><a href='event:ranking'>Ranking</a><br><a href='event:credits'>Credits</a><br>",
  closeUIText = "<p align='center'><font size='12px'><a href='event:closeWindow'>Close",
  helpTitle = "<p align='center'><font size='16px'>Jak grać w Volley ("..gameVersion..")",
  helpText = {
    [1] = { text = "<br><br><p align='left'><font size='12px'>Celem siatkówki jest zapobieganie upadkowi piłki na podłogę twojego boiska, a aby to osiągnąć, możesz zamienić myszkę w okrągły obiekt, naciskając przycisk <j>[ Space ]<n> Mysz wraca do pierwotnego kształtu po 3 sekundach. Drużyna, która pierwsza zdobędzie 7 punktów, wygrywa!<br>Stwórz swój pokój: <bv><a href='event:roomadmin'>/room *#volley0YourName#0000</a><n><br><br>Komendy (<rose>*<n> = podczas meczu | <vp>*<n> = komendy administratora):<br><br><j>!lang<n> <ch>"..languages.."<n> - Aby zmodyfikować język minigry<br><j>!join<n> <rose>*<n> - Aby dołączyć do meczu<br><j>!leave<n> <rose>*<n> - Aby opuścić mecz i przejść do strefy oglądających<br><j>!resettimer<n> <vp>*<n> - Resetuje czas w lobby przed rozpoczęciem się meczu<br><j>!setmap<n> <ch>[small/large/extra-large]<n> <vp>*<n> - Aby wybrać określoną mapę przed rozpoczęciem meczu<br><j>!pw<n> <ch>[hasło]<n> <vp>*<n> - Ustaw hasło w pokoju"},
    [2] = { text = "<p align='left'><font size='12px'><br><br>Komendy (<rose>*<n> = podczas meczu | <vp>*<n> = komendy administratora):<br><br><j>!winscore<n> <ch>[liczba]<n> <rose>*<n> <vp>*<n> - Zmień maksymalną ilość punktów by wygrać mecz<br><j>!customMap<n> <ch>[true or false]<n> <ch>[map index]<n> <vp>*<n> - Wybierz niestandardową mapę<br><j>!maps<n> - Pokazuje listę map<br><j>!votemap<n> <ch>[liczba]<n> - Głosowanie za niestadardową mapę w następnym meczu<br><j>!setscore<n> <ch>[nazwa gracza]<n> <ch>[liczba]<n> <rose>*<n> <vp>*<n> - Zmień wynik gracza na liczbę<br><j>!setscore<n> <ch>[nazwa gracza]<n> <rose>*<n> <vp>*<n> - Dodaje +1 do wyniku gracza<br><j>!setscore<n> <ch>[red or blue]<n> <ch>[liczba]<n> <rose>*<n> <vp>*<n> - Zmień wynik drużyny<br><j>!4teamsmode<n> <ch>[true or false]<n> <vp>*<n> - Wybierz 4-drużynowy Volley mode"},
    [3] = { text = "<p align='left'><font size='12px'><br><br>Komendy (<rose>*<n> = podczas meczu | <vp>*<n> = komendy administratora)<br><br><j>!setmaxplayers <ch>[6 - 20]<n> <vp>*<n> - Wybierz maksymalną ilość graczy, którzy mogą dołączyć do pokoju<br><j>!balls<n> - Pokazuje listę niestandardowych piłek #Volley<br><j>!customball<n> <ch>[liczba]<n> <vp>*<n> - Wybierz niestandardową piłkę na następny mecz<br><j>!lobby<n> <rose>*<n> <vp>*<n> - Zakończ mecz, który był w trakcie i wróć do lobby<br><j>!setplayerforce<n> <ch>[Number: 0 - 1.05]<n> <vp>*<n> - Wybierz siłę dla okrągłego obiektu myszy<br><j>!2teamsmode<n> <ch>[true or false]<n> <vp>*<n> - Wybierz tryb specjalny dwóch drużyn<br><j>!sync<n> <vp>*<n> - System wybiera gracza z najniższym opóźnieniem, aby zsynchronizować pokój<br><j>!synctfm<n> <vp>*<n> - System TFM wybiera gracza z najniższym opóźnieniem, aby zsynchronizować pokój"},
    [4] = { text = "<p align='left'><font size='12px'><br><br>Komendy (<rose>*<n> = podczas meczu | <vp>*<n> = komendy administratora)<br><br><j>!skiptimer<n> <vp>*<n> - Uruchom grę tak szybko, jak to możliwe<br><j>!realmode<n> <ch>[true or false]<n> <vp>*<n> - Wybiera tryb prawdziwej siatkówki<br><j>!twoballs<n> <ch>[true or false] <n> <vp>*<n> - Aktywuje dwie kule w grze<br><j>!consumables<n> <ch>[true or false]<n> <vp>*<n> - Wybierz materiał eksploatacyjny za pomocą klawiszy (7, 8, 9 i 0) i aktywuj je naciskając M w trybie normalnym<br><j>!settings<n> <vp>*<n> - Polecenie wykonania globalnych ustawień w pomieszczeniu<br><j>!setsync<n> <vp>*<n> - Wybiera synchronizację odtwarzacza<br><j>!crown<n> <ch>[true or false]<n> - Włącz/wyłącz obrazy korony"},
    [5] = { text = "<p align='left'><font size='12px'><br><br>Komendy (<rose>*<n> = podczas meczu | <vp>*<n> = komendy administratora)<br><br><j>!profile<n> <vp>*<n> - Pokazuje Twój profil na Volley, możesz także otworzyć swój profil za pomocą klawisza P<br><j>!profile<n> <ch>[playerName#0000]<n> <vp>*<n> - Pokazuje profil wybranego zawodnika w grze Volley<br><j>!stoptimer<n> <vp>*<n> - Zatrzymuje czas w poczekalni<br><j>!3teamsmode<n> <ch>[true lub false]<n> <vp>*<n> - Aktywuje tryb 3 drużyn<br><j>!threeballs<n> <ch>[true lub false]<n> <vp>*<n> - Aktywuje tryb 3 piłek w trybie 3 drużyn"}
  },
  creditsTitle = "<p align='center'><font size='16px'>Credits (Volley)",
  creditsText = "<br><br><p align='left'><font size='12px'>Gra została stworzona przez <j>Refletz#6472 (Soristl)<n><br><br>BR/EN Tłumaczenie: <j>Refletz#6472 (Soristl)<n><br><br>AR Tłumaczenie: <j>Ionut_eric_pro#1679<n><br><br>FR Tłumaczenie: <j>Rowed#4415<n><br><br>PL Tłumaczenie: <j>Prestige#5656<n>",
  messageSetMaxPlayers = "Z maksymalną liczbą graczy umieszczoną dla",
  newPassword = "Nowe hasło:",
  passwordRemoved = "<bv>Hasło usunięte<n>",
  messageMaxPlayersAlert = "<bv>Maksymalna liczba graczy musi wynosić minimum 6, a maksimum 20<n>",
  previousMessage = "<p align='center'>Powrót",
  nextMessage = "<p align='center'>Następny",
  realModeRules = "<p align='center'><font size='16px'>Zasady trybu Volley Real Mode<br><br><p align='left'><font size='12px'><b>- Każda drużyna może się zmienić <b>transform</b> w <vi>okrągły obiekt<n> tylko 3 razy (nielicząc <b>serwa</b> który jest tylko raz)<br><br>- Jeśli piłka wyląduje poza boiskiem po stronie twojego zespołu i <b>nikt</b> z twojej drużyny nie przekształcił się w <vi>okrągły obiekt<n> wtedy punkt jest zdobyty przez twoją drużynę<br><br>- Jeśli piłka wylądowała poza boiskiem i ktoś z twojej drużyny <b>zmienił się w</b> <vi><b>okrągły obiekt<b><n> wtedy punkt należy do drużyny przeciwnej<br><br>- Każdy z graczy serwuje raz <br><br>- Jeśli zawodnik opuści boisko, będzie mógł wykonać akcję przez <j>7 sekund<n>, w przeciwnym razie zawodnik nie będzie mógł użyć <j>klawiszu spacji<n><br><br>- Klawisze 1, 2, 3 i 4 zmieniają siłę gracza",
  titleSettings = "<p align='center'><font size='16px'>Ustawienia pokoju</p>",
  textSettings = "<p align='left'><font size='12px'><textformat leading='30'>Wybierz tryb gry<br>Aktywuj polecenie !randomball</textformat><br><br>Aktywuj polecenie !randommap<br><br><br>Aktywuj polecenie !twoballs</p>",
  textSettings2 = "<p align='left'><font size='12px'><textformat leading='30'>Wybierz rozmiar mapy (!setmap) (tryb normalny)<br>Aktywuj polecenie !consumables (tryb normalny)</textformat><br>Aktywuj tryb gry z trzema piłkami dla trzech drużyn.",
  msgAchievements = "<p align='left'><font size='14px'>Osiągnięcia:",
  msgsTrophies = {
    [1] = "Trofeum Pucharu Świata w siatkówce",
    [2] = "FootVolley Ultimate Team Badge",
    [3] = "Puchar Świata w piłce siatkowej",
    [4] = "Volley Roulette badge",
    [5] = "Volley Wild Card badge"
  },
  mapSelect = 'Wybierz mapę'
}



--[[ src/timer.lua ]]--

local List = {}
function List.new ()
  return {first = 0, last = -1}
end

function List.pushleft (list, value)
  local first = list.first - 1
  list.first = first
  list[first] = value
end

function List.pushright (list, value)
  local last = list.last + 1
  list.last = last
  list[last] = value
end

function List.popleft (list)
  local first = list.first
  if first > list.last then
    return nil
  end
  local value = list[first]
  list[first] = nil        -- to allow garbage collection
  list.first = first + 1
  return value
end

function List.popright (list)
  local last = list.last
  if list.first > last then
    return nil
  end
  local value = list[last]
  list[last] = nil         -- to allow garbage collection
  list.last = last - 1
  return value
end

-- the lib
local timerList = {}
local timersPool = List.new()

function addTimer(callback, ms, loops, label, ...)
  local id = List.popleft(timersPool)
  if id then
    local timer = timerList[id]
    timer.callback = callback
    timer.label = label
    timer.arguments = {...}
    timer.time = ms
    timer.currentTime = 0
    timer.currentLoop = 0
    timer.loops = loops or 1
    timer.isComplete = false
    timer.isPaused = false
    timer.isEnabled = true
  else
    id = #timerList+1
    timerList[id] = {
      callback = callback,
      label = label,
      arguments = {...},
      time = ms,
      currentTime = 0,
      currentLoop = 0,
      loops = loops or 1,
      isComplete = false,
      isPaused = false,
      isEnabled = true,
    }
  end
  return id
end

function getTimerId(label)
  local found
  for id = 1, #timerList do
    local timer = timerList[id]
    if timer.label == label then
      found = id
      break
    end
  end
  return found
end

function pauseTimer(id)
  if type(id) == 'string' then
    id = getTimerId(id)
  end

  if timerList[id] and timerList[id].isEnabled then
    timerList[id].isPaused = true
    return true
  end
  return false
end

function resumeTimer(id)
  if type(id) == 'string' then
    id = getTimerId(id)
  end

  if timerList[id] and timerList[id].isPaused then
    timerList[id].isPaused = false
    return true
  end
  return false
end

function removeTimer(id)
  if type(id) == 'string' then
    id = getTimerId(id)
  end

  if timerList[id] and timerList[id].isEnabled then
    timerList[id].isEnabled = false
    List.pushright(timersPool, id)
    return true
  end
  return false
end

function clearTimers()
  local timer
  repeat
    timer = List.popleft(timersPool)
    if timer then
      table.remove(timerList, timer)
    end
  until timer == nil
end

function timersLoop()
  for id = 1, #timerList do
    local timer = timerList[id]
    if timer.isEnabled and timer.isPaused == false then
      if not timer.isComplete then
        timer.currentTime = timer.currentTime + 500
        if timer.currentTime >= timer.time then
          timer.currentTime = 0
          timer.currentLoop = timer.currentLoop + 1
          if timer.loops > 0 then
            if timer.currentLoop >= timer.loops then
              timer.isComplete = true
              if eventTimerComplete ~= nil then
                eventTimerComplete(id, timer.label)
              end
              removeTimer(id)
            end
          end
          if timer.callback ~= nil then
            timer.callback(timer.currentLoop, table.unpack(timer.arguments))
          end
        end
      end
    end
  end
end


--[[ src/main.lua ]]--

-- from https://www.lua.org/pil/11.4.html
local branch = "test"

local admins = 
{
  ["Refletz#6472"] = true,
  ["Soristl1#0000"] = true, 
  ["+Mimounaaa#0000"] = true,
  ["Axeldoton#0000"] = true,
  ["Nagi#6356"] = true,
  ["Wreft#5240"] = true,
  ["Lylastyla#0000"] = true,
  ["Ppoppohaejuseyo#2315"] = true,
  ["Rowed#4415"] = true,
  ["Tanarchosl#4785"] = true,
  ["Sadzia#0000"] = true
}

local permanentAdmins = 
{
  "Refletz#6472",
  "+Mimounaaa#0000",
  "Lylastyla#0000",
  "Ppoppohaejuseyo#2315",
  "Sadzia#0000"
}

local inactivePermanentAdmins = {
  "Soristl1#0000",
  "Nagi#6356",
  "Wreft#5240",
  "Tanarchosl#4785",
  "Axeldoton#0000",
  "Rowed#4415"
}

local trad = ""

if tfm.get.room.language == "br" then
  trad = lang.br
elseif tfm.get.room.language == "en" then
  trad = lang.en
elseif tfm.get.room.language == "ar" then
  trad = lang.ar
elseif tfm.get.room.language == "fr" then
  trad = lang.fr
elseif tfm.get.room.language == "pl" then
  trad = lang.pl
else
  trad = lang.en
end


local regex = "#volley%d+([%+_]*[%w_#]+)"
local getRoomAdmin = string.match(tfm.get.room.name, regex)

if getRoomAdmin ~= nil then
  admins[getRoomAdmin] = true
end

tfm.exec.disableAutoShaman(true)
tfm.exec.disableAutoNewGame(true)
tfm.exec.disableAutoScore (true)
tfm.exec.disableAutoTimeLeft (true)
tfm.exec.disablePhysicalConsumables (true)
tfm.exec.disableAfkDeath (true)
tfm.exec.setRoomMaxPlayers(16)
system.disableChatCommandDisplay (nil, true)
tfm.exec.disableMortCommand(true)

local playerCanTransform = {}
local playerForce = {}
local playerBan = {}
local playerBanHistory = {}
local playerInGame = {}
local countId = 1
local playerPhysicId = {}
local playerLanguage = {}
local killSpecPermanent = false

local x = {100, 280, 280, 640, 460, 460, 100, 100, 280, 640, 460, 640}
local y = {100, 100, 160, 100, 100, 160, 160, 220, 220, 160, 220, 220}
local score_red = 0
local score_blue = 0
local ball_id = 6
local ballOnGame = false
local ballOnGame2 = false
local playerConsumable = {}
local playerConsumableItem = {}
local playerConsumables = {}
local playerLeftRight = {}
local playerConsumableKey = {}
local ballOnGameTwoBalls = {}
local ballsId = {}
local gameStats = {gameMode = ''}
local pagesList = {}
local mapsVotes = {}
local canVote = {}
local playerOutOfCourt = {}
local showOutOfCourtText = {}
local globalSettings = { mode = 'Normal mode', twoBalls = false, randomBall = false, randomMap = false, mapType = '', consumables = false, threeBalls = false }
local settings = {}
local settingsMode = {}
local playersNormalMode = {}
local rankNormalMode = {}
local playersOnGameHistoric = {}
local pageNormalMode = {}
local playerRankingMode = {}
local playersFourTeamsMode = {}
local rankFourTeamsMode = {}
local pageFourTeamsMode = {}
local rankTwoTeamsMode = {}
local playersTwoTeamsMode = {}
local pageTwoTeamsMode = {}
local rankRealMode = {}
local playersRealMode = {}
local pageRealMode = {}
local rankThreeTeamsMode = {}
local playersThreeTeamsMode = {}
local pageThreeTeamsMode = {}
local openRank = {}
local countMatches = 0
local playerLastMatchCount = {}
local playerLeft = {}

local showCrownImages = {}
local redCrown = {'15296835cdd.png', '1529683757b.png', '15296838f74.png', '1529683a830.png', '1529683c1e0.png', '1529655c3e4.png', '1529655df16.png', '1529655fb1b.png', '152965616ff.png', '15296563a9e.png'}
local blueCrown = {'1529682cc1e.png', '1529682e815.png', '15296830d1a.png', '1529683291f.png', '15296834389.png', '1529653b65f.png', '1529653d855.png', '1529653fa44.png', '15296541aed.png', '15296543994.png'}
local yellowCrown = {'192e02e0140.png', '192e02e18b0.png', '192e02e3022.png', '192e02e4795.png', '192e02e5f06.png', '192e02e767b.png', '192e02e8deb.png', '192e02ea7b1.png', '192e02ebf90.png', '192e02ed701.png'}
local greenCrown = {'192e02d16d0.png', '192e02d2e3f.png', '192e02d45b2.png', '192e02d5d22.png', '192e02d7494.png', '192e02d8c06.png', '192e02da37a.png', '192e02dbaea.png', '192e02dd25c.png', '192e02de9ce.png'}
local rankCrown = {}

local playerAchievements = {}
local playerAchievementsImages = {}
local playerTrophyImage = {}
local isOpenProfile = {}

local selectMapOpen = {}
local selectMapPage = {}
local selectMapImages = {}
local customMapCommand = {}

local lobbySpawn = {}
local playersSpawn400 = {}
local playersSpawn800 = {}
local playersSpawn1200 = {}
local playersSpawn1600 = {}
local playersAfk = {}
local pagePlayerSettings = {}
local maxPageSettings = 2
local threeTeamsMode = {id = {1, 2, 3, 4, 5, 6, 8, 9, 10, 11, 12, 13}, x = {100, 280, 460, 640, 100, 280, 460, 640, 100, 280, 460, 640}, y = {100, 100, 100, 100, 160, 160, 160, 160, 220, 220, 220, 220}}

local gameTimeEnd = os.time() + 5000

local keys = {32, 0, 1, 2, 3, 49, 50, 51, 52, 55, 56, 57, 48, 77, 76, 80}

for name, data in pairs(tfm.get.room.playerList) do
  customMapCommand[name] = true
  selectMapOpen[name] = false
  selectMapPage[name] = 1
  selectMapImages[name] = {}
  
  isOpenProfile[name] = false
  playerTrophyImage[name] = 0
  
  if playerAchievements[name] == nil then
    playerAchievements[name] = {
      [1] = { image = "img@193d6763c82", quantity = 0 },
      [2] = { image = '19636907e9e.png', quantity = 0},
      [3] = { image = "197d9272515.png", quantity = 0 },
      [4] = { image = "1984ac78d52.png", quantity = 0 },
      [5] = { image = "1984ac773d3.png", quantity = 0 }
    }
  end
  
  pagePlayerSettings[name] = 1
  playersAfk[name] = os.time()
  playerAchievementsImages[name] = {}
  showCrownImages[name] = true
  playersNormalMode[name] = {name = name, matches = 0, wins = 0, winRatio = 0, winsRed = 0, winsBlue = 0}
  pageNormalMode[name] = 1
  playersFourTeamsMode[name] = {name = name, matches = 0, wins = 0, winRatio = 0, winsRed = 0, winsBlue = 0, winsYellow = 0, winsGreen = 0}
  pageFourTeamsMode[name] = 1
  playersThreeTeamsMode[name] = {name = name, matches = 0, wins = 0, winRatio = 0, winsRed = 0, winsBlue = 0, winsGreen = 0}
  pageThreeTeamsMode[name] = 1
  playersTwoTeamsMode[name] = {name = name, matches = 0, wins = 0, winRatio = 0, winsRed = 0, winsBlue = 0}
  pageTwoTeamsMode[name] = 1
  playersRealMode[name] = {name = name, matches = 0, wins = 0, winRatio = 0, winsRed = 0, winsBlue = 0}
  pageRealMode[name] = 1
  playerRankingMode[name] = "Normal mode"
  playerLeft[name] = false
  openRank[name] = false
  settings[name] = false
  settingsMode[name] = false
  playerLanguage[name] = {tr = trad, name = name}
  playerOutOfCourt[name] = false
  playerCanTransform[name] = true
  playerInGame[name] = false
  playerPhysicId[name] = 0
  playerBan[name] = false
  playerBanHistory[name] = ""
  showOutOfCourtText[name] = false

  tfm.exec.chatMessage(playerLanguage[name].tr.welcomeMessage, name)
  tfm.exec.chatMessage("<n>#Volley Version: <j>"..gameVersion, name)
  tfm.exec.chatMessage("<n>Join our #Volley Discord server: <ce>https://discord.com/invite/pWNTesmNhu<n><br>", name)

  if tfm.get.room.isTribeHouse then
    if tfm.get.room.name:sub(3) == tfm.get.room.playerList[name].tribeName then
      if name == "Tonycoolnees#0000" then
        permanentAdmins[#permanentAdmins + 1] = "Tonycoolnees#0000"
      end
      admins[name] = true
    end
  end

  for i = 1, #keys do
    system.bindKeyboard(name, keys[i], true, true)
  end
end


--[[ src/events/eventChatCommand.lua ]]--

local short_commands = { j = "join", l = "leave", la = "lang", ads = "admins", b = "balls", 
                   vm = "votemap", cr = "crown", pr = "profile", rt = "resettimer",
                   skip = "skiptimer", stop = "stoptimer", smp = "setmaxplayers",
                   w = "winscore", rm = "randommap", cm = "custommap", bc = "ballcoords",
                   ssc = "setscore", ftm = "4teamsmode", rm = "realmode",
                   a = "admin", ua = "unadmin", k = "kick", f = "fleave", b = "ban",
                   ub = "unban", rb = "randomball", cb = "customball", lo = "lobby",
                   ks = "killspec", p = "pause", sy = "sync", ssy = "setsync",
                   syt = "synctfm", lsy = "listsync", spf = "setplayerforce", 
                   t = "test", tt = "2teamsmode", afk = "afksystem", sat = "setafktime",
                   tb = "twoballs", co = "consumables", se = "settings", dc = "discord"
                }

function eventChatCommand(name, c)
  local command = string.lower(c)
  
  if short_commands[command] then
    command = short_commands[command]
  end

  local permanentAdmin = isPermanentAdmin(name)
  

  if command == "join" and playerInGame[name] == false and mode == "gameStart" then
    local isPlayerBanned = messagePlayerIsBanned(name)
    if isPlayerBanned then
      return
    end

    if gameStats.threeTeamsMode and gameStats.canTransform then
      if tfm.get.room.playerList[name].isDead then
        tfm.exec.respawnPlayer(name)
      end

      chooseTeamThreeTeamsMode(name)
      showCrownToAllPlayers()
      return
    end

    if gameStats.teamsMode and gameStats.canTransform then
      if tfm.get.room.playerList[name].isDead then
        tfm.exec.respawnPlayer(name)
      end
      chooseTeamTeamsMode(name)
      showCrownToAllPlayers()
      return
    else
      if not gameStats.teamsMode then
        if tfm.get.room.playerList[name].isDead then
          tfm.exec.respawnPlayer(name)
        end
        chooseTeam(name)
        showCrownToAllPlayers()
        return
      end
      tfm.exec.chatMessage("<bv>The join command is disabled now, please try the same command in few seconds<n>", name)
      return
    end
  elseif command == "leave" and playerInGame[name] and mode == "gameStart" then
    local isPlayerBanned = messagePlayerIsBanned(name)
    if isPlayerBanned then
      return
    end

    if gameStats.threeTeamsMode and gameStats.canTransform then
      leaveTeamTeamsMode(name)
      return
    end

    if gameStats.teamsMode and gameStats.canTransform then
      leaveTeamTeamsMode(name)
      return
    else
      if not gameStats.teamsMode then
        leaveTeam(name)
        return
      end
      tfm.exec.chatMessage("<bv>The leave command is disabled now, please try the same command in few seconds<n>", name)
      return
    end
  elseif command:sub(1,4)=="lang" then
    local language = string.lower(command:sub(6,7))
    if language == "en" then
      playerLanguage[name].tr = lang.en
    elseif language == "br" then
      playerLanguage[name].tr = lang.br
    elseif language == "ar" then
      playerLanguage[name].tr = lang.ar
    elseif language == "fr" then
      playerLanguage[name].tr = lang.fr
    elseif language == "pl" then
      playerLanguage[name].tr = lang.pl
    end
  elseif command == "admins" then
    local pAdminsList = ""
    local adminsList = ""
    local inactiveAdminsList = ""
    for name1, data in pairs(admins) do
      local isPermanentAdminList = isPermanentAdmin(name1)
      local isInactiveAdminList = isInactivePermanentAdmin(name1)

      if isPermanentAdminList then
        pAdminsList = ""..pAdminsList.." "..name1..""
      end

      if isInactiveAdminList then
        inactiveAdminsList = ""..inactiveAdminsList.." "..name1..""
      end

      if admins[name1] then
        adminsList = ""..adminsList.." "..name1..""
      end
    end
    tfm.exec.chatMessage("<j>Permanent Admins:"..pAdminsList.."<n>", name)
    tfm.exec.chatMessage("<bv>Admins:"..adminsList.."<n>", name)
    tfm.exec.chatMessage("Inactive Permanent Admins:"..inactiveAdminsList.."<n>", name)
  elseif command == "maps" then
    local str = "<bv>Volley maps"
    if gameStats.twoTeamsMode then
      for i = 1, #customMapsFourTeamsMode do
        str = ""..str.."\n"..i.."- "..customMapsFourTeamsMode[i][3]..""
      end
    elseif gameStats.teamsMode then
      for i = 1, #customMapsFourTeamsMode do
        str = ""..str.."\n"..i.."- "..customMapsFourTeamsMode[i][3]..""
      end
    else
      for i = 1, #customMaps do
        str = ""..str.."\n"..i.."- "..customMaps[i][3]..""
      end
    end
    if not gameStats.twoTeamsMode and not gameStats.teamsMode then
      str = ""..str.."\n\nto vote type !votemap number, example: !votemap 1<n>"
    end

    tfm.exec.chatMessage(str, name)
    print(str)
  elseif command == "balls" then
    local str = "<bv>Volley custom balls"
    for i = 1, #balls do
      str = ""..str.."\n"..i.."- "..balls[i].name..""
    end
    str = ""..str.."<n>"
    tfm.exec.chatMessage(str, name)
  elseif command:sub(1, 7) == "votemap" and mode == "startGame" and canVote[name] then
    local isPlayerBanned = messagePlayerIsBanned(name)
    if isPlayerBanned then
      return
    end

    if gameStats.realMode then
      commandNotAvailable(command:sub(1, 7), name)
      return
    end
    local args = split(command)

    if #args < 2 then
      return
    end

    if type(tonumber(args[2])) ~= "number" then
      tfm.exec.chatMessage('<bv>Second parameter invalid, must be a number<n>', name)
      return
    end

    local maps = configSelectMap()
    local indexMap = math.abs(math.floor(tonumber(args[2])))

    if type(indexMap) ~= "number" then
      tfm.exec.chatMessage('<bv>Second parameter invalid, must be a number<n>', name)
      return
    elseif indexMap < 1 or indexMap > #maps then
      tfm.exec.chatMessage('<bv>Second parameter invalid, the map index must be higher than 1 and less than '..tostring(#maps)..'<n>', name)
      return
    end

    canVote[name] = false
    if mapsVotes[indexMap] == nil then
      mapsVotes[indexMap] = 0
    end
    mapsVotes[indexMap] = mapsVotes[indexMap] + 1
    gameStats.totalVotes = gameStats.totalVotes + 1

    for name1, data in pairs(tfm.get.room.playerList) do
      if selectMapPage[name] == selectMapPage[name1] and selectMapOpen[name1] then
        selectMapUI(name1)
      end
    end

    verifyMostMapVoted()
    tfm.exec.chatMessage("<bv>"..name.." voted for the "..maps[indexMap][3].." map ("..tostring(mapsVotes[indexMap]).." votes), type !maps to see the maps list and to vote !votemap (number)<n>", nil)
  elseif command:sub(1, 5) == "crown" then
    local args = split(command)

    if args[2] ~= "true" and args[2] ~= "false" then
      tfm.exec.chatMessage('<bv>Second parameter invalid, must be true or false<n>', name)

      return
    end

    if args[2] == "true" then
      showCrownImages[name] = true

      return
    end

    showCrownImages[name] = false
  elseif command:sub(1, 7) == "profile" then
    closeRankingUI(name)
    removeButtons(25, name)
    removeButtons(26, name)
    removeUITrophies(name)
    local args = split(command)

    if #args == 1 then
      profileUI(name, name)
    else
      for name1, value in pairs(playerAchievements) do
        if string.lower(name1) == args[2] then
          profileUI(name, name1)
        end
      end
    end
  elseif command == "discord" then
    if permanentAdmin then
      tfm.exec.chatMessage("<bv>https://discord.com/invite/pWNTesmNhu", nil)  
      return
    end

    tfm.exec.chatMessage("<bv>https://discord.com/invite/pWNTesmNhu", name)
  end
  
  
  if admins[name] then
    local isPlayerBanned = messagePlayerIsBanned(name)
    if isPlayerBanned then
      return
    end

    if command == "resettimer" and mode == "startGame" then
      initGame = os.time() + 15000

      tfm.exec.chatMessage("<bv>resettimer command enabled by admin "..name.."<n>", nil)
    elseif command:sub(1,11) == "setduration" then
      local args = split(command)

      if #args >= 2 then
        if type(tonumber(args[2])) ~= "number" then
          print('<bv>Second parameter invalid, must be a number<n>', name)
          tfm.exec.chatMessage('<bv>Second parameter invalid, must be a number<n>', name)
          return
        end

        local timer = math.abs(math.floor(tonumber(args[2])))
        duration = os.time() + timer * 1000
        durationTimerPause = timer

        tfm.exec.setGameTime(durationTimerPause, true)
        print("<bv>The match duration was set to "..tostring(durationTimerPause).." seconds by admin "..name.."<n>")
        tfm.exec.chatMessage("<bv>The match duration was set to"..tostring(durationTimerPause).." seconds by admin "..name.."<n>", nil)

        return
      end

      duration = os.time() + durationDefault * 1000
      durationTimerPause = durationDefault
      tfm.exec.setGameTime(durationDefault, true)
      print("<bv>The match duration was set to "..tostring(durationDefault).." seconds by admin "..name.."<n>")
      tfm.exec.chatMessage("<bv>The match duration was set to"..tostring(durationDefault).." seconds by admin "..name.."<n>", nil)
    elseif command == "skiptimer" and mode == "startGame" then
      initGame = os.time() + 5000

      tfm.exec.chatMessage("<bv>skiptimer command enabled by admin "..name.."<n>", nil)
    elseif command == "stoptimer" and mode == "startGame" then
      local permanentAdmin = isPermanentAdmin(name)

      if not permanentAdmin then
        return
      end

      if not gameStats.stopTimer then
        gameStats.stopTimer = true

        tfm.exec.chatMessage("<bv>stoptimer command enabled by admin "..name.."<n>", nil)

        return
      end

      initGame = os.time() + (gameStats.initTimer * 1000)
      gameStats.stopTimer = false
      tfm.exec.chatMessage("<bv>stoptimer command disabled by admin "..name.."<n>", nil)
    elseif command:sub(1, 13) == "setmaxplayers" then
      if #command <= 14 then
        return
      end
      local maxNumberPlayers = math.abs(math.floor(tonumber(command:sub(15))))
      if type(maxNumberPlayers) ~= "number" then
        return
      end

      if maxNumberPlayers >= 6 and maxNumberPlayers <= 20 then
        tfm.exec.setRoomMaxPlayers(maxNumberPlayers)
        tfm.exec.chatMessage("<bv>"..playerLanguage[name].tr.messageSetMaxPlayers.." "..command:sub(15).." by admin "..name.."<n>", nil)
      else
        tfm.exec.chatMessage(playerLanguage[name].tr.messageMaxPlayersAlert, name)
      end
    elseif command:sub(1, 6) == "setmap" and mode == "startGame" then
      if gameStats.teamsMode then
        commandNotAvailable(command:sub(1, 6), name)
        return
      end

      if command:sub(8) == "small" or command:sub(8) == "large" or command:sub(8) == "extra-large" then
        if command:sub(8) == "small" or command:sub(8) == "large" then
          resetMapsToTest()
        end

        gameStats.setMapName = command:sub(8)
        tfm.exec.chatMessage("<bv>"..gameStats.setMapName.." map selected by admin "..name.."<n>", nil)
      else
        tfm.exec.chatMessage("<bv>Invalid map to select, valid options: small or large<n>", name)
      end
    elseif command:sub(1, 8) == "winscore" and mode == "gameStart" then
      if gameStats.teamsMode then
        commandNotAvailable(command:sub(1, 8), name)
        return
      end
      if #command <= 9 then
        return
      end

      if type(tonumber(command:sub(10))) ~= "number" then
        tfm.exec.chatMessage('<bv>Second parameter invalid, must be a number<n>', name)
        return
      end

      local winscoreNumber = math.abs(math.floor(tonumber(command:sub(10))))
      if type(winscoreNumber) ~= "number" then
        tfm.exec.chatMessage('<bv>Second parameter invalid, must be a number<n>', name)
        return
      end

      if winscoreNumber > score_red and winscoreNumber > score_blue and winscoreNumber > 0 then
        gameStats.winscore = math.abs(winscoreNumber)
        tfm.exec.chatMessage("<bv>Winscore changed to "..command:sub(10).."<n>", nil)
      end
    elseif command:sub(1,2) == "pw" then
      tfm.exec.setRoomPassword(command:sub(4))
      if command:sub(4) ~= "" then
        tfm.exec.chatMessage("<bv>"..playerLanguage[name].tr.newPassword.." "..command:sub(4).." by admin "..name.."<n>", nil)
      else
        tfm.exec.chatMessage(playerLanguage[name].tr.passwordRemoved, name)
      end
    elseif command:sub(1, 9) == "randommap" and mode == "startGame" and customMapCommand[name] then
      if gameStats.realMode then
        tfm.exec.chatMessage("<bv>The command !randomMap is not available on Volley Real Mode<n>", name)
        return
      end

      local args = split(command)
      
      if args[2] ~= "true" and args[2] ~= "false" then
        tfm.exec.chatMessage('<bv>Second parameter invalid, must be true or false<n>', name)
        return
      end

      if args[2] == "false" then
        customMapCommand[name] = false

        customMapCommandDelay = addTimer(function(i)
          if i == 1 then
            customMapCommand[name] = true
          end
        end, 2500, 1, "customMapCommandDelay")

        gameStats.isCustomMap = false
        gameStats.customMapIndex = 0
        for name1, data in pairs(tfm.get.room.playerList) do
          if selectMapOpen[name1] then
            selectMapUI(name1)
          end
        end

        print("<bv>Random map has been disabled by the admin "..name.."<n>", nil)
        tfm.exec.chatMessage("<bv>Random map has been disabled by the admin "..name.."<n>", nil)
      end

      if args[2] == "true" then
        local indexMap = ''
        gameStats.isCustomMap = true
        tfm.exec.chatMessage("<bv>Random map has been enabled by the admin "..name.."<n>", nil)

        for name1, data in pairs(tfm.get.room.playerList) do
          if selectMapOpen[name1] then
            selectMapUI(name1)
          end
        end
                
        if gameStats.twoTeamsMode or gameStats.teamsMode then
          indexMap = math.random(1, #customMapsFourTeamsMode)
          gameStats.customMapIndex = indexMap
          tfm.exec.chatMessage('<bv>'..customMapsFourTeamsMode[gameStats.customMapIndex][3]..' map (created by '..customMapsFourTeamsMode[gameStats.customMapIndex][4]..') selected by admin '..name..'<n>', nil)
          print('<bv>'..customMapsFourTeamsMode[gameStats.customMapIndex][3]..' map (created by '..customMapsFourTeamsMode[gameStats.customMapIndex][4]..') selected randomly<n>')
          return
        end

        indexMap = math.random(1, #customMaps)
        gameStats.customMapIndex = indexMap
        print('<bv>'..customMaps[gameStats.customMapIndex][3]..' map (created by '..customMaps[gameStats.customMapIndex][4]..') selected randomly<n>', nil)
        tfm.exec.chatMessage('<bv>'..customMaps[gameStats.customMapIndex][3]..' map (created by '..customMaps[gameStats.customMapIndex][4]..') selected randomly<n>', nil)
        return
      end
  
      gameStats.isCustomMap = false
      gameStats.customMapIndex = 0
      
      for name1, data in pairs(tfm.get.room.playerList) do
        if selectMapOpen[name1] then
          selectMapUI(name1)
        end
      end

    elseif command:sub(1, 9) == "custommap" and mode == "startGame" and customMapCommand[name] then
      if gameStats.realMode then
        tfm.exec.chatMessage("<bv>The command !customMap is not available on Volley Real Mode<n>", name)
        return
      end
      local args = split(command)
      local indexMap = ""
      if #args >= 3 then
        if type(tonumber(args[3])) ~= "number" then
          tfm.exec.chatMessage('<bv>Third parameter invalid, must be a number<n>', name)
          return
        end
        indexMap = math.abs(math.floor(tonumber(args[3])))
      end

      if args[2] ~= "true" and args[2] ~= "false" then
        tfm.exec.chatMessage('<bv>Second parameter invalid, must be true or false<n>', name)
        return
      end

      if args[2] == "false" then
        customMapCommand[name] = false

        customMapCommandDelay = addTimer(function(i)
          if i == 1 then
            customMapCommand[name] = true
          end
        end, 2500, 1, "customMapCommandDelay")

        gameStats.isCustomMap = false
        gameStats.customMapIndex = 0
        for name1, data in pairs(tfm.get.room.playerList) do
          if selectMapOpen[name1] then
            selectMapUI(name1)
          end
        end

        return
      end

      if type(indexMap) ~= "number" then
        tfm.exec.chatMessage('<bv>Third parameter invalid, must be a number<n>', name)
        return
      end

      if gameStats.twoTeamsMode or gameStats.teamsMode then
        if indexMap < 1 or indexMap > #customMapsFourTeamsMode then
          tfm.exec.chatMessage('<bv>Third parameter invalid, the map index must be higher than 1 and less than '..tostring(#customMapsFourTeamsMode)..'<n>', name)
          return
        end
      end

      if gameStats.threeTeamsMode then
        if indexMap < 1 or indexMap > #customMapsThreeTeamsMode then
          tfm.exec.chatMessage('<bv>Third parameter invalid, the map index must be higher than 1 and less than '..tostring(#customMapsThreeTeamsMode)..'<n>', name)
          return
        end
      end

      if not gameStats.twoTeamsMode and not gameStats.teamsMode then
        if indexMap < 1 or indexMap > #customMaps then
          tfm.exec.chatMessage('<bv>Third parameter invalid, the map index must be higher than 1 and less than '..tostring(#customMaps)..'<n>', name)
          return
        end
      end

      customMapCommand[name] = false

      customMapCommandDelay = addTimer(function(i)
        if i == 1 then
          customMapCommand[name] = true
        end
      end, 2000, 1, "customMapCommandDelay")

      if args[2] == "true" then
        gameStats.isCustomMap = true
        gameStats.customMapIndex = indexMap
        for name1, data in pairs(tfm.get.room.playerList) do
          if selectMapOpen[name1] then
            selectMapUI(name1)
          end
        end
        if gameStats.twoTeamsMode then
          tfm.exec.chatMessage('<bv>'..customMapsFourTeamsMode[gameStats.customMapIndex][3]..' map (created by '..customMapsFourTeamsMode[gameStats.customMapIndex][4]..') selected by admin '..name..'<n>', nil)
          print('<bv>'..customMapsFourTeamsMode[gameStats.customMapIndex][3]..' map (created by '..customMapsFourTeamsMode[gameStats.customMapIndex][4]..') selected by admin '..name..'<n>')
          return
        end

        if gameStats.threeTeamsMode then
          tfm.exec.chatMessage('<bv>'..customMapsThreeTeamsMode[gameStats.customMapIndex][3]..' map (created by '..customMapsThreeTeamsMode[gameStats.customMapIndex][4]..') selected by admin '..name..'<n>', nil)
          print('<bv>'..customMapsThreeTeamsMode[gameStats.customMapIndex][3]..' map (created by '..customMapsThreeTeamsMode[gameStats.customMapIndex][4]..') selected by admin '..name..'<n>')
          return
        end

        if gameStats.teamsMode then
          tfm.exec.chatMessage('<bv>'..customMapsFourTeamsMode[gameStats.customMapIndex][3]..' map (created by '..customMapsFourTeamsMode[gameStats.customMapIndex][4]..') selected by admin '..name..'<n>', nil)
          print('<bv>'..customMapsFourTeamsMode[gameStats.customMapIndex][3]..' map (created by '..customMapsFourTeamsMode[gameStats.customMapIndex][4]..') selected by admin '..name..'<n>')
          return
        end

        print('<bv>'..customMaps[gameStats.customMapIndex][3]..' map (created by '..customMaps[gameStats.customMapIndex][4]..') selected by admin '..name..'<n>', nil)
        tfm.exec.chatMessage('<bv>'..customMaps[gameStats.customMapIndex][3]..' map (created by '..customMaps[gameStats.customMapIndex][4]..') selected by admin '..name..'<n>', nil)
        return
      end

      gameStats.isCustomMap = false
      gameStats.customMapIndex = 0
      for name1, data in pairs(tfm.get.room.playerList) do
        if selectMapOpen[name1] then
          selectMapUI(name1)
        end
      end
    elseif command == "ballcoords" and name == "Refletz#6472" then
      print('X: '..tfm.get.room.objectList[ball_id].x..'')
      print('Y: '..tfm.get.room.objectList[ball_id].y..'')
    elseif command:sub(1, 8) == "setscore" and mode ~= "startGame" then
      local args = split(command)
      local isPlayerInTheRoom = false
      local scoreNumber = nil

      if #args >= 3 then
        if type(tonumber(args[3])) ~= "number" then
          tfm.exec.chatMessage("<bv>Third parameter invalid, must be a number<n>", name)

          return
        end

        scoreNumber = math.abs(math.floor(tonumber(args[3])))
      end

      if type(args[2]) ~= "string" then
        tfm.exec.chatMessage('<bv>Second parameter invalid, must be a name player in the room or the value can be: red or blue<n>', name)
        return
      end

      if args[2] == "red" or args[2] == "blue" then
        if gameStats.teamsMode then
          commandNotAvailable(command:sub(1, 8), name)
          return
        end

        if type(scoreNumber) ~= "number" then
          tfm.exec.chatMessage("<bv>Third parameter invalid, must be a number and the number must be less than the actual winscore "..gameStats.winscore.."<n>", name)
          return
        end

        if scoreNumber >= gameStats.winscore then
          tfm.exec.chatMessage("<bv>Third parameter invalid, must be a number and the number must be less than the actual winscore "..gameStats.winscore.."<n>", name)
          return
        end

        if args[2] == "red" then
          score_red = scoreNumber
          tfm.exec.chatMessage("<r>Red score changed to "..score_red.." by admin "..name.."<n>", nil)
        end

        if args[2] == "blue" then
          score_blue = scoreNumber
          tfm.exec.chatMessage("<bv>Blue score changed to "..score_blue.." by admin "..name.."<n>", nil)
        end

        showTheScore()

        return
      end

      for name, data in pairs(tfm.get.room.playerList) do
        if string.lower(name) == args[2] then
          isPlayerInTheRoom = true
        end
      end

      if not isPlayerInTheRoom then
        tfm.exec.chatMessage('<bv>Second parameter invalid, must be a name player in the room<n>', name)
        return
      end

      if type(scoreNumber) == "number" then
        tfm.exec.setPlayerScore(args[2], scoreNumber, false)
        tfm.exec.chatMessage("<bv>the "..args[2].."'s score was changed to "..args[3].."<n>", name)
      else
        tfm.exec.setPlayerScore(args[2], 1, true)
        tfm.exec.chatMessage("<bv>added +1 to "..args[2].."'s score<n>", name)
      end
    elseif command:sub(1, 10) == "4teamsmode" and mode == "startGame" then
      if gameStats.twoTeamsMode then
        tfm.exec.chatMessage("<bv>You should disable the 2 teams mode first to enable the 4 teams mode<n>", nil)
        return
      end
      if gameStats.threeTeamsMode then
        tfm.exec.chatMessage("<bv>You should disable the 3 teams mode first to enable the 4 teams mode<n>", nil)
        return
      end
      if gameStats.realMode then
        tfm.exec.chatMessage("<bv>You should disable the real mode first to enable the 4 teams mode<n>", nil)
        return
      end
      local args = split(command)
      if args[2] ~= "true" and args[2] ~= "false" then
        tfm.exec.chatMessage('<bv>Second parameter invalid, must be true or false<n>', name)
        return
      end

      gameStats.canJoin = false
      gameStats.isCustomMap = false
      gameStats.customMapIndex = 0
      getTeamsColorsName = {0xF59E0B, 0xEF4444, 0x3B82F6, 0x109267}
      teamsLifes = { [1] = {yellow = 3}, [2] = {red = 3}, [3] = {blue = 3}, [4] = {green = 3} }

      if args[2] == "true" then
        if gameStats.teamsMode then
          return
        end
        resetMapsToTest()
        gameStats.teamsMode = true
        resetMapsList()
        updateLobbyTextAreas()
        tfm.exec.chatMessage("<bv>4-team volley mode activated by admin "..name.."<n>", nil)
        return
      end

      if not gameStats.teamsMode then
        return
      end
      resetMapsToTest()

      gameStats.teamsMode = false
      resetMapsList()
      tfm.exec.chatMessage("<bv>4-team volley mode disabled by admin "..name.."<n>", nil)
      updateLobbyTextAreas()
    elseif command:sub(1, 10) == "3teamsmode" and mode == "startGame" then
      if gameStats.teamsMode then
        tfm.exec.chatMessage("<bv>You should disable the 4 teams mode first to enable the 3 teams mode<n>", nil)
        return
      end
      if gameStats.twoTeamsMode then
        tfm.exec.chatMessage("<bv>You should disable the 2 teams mode first to enable the 3 teams mode<n>", nil)
        return
      end
      if gameStats.realMode then
        tfm.exec.chatMessage("<bv>You should disable the real mode first to enable the 3 teams mode<n>", nil)
        return
      end
      local args = split(command)
      if args[2] ~= "true" and args[2] ~= "false" then
        tfm.exec.chatMessage('<bv>Second parameter invalid, must be true or false<n>', name)
        return
      end

      gameStats.canJoin = false
      gameStats.isCustomMap = false
      gameStats.customMapIndex = 0
      getTeamsColorsName = {0xEF4444, 0x3B82F6, 0x109267}
      teamsLifes = { [1] = {yellow = 5}, [2] = {red = 5}, [3] = {blue = 5}, [4] = {green = 5} }

      if args[2] == "true" then
        if gameStats.threeTeamsMode then
          return
        end
        resetMapsToTest()
        gameStats.threeTeamsMode = true
        resetMapsList()
        tfm.exec.chatMessage("<bv>3-team volley mode activated by admin "..name.."<n>", nil)
        updateLobbyTextAreas()
        return
      end

      if not gameStats.threeTeamsMode then
        return
      end
      resetMapsToTest()

      gameStats.threeTeamsMode = false
      gameStats.threeBalls = false
      resetMapsList()
      tfm.exec.chatMessage("<bv>3-team volley mode disabled by admin "..name.."<n>", nil)
      updateLobbyTextAreas()
    elseif command:sub(1, 8) == "realmode" and mode == "startGame" then
      if gameStats.twoTeamsMode then
        tfm.exec.chatMessage("<bv>You should disable the real mode first to enable the 4 teams mode<n>", nil)
        return
      end

      if gameStats.threeTeamsMode then
        tfm.exec.chatMessage("<bv>You should disable the 3 teams mode first to enable the real mode<n>", nil)
        return
      end

      if gameStats.teamsMode then
        tfm.exec.chatMessage("<bv>You should disable the realmode mode first to enable the real mode<n>", nil)
        return
      end

      local args = split(command)
      if args[2] ~= "true" and args[2] ~= "false" then
        tfm.exec.chatMessage('<bv>Second parameter invalid, must be true or false<n>', name)
        return
      end

      gameStats.isCustomMap = false
      gameStats.customMapIndex = 0

      if args[2] == "true" then
        gameStats.realMode = true
        resetMapsToTest()
        resetMapsList()
        tfm.exec.chatMessage("<bv>real volley mode activated by admin "..name.."<n>", nil)
        return
      end

      gameStats.realMode = false
      resetMapsList()
      resetMapsToTest()
      tfm.exec.chatMessage("<bv>real volley mode disabled by admin "..name.."<n>", nil)
    elseif command:sub(1, 5) == "admin" then
      local args = split(command)

      for name1, data in pairs(tfm.get.room.playerList) do
        if string.lower(name1) == args[2] then
          if admins[name1] then
            return
          end

          admins[name1] = true
          tfm.exec.chatMessage("<bv>Admin selected for "..name1.." command used by "..name.."<n>", nil)

          if mode == "startGame" then
            ui.addWindow(31, "<p align='center'><font size='13px'><a href='event:settings'>Room settings", name, 350, 370, 150, 30, 1, false, false, _)

            if selectMapOpen[name1] then
              selectMapUI(name1)
            end
          end
        end
      end
    elseif command:sub(1, 7) == "unadmin" then
      local args = split(command)
      local permanentAdmin = isPermanentAdmin(name)

      if args[2] == "all" and permanentAdmin then
        admins = {}
        for i = 1, #permanentAdmins do
          admins[permanentAdmins[i]] = true
        end
        tfm.exec.chatMessage("<bv>Admin list reseted by admin "..name.."<n>", nil)
        return
      end

      for i = 1, #permanentAdmins do
        local admin = string.lower(permanentAdmins[i])
        if args[2] == admin then
          return
        end
      end

      for name1, data in pairs(playerLanguage) do
        if string.lower(name1) == args[2] then
          if not admins[name1] then
            return
          end

          if name1 == getRoomAdmin and permanentAdmin then
            admins[name1] = false
            tfm.exec.chatMessage("<bv>Admin removed for "..name1.." command used by "..name.."<n>", nil)
          end
          admins[name1] = false
          tfm.exec.chatMessage("<bv>Admin removed for "..name1.." command used by "..name.."<n>", nil)

          if mode == "startGame" then
            closeWindow(31, name1)

            if selectMapOpen[name1] then
              selectMapUI(name1)
            end
          end
        end
      end
    elseif command:sub(1, 6) == "padmin" then
      local permanentAdmin = isPermanentAdmin(name)

      local args = split(command)

      if permanentAdmin then
        return
      end

      for i = 1, #inactivePermanentAdmins do
        if name == inactivePermanentAdmins[i] then
          permanentAdmins[#permanentAdmins + 1] = name
        end
      end
    elseif command:sub(1, 4) == "kick" then
      local args = split(command)
      local permanentAdmin = isPermanentAdmin(name)

      if not permanentAdmin then
        return
      end

      for i = 1, #permanentAdmins do
        local admin = string.lower(permanentAdmins[i])
        if args[2] == admin then
          return
        end
      end

      for name1, data in pairs(tfm.get.room.playerList) do
        if string.lower(name1) == args[2] then
          tfm.exec.kickPlayer(name1)
          tfm.exec.chatMessage("<bv>You have been kicked from the room by the admin "..name.."<n>", name1)
          tfm.exec.chatMessage("<bv>"..name.." kicked the player "..name1.." from the room<n>", nil)
          print("<bv>"..name.." kicked the player "..name1.." from the room<n>")
        end
      end
    elseif command:sub(1, 6) == "fleave" and mode == "gameStart" then
      local args = split(command)
      local permanentAdmin = isPermanentAdmin(name)

      if not permanentAdmin then
        return
      end

      for i = 1, #permanentAdmins do
        local admin = string.lower(permanentAdmins[i])
        if args[2] == admin then
          return
        end
      end

      for name1, data in pairs(tfm.get.room.playerList) do
        if string.lower(name1) == args[2] then
          if gameStats.teamsMode or gameStats.threeTeamsMode then
            if gameStats.canTransform then
                leaveTeamTeamsMode(name1)
                tfm.exec.chatMessage("<bv>Force leave used on "..name1.." command used by "..name.."<n>", nil)
                return
            end
          else
            if not gameStats.teamsMode then
              leaveTeam(name1)
              tfm.exec.chatMessage("<bv>Force leave used on "..name1.." command used by "..name.."<n>", nil)
              return
            end
            tfm.exec.chatMessage("<bv>The force leave command is disabled now, please try the same command in few seconds<n>", name)
            return
          end
        end
      end
    elseif command:sub(1, 3) == "ban" and gameStats.banCommandIsEnabled then
      local args = split(command)
      local permanentAdmin = isPermanentAdmin(name)

      if not permanentAdmin then
        return
      end

      for i = 1, #permanentAdmins do
        local admin = string.lower(permanentAdmins[i])
        if args[2] == admin then
          return
        end
      end

      for name1, data in pairs(tfm.get.room.playerList) do
        if args[2] == string.lower(name1) then
          if args[2] == string.lower(getRoomAdmin) and not permanentAdmin then
            return
          end
          playerBan[name1] = true
          tfm.exec.chatMessage("<bv>You have been banned from the room by the admin "..name.."<n>", name1)
          tfm.exec.chatMessage("<bv>"..name.." banned the player "..name1.." from the room<n>", nil)
          print("<bv>"..name.." banned the player "..name1.." from the room<n>")
          tfm.exec.kickPlayer(name1)
          playerBanHistory[name1] = name
          if mode == "startGame" then
            updateLobbyTexts(name1)
          elseif mode == "gameStart" then
            if gameStats.teamsMode and gameStats.canTransform then
              leaveTeamTeamsMode(name1)
              return
            else
              if not gameStats.teamsMode then
                leaveTeam(name1)
                return
              end
              tfm.exec.chatMessage("<bv>The force leave command is disabled now, please try the same command in few seconds<n>", name)
              return
            end
          end
        end
      end
    elseif command:sub(1, 5) == "unban" and gameStats.banCommandIsEnabled then
      local args = split(command)
      local permanentAdmin = isPermanentAdmin(name)

      if not permanentAdmin then
        return
      end

      for name1, data in pairs(playerLanguage) do
        if args[2] == string.lower(name1) then
          if args[2] == string.lower(getRoomAdmin) and not permanentAdmin then
            return
          end

          if not playerBan[name1] then
            return
          end

          playerBan[name1] = false
          tfm.exec.chatMessage("<bv>"..name.." unbanned the player "..name1.." from the room<n>", nil)
          print("<bv>"..name.." unbanned the player "..name1.." from the room<n>")
        end
      end
    elseif command:sub(1,10) == "randomball" and mode == "startGame" then
      local args = split(command)

      if args[2] ~= "true" and args[2] ~= "false" then
        tfm.exec.chatMessage('<bv>Second parameter invalid, must be true or false<n>', name)
        return
      end
      
      if args[2] ~= "true" and args[2] ~= "false" then
        tfm.exec.chatMessage('<bv>Second parameter invalid, must be true or false<n>', name)
        return
      end

      if args[2] == "true" then        
        print("<bv>Random ball has been enabled by the admin "..name.."<n>", nil)
        tfm.exec.chatMessage("<bv>Random ball has been enabled by the admin "..name.."<n>", nil)
        
        gameStats.customBall = true
        local indexBall= math.random(1, #balls)
        gameStats.customBallId = indexBall
        print("<bv>"..balls[gameStats.customBallId].name.." selected randomly<n>", nil)
        tfm.exec.chatMessage("<bv>"..balls[gameStats.customBallId].name.." selected randomly<n>", nil)
        return
      end

      gameStats.customBall = false
      print("<bv>Random ball has been disabled by the admin "..name.."<n>", nil)
      tfm.exec.chatMessage("<bv>Random ball has been disabled by the admin "..name.."<n>", nil)

    elseif command:sub(1, 10) == "customball" and mode == "startGame" then
      local args = split(command)

      if type(tonumber(args[2])) ~= "number" then
        tfm.exec.chatMessage('<bv>Second parameter invalid, must be a number<n>', name)
        return
      end
      local indexBall = math.abs(math.floor(tonumber(args[2])))

      if type(indexBall) ~= "number" then
        tfm.exec.chatMessage('<bv>Second parameter invalid, must be a number<n>', name)
        return
      elseif indexBall < 1 or indexBall > #balls then
        tfm.exec.chatMessage('<bv>Second parameter invalid, the ball index must be higher than 1 and less than '..tostring(#balls)..'<n>', name)
        return
      end

      gameStats.customBall = true
      gameStats.customBallId = indexBall

      tfm.exec.chatMessage("<bv>"..balls[gameStats.customBallId].name.." selected by admin "..name.."<n>", nil)
    elseif command:sub(1, 6) == "lobby" and mode == "gameStart" then
      ballOnGame = false
      ballOnGame2 = false
      ballOnGame3 = false
      ballOnGameTwoBalls = {ballOnGame, ballOnGame2, ballOnGame3}
      tfm.exec.removeObject(ball_id)
      mode = "endGame"
      gameTimeEnd = os.time() + 5000

      if gameStats.teamsMode then
        updateRankingFourTeamsMode()
      elseif gameStats.threeTeamsMode then
        updateRankingThreeTeamsMode()
      elseif gameStats.twoTeamsMode then
        updateRankingTwoTeamsMode()
      elseif gameStats.realMode then
        updateRankingRealMode()
      else
        updateRankingNormalMode()
      end

      tfm.exec.chatMessage("<bv>The command to reset lobby was actived by admin "..name..", the match will restart in 5 seconds<n>", nil)
    elseif command:sub(1, 8) == "killspec" then

      local findAdminPermanent = false

      for i = 1, #permanentAdmins do
        local admin = permanentAdmins[i]
        if name == admin then
          findAdminPermanent = true
        end
      end

      if findAdminPermanent then
        if mode == "startGame" then
          local boolean = command:sub(10)
          if boolean ~= "true" and boolean ~= "false" then
            tfm.exec.chatMessage('<bv>Second parameter invalid, must be true or false<n>', name)
            return
          end

          if boolean == "true" then
            killSpecPermanent = true
            return
          end

          killSpecPermanent = false

          return

        elseif mode == "gameStart" then
          local boolean = command:sub(10)
          if boolean ~= "true" and boolean ~= "false" then
            tfm.exec.chatMessage('<bv>Second parameter invalid, must be true or false<n>', name)
            return
          end

          if boolean == "true" then
            killSpecPermanent = true
            gameStats.killSpec = true
            for name1, data in pairs(tfm.get.room.playerList) do
              if playerInGame[name1] == false then
                tfm.exec.killPlayer(name1)
              end
            end
            return
          end

          killSpecPermanent = false
          gameStats.killSpec = false
        end
      end
    elseif command == "pause" and mode == "gameStart" then

      if gameStats.realMode then
        tfm.exec.chatMessage("<bv>The command !pause isn't available on Volley Real Mode<n>", name)

        return
      end

      local findAdminPermanent = false

      for i = 1, #permanentAdmins do
        local admin = permanentAdmins[i]
        if name == admin then
          findAdminPermanent = true
        end
      end

       if findAdminPermanent then
        if not gameStats.isGamePaused then
          gameStats.isGamePaused = true
          ballOnGame = false
          ballOnGame2 = false
          ballOnGame3 = false
          ballOnGameTwoBalls = {ballOnGame, ballOnGame2, ballOnGame3}

          tfm.exec.removeObject(ball_id)
          tfm.exec.removeObject(ball_id2)
          tfm.exec.removeObject(ball_id3)
          tfm.exec.chatMessage("<bv>Command !pause used by admin "..name.."<n>", nil)

          local timer = math.ceil((duration - os.time())/1000)

          durationTimerPause = timer
          return
        else
          duration = os.time() + durationTimerPause * 1000

          tfm.exec.setGameTime(durationTimerPause, true)

          gameStats.isGamePaused = false
          spawnInitialBall()
        end
      end
    elseif command:sub(1, 4) == "sync" then
      if #command == 4 then
        local lowestSync = 10000
        local newPlayerSync = ""
        for name, data in pairs(tfm.get.room.playerList) do
          local playerSync = tfm.get.room.playerList[name].averageLatency
          if playerSync < lowestSync then
            newPlayerSync = name
            lowestSync = playerSync
          end
        end

        tfm.exec.setPlayerSync(newPlayerSync)
        tfm.exec.chatMessage("<bv>Set new player sync: "..newPlayerSync.." selected by admin "..name.."<n>", nil)
      else
        local permanentAdmin = isPermanentAdmin(name)

        if not permanentAdmin then
          return
        end

        local playerName = command:sub(6)
        local playerOnRoom = false
        local playerSync = 0
        for name1, data in pairs(tfm.get.room.playerList) do
          if string.lower(name1) == playerName then
            playerOnRoom = true
            playerName = name1
            playerSync = tfm.get.room.playerList[name1].averageLatency
          end
        end

        if playerOnRoom then
          tfm.exec.setPlayerSync(playerName)
          tfm.exec.chatMessage("<bv>Set new player sync: "..playerName.." selected by admin "..name.."<n>", nil)
        end

      end

    elseif command == "setsync" then
      windowUISync(name)
    elseif command == "synctfm" then
      tfm.exec.setPlayerSync(nil)

      local playerSync = tfm.exec.getPlayerSync()
      local syncLatency = tfm.get.room.playerList[playerSync].averageLatency

      tfm.exec.chatMessage("<bv>Set new player sync: "..playerSync.."<n>", nil)
    elseif command == "listsync" then
      local permanentAdmin = isPermanentAdmin(name)
      local playersSync = {}

      if not permanentAdmin then
        return
      end

      local str = "Sync list: <br><br>"

      for name1, data in pairs(tfm.get.room.playerList) do
        local syncCondition = textSyncCondition(tfm.get.room.playerList[name1].averageLatency)
        playersSync[#playersSync + 1] = { name = name1, sync = tfm.get.room.playerList[name1].averageLatency, syncCondition = syncCondition }
      end

      table.sort(playersSync, function(a, b) return a.sync < b.sync end)

      for i = 1, #playersSync do
        str = ""..str..""..playersSync[i].name.." - "..playersSync[i].syncCondition.."<br>"
      end

      ui.addPopup(0, 0, str, name, 300, 50, 300, true)
    elseif command:sub(1, 14) == "setplayerforce" and mode == "startGame" then
      local numberForce = tonumber(command:sub(16))
      if type(numberForce) ~= "number" then
        tfm.exec.chatMessage('<bv>Second parameter invalid, must be a number<n>', name)
        return
      elseif numberForce < 0 or numberForce > 1.05 then
        tfm.exec.chatMessage('<bv>The number to set the force is low or high than allowed, the value must be between (0 the minimum and 1.05 the maximum)<n>', name)
        return
      end

      gameStats.psyhicObjectForce = numberForce

      tfm.exec.chatMessage("<bv>The strength of the player's object has been changed to "..tostring(gameStats.psyhicObjectForce).."<n>", name)
      print("<bv>The strength of the player's object has been changed to "..tostring(gameStats.psyhicObjectForce).."<n>")
    elseif command == "test" and tfm.get.room.isTribeHouse and mode == "startGame" then
      if gameStats.threeTeamsMode then
        playersRed[1].name = "a"
        playersBlue[1].name = "a"
        playersGreen[1].name = "a"
      else
        playersRed[1].name = "a"
        playersRed[2].name = "a"
        playersBlue[1].name = "a"
        playersBlue[2].name = "a"
        playersGreen[1].name = "a"
        playersYellow[1].name = "a"
      end
      
      eventNewGameShowLobbyTexts()
    elseif command:sub(1, 10) == "2teamsmode" and mode == "startGame" then
      if gameStats.teamsMode then
        tfm.exec.chatMessage("<bv>You should disable the 4 teams mode first to enable the 2 teams mode<n>", nil)
        return
      end
      if gameStats.threeTeamsMode then
        tfm.exec.chatMessage("<bv>You should disable the 3 teams mode first to enable the 2 teams mode<n>", nil)
        return
      end
      if gameStats.realMode then
        tfm.exec.chatMessage("<bv>You should disable the real mode first to enable the 2 teams mode<n>", nil)
        return
      end
      local args = split(command)
      if args[2] ~= "true" and args[2] ~= "false" then
        tfm.exec.chatMessage('<bv>Second parameter invalid, must be true or false<n>', name)
        return
      end

      gameStats.isCustomMap = false
      gameStats.customMapIndex = 0

      if args[2] == "true" then
        if gameStats.twoTeamsMode then
          return
        end
        resetMapsToTest()
        gameStats.twoTeamsMode = true
        resetMapsList()
        tfm.exec.chatMessage("<bv>2-team volley mode activated by admin "..name.."<n>", nil)
        return
      end

      if not gameStats.twoTeamsMode then
        return
      end

      resetMapsToTest()
      resetMapsList()
      gameStats.twoTeamsMode = false
      resetMapsList()
      tfm.exec.chatMessage("<bv>2-team volley mode disabled by admin "..name.."<n>", nil)
    elseif command:sub(1, 8) == "twoballs" and mode == "startGame" then
      local args = split(command)
      print(args[2])
      if gameStats.realMode then
        tfm.exec.chatMessage("<bv>The command two balls isn't available for Volley Real Mode<n>", name)

        return
      end
      if args[2] ~= "true" and args[2] ~= "false" then
        tfm.exec.chatMessage('<bv>Second parameter invalid, must be true or false<n>', name)
        return
      end
      if args[2] == "true" then
        gameStats.twoBalls = true
        tfm.exec.chatMessage("<bv>Two balls has been enabled by the admin "..name.."<n>", nil)
        return
      end

      gameStats.twoBalls = false
      tfm.exec.chatMessage("<bv>Two balls has been disabled by the admin "..name.."<n>", nil)
    elseif command:sub(1, 10) == "threeballs" and mode == "startGame" then
      local args = split(command)
      print(args[2])
      if not gameStats.threeTeamsMode then
        tfm.exec.chatMessage("<bv>This command is only available for the 3-team mode.<n>", name)

        return
      end
      if args[2] ~= "true" and args[2] ~= "false" then
        tfm.exec.chatMessage('<bv>Second parameter invalid, must be true or false<n>', name)
        return
      end
      if args[2] == "true" then
        print('ativou')
        gameStats.threeBalls = true
        tfm.exec.chatMessage("<bv>Two balls has been enabled by the admin "..name.."<n>", nil)
        return
      end

      gameStats.threeBalls = false
      tfm.exec.chatMessage("<bv>Two balls has been disabled by the admin "..name.."<n>", nil)
    elseif command:sub(1, 11) == "consumables" and mode == "startGame" then
      local args = split(command)

      if not gameStats.teamsMode and not gameStats.twoTeamsMode and not gameStats.realMode then
        tfm.exec.chatMessage("<bv>The command consumables only works on normal mode<n>", name)
      end

      if args[2] ~= "true" and args[2] ~= "false" then
        tfm.exec.chatMessage('<bv>Second parameter invalid, must be true or false<n>', name)
        return
      end

      if args[2] == "true" then
        gameStats.consumables = true
        tfm.exec.chatMessage("<bv>Consumables on normal mode has enabled by the admin "..name.."<n>", nil)
        return
      end

      gameStats.consumables = false
      tfm.exec.chatMessage("<bv>Consumables on normal mode has disabled by the admin "..name.."<n>", nil)
    elseif command == "settings" then 
      closeRankingUI(name)
      removeUITrophies(name)
      settings[name] = true
      
      updateSettingsUI(name)
    elseif command:sub(1, 2) == "np" and tfm.get.room.isTribeHouse and mode == "startGame" then
      local args = split(command)
      local regexMap = "^@%d%d%d%d%d%d%d$"

      if gameStats.realMode then
        tfm.exec.chatMessage("<bv>There aren't availables maps to test on volley real mode", name)
        return
      end

      if gameStats.setMapName == "extra-large" then
        tfm.exec.chatMessage("<bv>There aren't availables maps to test on extra-large map", name)
        return
      end

      if gameStats.threeTeamsMode then
        if type(args[2]) == "nil" then
          tfm.exec.chatMessage("<bv>Second parameter invalid, must be a tfm map like @3493212<n>", name)
          return
        end

        if string.match(args[2], regexMap) == nil then
          tfm.exec.chatMessage("<bv>Second parameter invalid, must be a tfm map like @3493212<n>", name)
          return
        end

        mapsToTest[1] = args[2]

        if type(args[3]) == "nil" then
          mapsToTest[2] = customMapsThreeTeamsMode[1][2]
          tfm.exec.chatMessage("<bv>Warning: in 4-team mode, the !np command should be !np @map @map @map, but if you only have one map ready and want to test it, the game will set the default map for the other maps<n>", name)
          print("<bv>Warning: in 4-team mode, the !np command should be !np @map @map @map, but if you only have one map ready and want to test it, the game will set the default map for the other maps<n>")
        else
          if string.match(args[3], regexMap) == nil then
            tfm.exec.chatMessage("<bv>Third parameter invalid, must be a tfm map like @3493212<n>", name)

            return
          else
            mapsToTest[2] = args[3]
          end
        end

        tfm.exec.chatMessage("<bv>Test map successfully selected<n>", nil)
        return
      end

      if gameStats.teamsMode then
        if type(args[2]) == "nil" then
          tfm.exec.chatMessage("<bv>Second parameter invalid, must be a tfm map like @3493212<n>", name)
          return
        end

        if string.match(args[2], regexMap) == nil then
          tfm.exec.chatMessage("<bv>Second parameter invalid, must be a tfm map like @3493212<n>", name)
          return
        end

        mapsToTest[1] = args[2]

        if type(args[3]) == "nil" then
          mapsToTest[2] = customMapsFourTeamsMode[34][2]
          tfm.exec.chatMessage("<bv>Warning: in 4-team mode, the !np command should be !np @map @map @map, but if you only have one map ready and want to test it, the game will set the default map for the other maps<n>", name)
          print("<bv>Warning: in 4-team mode, the !np command should be !np @map @map @map, but if you only have one map ready and want to test it, the game will set the default map for the other maps<n>")
        else
          if string.match(args[3], regexMap) == nil then
            tfm.exec.chatMessage("<bv>Third parameter invalid, must be a tfm map like @3493212<n>", name)

            return
          else
            mapsToTest[2] = args[3]
          end
        end

        if type(args[4]) == "nil" then
          mapsToTest[3] = customMapsFourTeamsMode[34][5]
          tfm.exec.chatMessage("<bv>Warning: in 4-team mode, the !np command should be !np @map @map @map, but if you only have one map ready and want to test it, the game will set the default map for the other maps<n>", name)
          print("<bv>Warning: in 4-team mode, the !np command should be !np @map @map @map, but if you only have one map ready and want to test it, the game will set the default map for the other maps<n>")
        else
          if string.match(args[4], regexMap) == nil then
            tfm.exec.chatMessage("<bv>Fourth parameter invalid, must be a tfm map like @3493212<n>", name)

            return
          else
            mapsToTest[3] = args[4]
          end
        end

        tfm.exec.chatMessage("<bv>Test map successfully selected<n>", nil)
        return
      end

      if type(args[2]) == "nil" then
        tfm.exec.chatMessage("<bv>Second parameter invalid, must be a tfm map like @3493212<n>", name)
        return
      end
      if string.match(args[2], regexMap) == nil then
        tfm.exec.chatMessage("<bv>Second parameter invalid, must be a tfm map like @3493212<n>", name)
        return
      end

      mapsToTest[1] = args[2]
      tfm.exec.chatMessage("<bv>Test map successfully selected<n>", nil)
    elseif command:sub(1,2) == "tp" and mode == gameStart then
      local permanentAdmin = isPermanentAdmin(name)
      if not permanentAdmin then
        return
      end

      local args = split(command)
      
      if #args >= 3 then
        local colorValues = {yellow = 200, blue = 400, red = 600, green = 1000}  
        if colorValues[args[2]] then
          args[2] = colorValues[args[2]]
        end

        if type(tonumber(args[2])) ~= "number" or type(tonumber(args[3])) ~= "number" then
          print('<bv>Second or third parameters invalid, must be numbers<n>', name)
          return
        end

        xTarget = math.abs(math.floor(tonumber(args[2])))
        yTarget = math.abs(math.floor(tonumber(args[3])))  
        tfm.exec.movePlayer(name, xTarget, yTarget)
      end
    end
  end
end


--[[ src/events/eventKeyboard.lua ]]--

function eventKeyboard(name, key, down, x, y, xv, yv)
  local OffsetX = 0
  local OffsetY = 0

  if xv < 0 then
    OffsetX = -15
  elseif xv > 0 then
    OffsetX = 15
  end
  if yv < 0 then
    OffsetY = -5
  elseif yv > 0 then
    OffsetY = 5
  end

  local coordinatesX = (x + xv) + OffsetX
  local coordinatesY = (y + yv) + OffsetY
  tfm.get.room.playerList[name].x = coordinatesX
  tfm.get.room.playerList[name].y = coordinatesY

  if key == 0 or key == 1 or key == 2 or key == 3 then
    playersAfk[name] = os.time()

    removePlayerTrophy(name)
  end

  if key == 80 then
    if isOpenProfile[name] then
      closeAllWindows(name)
      closeRankingUI(name)
      removeButtons(25, name)
      removeButtons(26, name)
      closeWindow(24, name)
      closeWindow(25, name)
      removeUITrophies(name)

      return
    end
    closeAllWindows(name)
    closeRankingUI(name)
    removeButtons(25, name)
    removeButtons(26, name)
    removeUITrophies(name)
    profileUI(name, name)
  end

  if key == 76 then
    if openRank[name] then
      openRank[name] = false
      closeAllWindows(name)
      
      ui.removeTextArea(99992, name)
      closeWindow(266, name)
      removeButtons(25, name)
      removeButtons(26, name)
      closeRankingUI(name)
    else
      openRank[name] = true
      ui.addWindow(24, "<p align='center'><font size='16px'>", name, 125, 60, 650, 300, 1, false, true, playerLanguage[name].tr.closeUIText)
      ui.addTextArea(9999543, "<p align='center'>Room Ranking", name, 17, 168, 100, 20, 0x142b2e, 0x8a583c, 1, true)
      ui.addTextArea(9999544, "<p align='center'><n2>Global Ranking<n>", name, 17, 268, 100, 18, 0x142b2e, 0x8a583c, 1, true)
      showMode(playerRankingMode[name], name)
    end
  end

  if playerInGame[name] and mode == "gameStart" then

    if key == 0 or key == 2 then
      playerLeftRight[name] = key
    end

    if gameStats.consumables then
      if not gameStats.teamsMode and not gameStats.twoTeamsMode and not gameStats.realMode then
        local keysEmote = {55, 56, 57, 48}
        local consumablesId = {65, 80, 6, 34}
        local consumablesNames = {"pufferfish", "paper plane", "ball", "snow ball"}

        for i = 1, #keysEmote do
          if keysEmote[i] == key then
            playerConsumableKey[name] = keysEmote[i]
            playerConsumableItem[name] = consumablesId[i]
            tfm.exec.chatMessage("<bv>You chose the consumable "..consumablesNames[i].."<n>", name)
            print("<bv>You chose the consumable "..consumablesNames[i].."<n>")
          end
        end

        if key == 77 then
          if not playerConsumable[name] then
            tfm.exec.chatMessage("<bv>You need wait 5 seconds to spawn a new consumable<n>", name)
            print("<bv>You need wait 5 seconds to spawn a new item<n>")

            return
          end
          local speed = setConsumablesForce(playerConsumableKey[name], playerLeftRight[name])
          playerConsumable[name] = false

          local enablePlayerConsumable = addTimer(function(i)
            if i == 1 then
              playerConsumable[name] = true
              tfm.exec.chatMessage("<bv>You can spawn a new consumable<n>", name)
              print("<bv>You can spawn a new consumable <n>")
            end
          end, 5000, 1, "enablePlayerConsumable")

          local id = tfm.exec.addShamanObject(playerConsumableItem[name], x + OffsetX + (OffsetX / 2), y + speed[3], 0, speed[1], speed[2], false)
          playerConsumables[#playerConsumables + 1] = id

          local removeShamanObject = addTimer(function(i)
            if i == 1 then
              tfm.exec.removeObject(playerConsumables[1])
              table.remove(playerConsumables, 1)
            end
          end, 15000, 1, "removeShamanObject")
        end
      end
    end

    if gameStats.realMode then
      if key == 49 then
        playerForce[name] = 0
        tfm.exec.chatMessage("<bv>Your strength changed to normal<n>", name)
      elseif key == 50 then
        playerForce[name] = -0.2
        tfm.exec.chatMessage("<bv>Your strength has been reduced by 20%<n>", name)
      elseif key == 51 then
        playerForce[name] = -0.45
        tfm.exec.chatMessage("<bv>Your strength has been reduced by 45%<n>", name)
      elseif key == 52 then
        playerForce[name] = -1
        tfm.exec.chatMessage("<bv>Your strength has been reduced by 100%<n>", name)
      end

      if x <= 599 or x >= 2001 then
        if not playerOutOfCourt[name] and not showOutOfCourtText[name] then
          showOutOfCourtText[name] = true
          tfm.exec.chatMessage("<bv>you are outside the court you have 7 seconds to make an action, otherwise you will not be able to use the space key outside the court<n>", name)
          print("<bv>you are outside the court you have 7 seconds to make an action, otherwise you will not be able to use the space key outside the court<n>")
        end
        delayToDoAnAction = addTimer(function(i)
          if i == 1 then
            playerOutOfCourt[name] = true
          end
        end, 7000, 1, "delay"..name.."")
      end

      if x > 599 and x < 2001 then
        removeTimer("delay"..name.."")
        showOutOfCourtText[name] = false
        playerOutOfCourt[name] = false
      end
      if gameStats.redServe and name ~= gameStats.redPlayerServe then
        return
      end

      if gameStats.blueServe and name ~= gameStats.bluePlayerServe then
        return
      end
    end
    if key == 32 and gameStats.canTransform and playerCanTransform[name] and not playerOutOfCourt[name] then
      local aditionalForce = 0

      if gameStats.realMode then
        local playerCanSpawn = verifyPlayerTeam(name)
        local searchPlayerTeam = searchPlayerTeam(name)

        if searchPlayerTeam == "red" and gameStats.redQuantitySpawn >= 0 then
          aditionalForce = 0 + playerForce[name]
        end

        if searchPlayerTeam == "blue" and gameStats.blueQuantitySpawn >= 0 then
          aditionalForce = 0 + playerForce[name]
        end

        if gameStats.redServe then
          gameStats.redServe = false
          aditionalForce = 0.34
        end

        if gameStats.blueServe then
          gameStats.blueServe = false
          aditionalForce = 0.34
        end

        if not playerCanSpawn then
          return
        end

        if gameStats.redQuantitySpawn == 3 then
          aditionalForce = 0.2 + playerForce[name]
        end

        if gameStats.blueQuantitySpawn == 3 then
          aditionalForce = 0.2 + playerForce[name]
        end

        if gameStats.reduceForce and searchPlayerTeam == gameStats.teamWithOutAce then
          gameStats.reduceForce = false
          aditionalForce = -0.45 + playerForce[name]
        end

        playerNearOfTheBall(name, x, y)
      end

      playerCanTransform[name] = false
      playerPhysicId[name] = countId
      tfm.exec.killPlayer (name)
      tfm.exec.addPhysicObject (playerPhysicId[name], coordinatesX, coordinatesY, {
        type = 13,
        width = 20,
        height = 20,
        restitution = gameStats.psyhicObjectForce + aditionalForce,
        friction = 0,
        color = 0x81348A,
        miceCollision = false,
        groundCollision = true
      })

      local groundId = playerPhysicId[name]

      removeGround = addTimer(function(i)
        if i == 1 then
          tfm.exec.removePhysicObject(groundId)
          tfm.exec.respawnPlayer(name)
          setCrownToPlayer(name)
          if playerInGame[name] then
            tfm.exec.movePlayer (name, x, y)
          end
          delayOnTransform = addTimer(function(i)
            if i == 1 then
              playerCanTransform[name] = true
            end
          end, 500, 1, "delayOnTransform")
        end
      end, 3000, 1, "removeGround"..name.."")
      countId = countId + 1
      for i = 1, #playersRed do
        if playersRed[i].name == name then
          tfm.exec.setNameColor(name, 0xEF4444)
          break
        end
      end
      for i = 1, #playersBlue do
        if playersBlue[i].name == name then
          tfm.exec.setNameColor(name, 0x3B82F6)
          break
        end
      end
    end
  end
end



--[[ src/events/eventLoop.lua ]]--

function eventLoop(elapsedTime, remainingTime)
  if gameStats.isGamePaused then
    tfm.exec.setGameTime(durationTimerPause, true)
  end

  if mode == "startGame" then
    local x = math.ceil((initGame - os.time())/1000)
    local c = string.format("%d", x)
    if not gameStats.stopTimer then
      gameStats.initTimer = x
      ui.addTextArea(7, "<p align='center'>"..c.."", nil, 375, 50, 30, 20, 0x161616, 0x161616, 1, false)
    end
    
    if x == 0 and not gameStats.stopTimer then
      local playersOnGame = quantityPlayers()

      if gameStats.realMode then
        if playersOnGame.red >= 2 and playersOnGame.blue >= 2 then
          rankCrown = rankRealMode
          rulesTimer = os.time() + 10000
          mode = "showRules"
          for name, data in pairs(tfm.get.room.playerList) do
            ui.addWindow(266, ""..playerLanguage[name].tr.realModeRules.."", name, 125, 60, 650, 300, 1, false, true, playerLanguage[name].tr.closeUIText)
          end
          removeWindowsOnBottom()

          return
        else
          initGame = os.time() + 25000
          return
        end
      end

      if gameStats.threeTeamsMode then
        if playersOnGame.red >= 1 and playersOnGame.blue >= 1 and playersOnGame.green >= 1 then
          gameStats.actualMode = "3 teams mode"
          rankCrown = rankThreeTeamsMode
          gameStats.redX = 599
          gameStats.blueX = 1199
          gameStats.greenX = 1201
          removeTextAreasOfLobby()
          removeWindowsOnBottom()

          mode = "gameStart"
          gameStats.typeMap = "large4v4"
          startGame()

          return
        else
          initGame = os.time() + 25000
          return
        end
      end

      if gameStats.teamsMode then
        if playersOnGame.red >= 1 and playersOnGame.blue >= 1 and playersOnGame.yellow >= 1 and playersOnGame.green >= 1 then
          gameStats.actualMode = "4 teams mode"
          rankCrown = rankFourTeamsMode
          removeTextAreasOfLobby()
          removeWindowsOnBottom()
          gameStats.yellowX = 399
          gameStats.redX = 799
          gameStats.blueX = 1199
          gameStats.greenX = 1201

          mode = "gameStart"
          gameStats.typeMap = "large4v4"
          startGame()

          return
        else
          initGame = os.time() + 25000
          return
        end
      end

      if gameStats.twoTeamsMode then
        if playersOnGame.red >= 2 and playersOnGame.blue >= 2 then
          rankCrown = rankTwoTeamsMode
          removeTextAreasOfLobby()
          removeWindowsOnBottom()
          gameStats.blueX = 399
          gameStats.redX = 799
          gameStats.blueX2 = 1199
          gameStats.redX2 = 1201

          mode = "gameStart"
          gameStats.typeMap = "large4v4"
          startGame()

          return
        else
          initGame = os.time() + 25000

          return
        end
      end

      if playersOnGame.red >= 1 and playersOnGame.blue >= 1 then
        removeTextAreasOfLobby()
        removeWindowsOnBottom()
        rankCrown = rankNormalMode
        if playersOnGame.red <= 3 or playersOnGame.blue <= 3 then
          gameStats.gameMode = "3v3"
          gameStats.redX = 399
          gameStats.blueX = 401
        end

        if playersOnGame.red >= 4 or playersOnGame.blue >= 4 then
          gameStats.gameMode = "4v4"
          gameStats.redX = 599
          gameStats.blueX = 601
        end
        mode = "gameStart"
        startGame()
      else
        initGame = os.time() + 25000
      end
    end
  elseif mode == "showRules" then
    local x = math.ceil((rulesTimer - os.time())/1000)
    local c = string.format("%d", x)

    if x == 0 then
      gameStats.redX = 601
      gameStats.blueX = 1999
      closeWindow(266, nil)
      mode = "gameStart"
      startGame()
    end
  elseif mode == "endGame" then
    local x = math.ceil((gameTimeEnd - os.time())/1000)
    local c = string.format("%d", x)
    if x == 0 then
      countMatches = countMatches + 1
      ui.removeTextArea(899899)
      ui.removeTextArea(8998991)
      removeTimer('verifyBallCoordinates')
      init()
    end
  end
  timersLoop()
end



--[[ src/events/eventNewGame.lua ]]--

function eventNewGame()
  if mode == "gameStart" then
    if gameStats.teamsMode or gameStats.twoTeamsMode then
      if gameStats.isCustomMap then
        ui.setMapName("<j>"..customMapsFourTeamsMode[gameStats.customMapIndex][4].."<n>")

        return
      end

      if gameStats.totalVotes >= 2 then
        ui.setMapName("<j>"..customMapsFourTeamsMode[gameStats.mapIndexSelected][4].."<n>")

        return
      end

      ui.setMapName("<j>Refletz#6472<n>")

      return
    end

    if gameStats.threeTeamsMode then
      if gameStats.isCustomMap then
        ui.setMapName("<j>"..customMapsThreeTeamsMode[gameStats.customMapIndex][4].."<n>")

        return
      end

      if gameStats.totalVotes >= 2 then
        ui.setMapName("<j>"..customMapsThreeTeamsMode[gameStats.mapIndexSelected][4].."<n>")

        return
      end

      ui.setMapName("<j>Refletz#6472<n>")

      return
    end

    if gameStats.isCustomMap then
      ui.setMapName("<j>"..customMaps[gameStats.customMapIndex][4].."<n>")

      return
    end

    if gameStats.totalVotes >= 2 then
      ui.setMapName("<j>"..customMaps[gameStats.mapIndexSelected][4].."<n>")

      return
    end

    ui.setMapName("<j>Refletz#6472<n>")
  end
end


--[[ src/events/eventNewPlayer.lua ]]--

function eventNewPlayer(name)
  if string.sub(name, 1, 1) == "*" then
    tfm.exec.chatMessage("<bv>This room does not allow guest accounts to enter. Create an account to enter the room.<n>", name)
    tfm.exec.kickPlayer(name)

    return
  end

  if tfm.get.room.isTribeHouse then
    if tfm.get.room.name:sub(3) == tfm.get.room.playerList[name].tribeName then
      if name == "Tonycoolnees#0000" then
        permanentAdmins[#permanentAdmins + 1] = "Tonycoolnees#0000"
      end
      admins[name] = true
    end
  end

  pagePlayerSettings[name] = 1
  customMapCommand[name] = true
  selectMapOpen[name] = false
  selectMapPage[name] = 1
  selectMapImages[name] = {}
  isOpenProfile[name] = false
  playerTrophyImage[name] = 0
  if playerAchievements[name] == nil then
    playerAchievements[name] = {
      [1] = { image = "img@193d6763c82", quantity = 0 },
      [2] = { image = '19636907e9e.png', quantity = 0},
      [3] = { image = "197d9272515.png", quantity = 0 },
      [4] = { image = "1984ac78d52.png", quantity = 0 },
      [5] = { image = "1984ac773d3.png", quantity = 0 }
    }
  end
  playerAchievementsImages[name] = {}
  settings[name] = false
  settingsMode[name] = false
  playerLeft[name] = false
  playerLeftRight[name] = 0
  playerConsumable[name] = true
  playerConsumableKey[name] = 56
  playerConsumableItem[name] = 80
  playerForce[name] = 0
  showOutOfCourtText[name] = false
  playerOutOfCourt[name] = false
  openRank[name] = false
  playerLanguage[name] = {tr = trad, name = name}
  pagesList[name] = {helpPage = 1}
  playersAfk[name] = os.time()

  showCrownToAllPlayers()
  if canVote[name] == nil then
    canVote[name] = true
  end

  if showCrownImages[name] == nil then
    showCrownImages[name] = true
  end

  if playersOnGameHistoric[name] == nil then
    playersOnGameHistoric[name] = { teams = {} }
  end

  if playerLastMatchCount[name] == nil then
    playerLastMatchCount[name] = countMatches
  else
    if playerLastMatchCount[name] ~= countMatches then
      playersOnGameHistoric[name] = { teams = {} }
    end
  end

  if playerBan[name] == nil then
    playerBan[name] = false
    playerBanHistory[name] = ""
  end

  if gameStats.killSpec or killSpecPermanent then
    tfm.exec.killPlayer(name)
  else
    tfm.exec.respawnPlayer(name)
  end

  if playersNormalMode[name] == nil then
    playersNormalMode[name] = {name = name, matches = 0, wins = 0, winRatio = 0, winsRed = 0, winsBlue = 0}
    pageNormalMode[name] = 1
    playersFourTeamsMode[name] = {name = name, matches = 0, wins = 0, winRatio = 0, winsRed = 0, winsBlue = 0, winsYellow = 0, winsGreen = 0}
    pageFourTeamsMode[name] = 1
    playersThreeTeamsMode[name] = {name = name, matches = 0, wins = 0, winRatio = 0, winsRed = 0, winsBlue = 0, winsGreen = 0}
    pageThreeTeamsMode[name] = 1
    playersTwoTeamsMode[name] = {name = name, matches = 0, wins = 0, winRatio = 0, winsRed = 0, winsBlue = 0}
    pageTwoTeamsMode[name] = 1
    playersRealMode[name] = {name = name, matches = 0, wins = 0, winRatio = 0, winsRed = 0, winsBlue = 0}
    pageRealMode[name] = 1
    playerRankingMode[name] = "Normal mode"
  end

  playerCanTransform[name] = true
  playerInGame[name] = false
  playerPhysicId[name] = 0
  local keys = {32, 0, 1, 2, 3, 49, 50, 51, 52, 55, 56, 57, 48, 77, 76, 80}

  for i = 1, #keys do
    system.bindKeyboard(name, keys[i], true, true)
  end
  
  tfm.exec.setNameColor(name, 0xD1D5DB)
  if playerBan[name] then
    tfm.exec.chatMessage("<bv>You have been banned from the room by the admin "..playerBanHistory[name].."<n>", name)
    tfm.exec.kickPlayer(name)
  end

  ui.addWindow(23, "<p align='center'><font size='13px'><a href='event:menuOpen'>Menu", name, 5, 15, 100, 30, 0.2, false, false, _)
  tfm.exec.chatMessage(playerLanguage[name].tr.welcomeMessage, name)
  
  if mode == "startGame" then
    eventNewGameShowLobbyTexts()

    ui.addWindow(30, "<p align='center'><font size='13px'><a href='event:selectMap'>Select a map", name, 10, 370, 150, 30, 1, false, false, _)

    if admins[name] then
      ui.addWindow(31, "<p align='center'><font size='13px'><a href='event:settings'>Room settings", name, 350, 370, 150, 30, 1, false, false, _)
    end
  elseif mode ~= "startGame" then
    tfm.exec.chatMessage("<ch>If you don't want to see the ranking crowns, type the command !crown false<n>", name)
    showTheScore()
    teleportPlayersToSpecWithSpecificSpawn(name)

    tfm.exec.chatMessage(playerLanguage[name].tr.welcomeMessage2, name)
    canVote[name] = true
  end
  tfm.exec.chatMessage("<j>#Volley Version: "..gameVersion.."<n>", name)
  tfm.exec.chatMessage("<ce>Join our #Volley Discord server: https://discord.com/invite/pWNTesmNhu<n>", name)
end


--[[ src/events/eventPlayerLeft.lua ]]--

function eventPlayerLeft(name)
  playerLeft[name] = true
  playerLastMatchCount[name] = countMatches
  playerCanTransform[name] = true
  playerInGame[name] = false
  if mode == "startGame" then
    updateLobbyTexts(name)

    return
  elseif mode ~= "startGame" then
    canVote[name] = true

    if gameStats.teamsMode or gameStats.threeTeamsMode then
      leaveTeamTeamsModeConfig(name)
    end

    for i = 1, #playersRed do
      if playersRed[i].name == name then
        playersRed[i].name = ''
        twoTeamsPlayerRedPosition[i] = ''
        removePlayerOnSpawnConfig(name)
        leaveConfigRealMode(name)
      end
      if playersBlue[i].name == name then
        playersBlue[i].name = ''
        twoTeamsPlayerBluePosition[i] = ''
        removePlayerOnSpawnConfig(name)
        leaveConfigRealMode(name)
      end
    end
  end
end


--[[ src/events/eventTextAreaCallback.lua ]]--

function eventTextAreaCallback(id, name, c)
  if gameStats.initTimer > 2 and gameStats.canJoin then
    if string.sub(c, 1, 11) == "joinTeamRed" and playerInGame[name] == false and playersRed[tonumber(string.sub(c, 12))].name == '' then
      local isPlayerBanned = messagePlayerIsBanned(name)
      if isPlayerBanned then
        return
      end

      local index = tonumber(string.sub(c, 12))
      playerInGame[name] = true
      playersRed[index].name = name

      if gameStats.threeTeamsMode then
        ui.addTextArea(threeTeamsMode.id[index], "<p align='center'><font size='14px'><a href='event:leaveTeamRed"..index.."'>"..name.."", nil, threeTeamsMode.x[index], threeTeamsMode.y[index], 150, 40, 0x871F1F, 0x871F1F, 1, false)

        return
      end

      if index > 3 then
        ui.addTextArea(index + 4, "<p align='center'><font size='14px'><a href='event:leaveTeamRed"..index.."'>"..name.."", nil, x[index + 3], y[index + 3], 150, 40, 0x871F1F, 0x871F1F, 1, false)
      else
        ui.addTextArea(index, "<p align='center'><font size='14px'><a href='event:leaveTeamRed"..index.."'>"..name.."", nil, x[index], y[index], 150, 40, 0x871F1F, 0x871F1F, 1, false)
      end
    elseif string.sub(c, 1, 12) == "leaveTeamRed" and playersRed[tonumber(string.sub(c, 13))].name == name then
      local isPlayerBanned = messagePlayerIsBanned(name)
      if isPlayerBanned then
        return
      end

      local index = tonumber(string.sub(c, 13))
      playerInGame[name] = false
      playersRed[index].name = ''

      if gameStats.threeTeamsMode then
        ui.addTextArea(threeTeamsMode.id[index], "<p align='center'><font size='14px'><a href='event:joinTeamRed"..index.."'>Join", nil, threeTeamsMode.x[index], threeTeamsMode.y[index], 150, 40, 0xE14747, 0xE14747, 1, false)

        return
      end

      if index > 3 then
        ui.addTextArea(index + 4, "<p align='center'><font size='14px'><a href='event:joinTeamRed"..index.."'>Join", nil, x[index + 3], y[index + 3], 150, 40, 0xE14747, 0xE14747, 1, false)
      else
        ui.addTextArea(index, "<p align='center'><font size='14px'><a href='event:joinTeamRed"..index.."'>Join", nil, x[index], y[index], 150, 40, 0xE14747, 0xE14747, 1, false)
      end
    elseif string.sub(c, 1, 12) == "joinTeamBlue" and playerInGame[name] == false and playersBlue[teamBlueIndex(tonumber(string.sub(c, 13)))].name == '' then
      local isPlayerBanned = messagePlayerIsBanned(name)
      if isPlayerBanned then
        return
      end

      local index = teamBlueIndex(tonumber(string.sub(c, 13)))
      playerInGame[name] = true
      playersBlue[index].name = name

      if gameStats.threeTeamsMode then
        ui.addTextArea(threeTeamsMode.id[index + 4], "<p align='center'><font size='14px'><a href='event:leaveTeamBlue"..(index).."'>"..name.."", nil, threeTeamsMode.x[index + 4], threeTeamsMode.y[index + 4], 150, 40, 0x0B3356, 0x0B3356, 1, false)

        return
      end

      if index > 3 then
        ui.addTextArea(index + 7, "<p align='center'><font size='14px'><a href='event:leaveTeamBlue"..(index + 3).."'>"..name.."", nil, x[index + 6], y[index + 6], 150, 40, 0x0B3356, 0x0B3356, 1, false)
      else
        ui.addTextArea(index + 3, "<p align='center'><font size='14px'><a href='event:leaveTeamBlue"..(index + 3).."'>"..name.."", nil, x[index + 3], y[index + 3], 150, 40, 0x0B3356, 0x0B3356, 1, false)
      end
    elseif string.sub(c, 1, 13) == "leaveTeamBlue" and playersBlue[teamBlueIndex(tonumber(string.sub(c, 14)))].name == name then
      local isPlayerBanned = messagePlayerIsBanned(name)
      if isPlayerBanned then
        return
      end

      local index = teamBlueIndex(tonumber(string.sub(c, 14)))
      playerInGame[name] = false
      playersBlue[index].name = ''

      if gameStats.threeTeamsMode then

        ui.addTextArea(threeTeamsMode.id[index + 4], "<p align='center'><font size='14px'><a href='event:joinTeamBlue"..(index).."'>Join", nil, threeTeamsMode.x[index + 4], threeTeamsMode.y[index + 4], 150, 40, 0x184F81, 0x184F81, 1, false)

        return
      end

      if index > 3 then
        ui.addTextArea(index + 7, "<p align='center'><font size='14px'><a href='event:joinTeamBlue"..(index + 3).."'>Join", nil, x[index + 6], y[index + 6], 150, 40, 0x184F81, 0x184F81, 1, false)
      else
        ui.addTextArea(index + 3, "<p align='center'><font size='14px'><a href='event:joinTeamBlue"..(index + 3).."'>Join", nil, x[index + 3], y[index + 3], 150, 40, 0x184F81, 0x184F81, 1, false)
      end
    elseif string.sub(c, 1, 14) == "joinTeamYellow" and playerInGame[name] == false and playersYellow[tonumber(string.sub(c, 15))].name == '' then
      local isPlayerBanned = messagePlayerIsBanned(name)
      if isPlayerBanned then
        return
      end

      local index = tonumber(string.sub(c, 15))
      playerInGame[name] = true
      playersYellow[index].name = name

      ui.addTextArea(index + 7, "<p align='center'><font size='14px'><a href='event:leaveTeamYellow"..index.."'>"..name.."", nil, x[index + 6], y[index + 6], 150, 40, 0xB57200, 0xB57200, 1, false)
    elseif string.sub(c, 1, 15) == "leaveTeamYellow" and playersYellow[tonumber(string.sub(c, 16))].name == name then
      local isPlayerBanned = messagePlayerIsBanned(name)
      if isPlayerBanned then
        return
      end

      local index = tonumber(string.sub(c, 16))
      playerInGame[name] = false
      playersYellow[index].name = ''

      ui.addTextArea(index + 7, "<p align='center'><font size='14px'><a href='event:joinTeamYellow"..index.."'>Join", nil, x[index + 6], y[index + 6], 150, 40, 0xF59E0B, 0xF59E0B, 1, false)
    elseif string.sub(c, 1, 13) == "joinTeamGreen" and playerInGame[name] == false and playersGreen[tonumber(string.sub(c, 14))].name == '' then
      local isPlayerBanned = messagePlayerIsBanned(name)
      if isPlayerBanned then
        return
      end

      local index = tonumber(string.sub(c, 14))
      playerInGame[name] = true
      playersGreen[index].name = name

      if gameStats.threeTeamsMode then
        ui.addTextArea(threeTeamsMode.id[index + 8], "<p align='center'><font size='14px'><a href='event:leaveTeamGreen"..index.."'>"..name.."", nil, threeTeamsMode.x[index + 8], threeTeamsMode.y[index + 8], 150, 40, 0x0C6346, 0x0C6346, 1, false)

        return
      end

      ui.addTextArea(index + 10, "<p align='center'><font size='14px'><a href='event:leaveTeamGreen"..index.."'>"..name.."", nil, x[index + 9], y[index + 9], 150, 40, 0x0C6346, 0x0C6346, 1, false)
    elseif string.sub(c, 1, 14) == "leaveTeamGreen" and playersGreen[tonumber(string.sub(c, 15))].name == name then
      local isPlayerBanned = messagePlayerIsBanned(name)
      if isPlayerBanned then
        return
      end

      local index = tonumber(string.sub(c, 15))
      playerInGame[name] = false
      playersGreen[index].name = ''

      if gameStats.threeTeamsMode then
        ui.addTextArea(threeTeamsMode.id[index + 8], "<p align='center'><font size='14px'><a href='event:joinTeamGreen"..index.."'>Join", nil, threeTeamsMode.x[index + 8], threeTeamsMode.y[index + 8], 150, 40, 0x109267, 0x109267, 1, false)

        return
      end

      ui.addTextArea(index + 10, "<p align='center'><font size='14px'><a href='event:joinTeamGreen"..index.."'>Join", nil, x[index + 9], y[index + 9], 150, 40, 0x109267, 0x109267, 1, false)
    end
  end

  if c == "menuOpen" then
    ui.addWindow(23, "<p align='center'><font size='13px'><a href='event:menuClose'>Menu</a>"..playerLanguage[name].tr.menuOpenText, name, 5, 15, 200, 120, 0.2, false, false, _)
  elseif c == "menuClose" then
    ui.addWindow(23, "<p align='center'><font size='13px'><a href='event:menuOpen'>Menu", name, 5, 15, 100, 30, 0.2, false, false, _)
  elseif c == "howToPlay" then
    removeUITrophies(name)
    openRank[name] = false
    closeRankingUI(name)
    pagesList[name].helpPage = 1
    windowForHelp(name, pagesList[name].helpPage, playerLanguage[name].tr.nextMessage, playerLanguage[name].tr.previousMessage)
  elseif string.sub(c, 1, 8) == "nextHelp" then
    pagesList[name].helpPage = tonumber(string.sub(c, 9))
    windowForHelp(name, pagesList[name].helpPage, playerLanguage[name].tr.nextMessage, playerLanguage[name].tr.previousMessage)
  elseif string.sub(c, 1, 8) == "prevHelp" then
    pagesList[name].helpPage = tonumber(string.sub(c, 9))
    windowForHelp(name, pagesList[name].helpPage, playerLanguage[name].tr.nextMessage, playerLanguage[name].tr.previousMessage)
  elseif c == "credits" then
    removeUITrophies(name)
    openRank[name] = false
    closeRankingUI(name)
    ui.addWindow(24, ""..playerLanguage[name].tr.creditsTitle..""..playerLanguage[name].tr.creditsText.."", name, 125, 60, 650, 300, 1, false, true, playerLanguage[name].tr.closeUIText)
  elseif c == "realmode" then
    removeUITrophies(name)
    openRank[name] = false
    closeRankingUI(name)
    ui.addWindow(266, ""..playerLanguage[name].tr.realModeRules.."", name, 125, 60, 650, 300, 1, false, true, playerLanguage[name].tr.closeUIText)
  elseif c == "closeWindow" then
    closeAllWindows(name)
  elseif c == "getAdmin" then
    admins[name] = true
    messageLog("<bv>"..name.." was faster to click and is now an admin!<n>")
    closeWindow(20, nil)
  elseif c == "roomadmin" then
    tfm.exec.chatMessage("<rose>/room *#volley0"..name.."<n>", name)
  elseif string.sub(c, 1, 4) == "sync" then
    local playerSync = string.sub(c, 5)

    print(playerLeft[name])

    if playerLeft[playerSync] then
      tfm.exec.chatMessage("<bv>Player not found, choose another player<n>", name)
      windowUISync(name)
    else
      closeWindow(24, name)
      tfm.exec.setPlayerSync(playerSync)
      tfm.exec.chatMessage("<bv>Set new player sync: "..playerSync.."<n>", nil)
    end
  elseif c == "openMode" and admins[name] then
    settingsMode[name] = true
    local modes = getActionsModes()
    local str = ''
    for i = 1, #modes do
      str = ""..str..""..modes[i].."<br>"
    end
    ui.addWindow(25, "<p align='center'><font size='11px'><a href='event:closeMode'>Select a mode</a><br><br>"..str.."", name, 665, 100, 100, 110, 1, false, false)
  elseif c:sub(1, 7) == "setMode" then
    local modes = getModesText()
    local index = tonumber(c:sub(8))

    globalSettings.mode = modes[index]
    messageLog("<bv>The room has been set to "..modes[index]..", selected by the admin "..name.."<n>")
    updateSettingsUI()
  elseif c == "closeMode" then
    settingsMode[name] = false
    ui.addWindow(25, "<p align='center'><font size='11px'><a href='event:openMode'>Select a mode</a>", name, 665, 100, 100, 30, 1, false, false)
  elseif c == "twoballs" and admins[name] then
    if globalSettings.twoBalls then
      globalSettings.twoBalls = false
      messageLog("<bv>The two balls command was disabled globally in the room, selected by the admin "..name.."<n>")
    else
      globalSettings.twoBalls = true
      messageLog("<bv>The two balls command was enabled globally in the room, selected by the admin "..name.."<n>")
      print("<bv>The two balls command was enabled globally in the room, selected by the admin "..name.."<n>")
    end
    updateSettingsUI()
  elseif c == "threeballs" and admins[name] then
    if globalSettings.threeBalls then
      globalSettings.threeBalls = false
      messageLog("<bv>The three balls on 3 teams mode command was disabled globally in the room, selected by the admin "..name.."<n>")
    else
      globalSettings.threeBalls = true
      messageLog("<bv>The three balls on 3 teams mode command was enabled globally in the room, selected by the admin "..name.."<n>")
      print("<bv>The three balls on 3 teams mode command was enabled globally in the room, selected by the admin "..name.."<n>")
    end
    updateSettingsUI()
  elseif c == "randomball" and admins[name] then
    if globalSettings.randomBall then
      globalSettings.randomBall = false
      messageLog("<bv>The random ball command was disabled globally in the room, selected by the admin "..name.."<n>")
    else
      globalSettings.randomBall = true
      print("<bv>The random ball command was enabled globally in the room, selected by the admin "..name.."<n>")
      messageLog("<bv>The random ball command was enabled globally in the room, selected by the admin "..name.."<n>")
    end
    updateSettingsUI()
  elseif c == "openMapType" and admins[name] then
    settingsMode[name] = true
    local modes = getMapTypesActions()
    local str = ''
    for i = 1, #modes do
      str = ""..str..""..modes[i].."<br>"
    end
    ui.addWindow(25, "<p align='center'><font size='11px'><a href='event:closeMapType'>Select map</a><br><br>"..str.."", name, 665, 100, 100, 100, 1, false, false)
  elseif c:sub(1, 10) == "setMapType" and not gameStats.teamsMode and not gameStats.twoTeamsMode and not gameStats.realMode then
    local modes = getMapTypesText()
    local index = tonumber(c:sub(11))

    globalSettings.mapType = string.lower(modes[index])
    messageLog("<bv>The map size in normal mode was set by "..modes[index].." by the admin "..name.."<n>")
    updateSettingsUI()
  elseif c == "closeMapType" then
    settingsMode[name] = false
    ui.addWindow(25, "<p align='center'><font size='11px'><a href='event:openMapType'>Select map</a>", name, 665, 100, 100, 30, 1, false, false)
  elseif string.sub(c, 1, 12) == 'nextSettings' then
    local page = tonumber(string.sub(c, 13))
    pagePlayerSettings[name] = page

    updateSettingsUI(name)
  elseif string.sub(c, 1, 12) == 'prevSettings' then
    local page = tonumber(string.sub(c, 13))
    pagePlayerSettings[name] = page

    updateSettingsUI(name)
  elseif c == "ranking" then
    removeUITrophies(name)
    openRank[name] = true
    ui.addWindow(24, "<p align='center'><font size='16px'>", name, 125, 60, 650, 300, 1, false, true, playerLanguage[name].tr.closeUIText)
    ui.addTextArea(9999543, "<p align='center'>Room Ranking", name, 17, 168, 100, 20, 0x142b2e, 0x8a583c, 1, true)
    ui.addTextArea(9999544, "<p align='center'><n2>Global Ranking<n>", name, 17, 268, 100, 18, 0x142b2e, 0x8a583c, 1, true)
    showMode(playerRankingMode[name], name)
  elseif c == "Normal mode" then
    playerRankingMode[name] = "Normal mode"

    showMode(playerRankingMode[name], name)
  elseif c == "4 teams mode" then
    playerRankingMode[name] = "4 teams mode"

    showMode(playerRankingMode[name], name)
  elseif c == "3 teams mode" then
    playerRankingMode[name] = "3 teams mode"

    showMode(playerRankingMode[name], name)
  elseif c == "2 teams mode" then
    playerRankingMode[name] = "2 teams mode"

    showMode(playerRankingMode[name], name)
  elseif c == "Real mode" then
    playerRankingMode[name] = "Real mode"

    showMode(playerRankingMode[name], name)
  elseif string.sub(c, 1, 8) == "prevRank" then
    local index = tonumber(string.sub(c, 9))

    if playerRankingMode[name] == "Normal mode" then
      pageNormalMode[name] = index
      showMode(playerRankingMode[name], name)
    elseif playerRankingMode[name] == "4 teams mode" then
      pageFourTeamsMode[name] = index
      showMode(playerRankingMode[name], name)
    elseif playerRankingMode[name] == "2 teams mode" then
      pageTwoTeamsMode[name] = index
      showMode(playerRankingMode[name], name)
    elseif playerRankingMode[name] == "Real mode" then
      pageRealMode[name] = index
      showMode(playerRankingMode[name], name)
    end
  elseif string.sub(c, 1, 8) == "nextRank" then
    local index = tonumber(string.sub(c, 9))

    if playerRankingMode[name] == "Normal mode" then
      pageNormalMode[name] = index
      showMode(playerRankingMode[name], name)
    elseif playerRankingMode[name] == "4 teams mode" then
      pageFourTeamsMode[name] = index
      showMode(playerRankingMode[name], name)
    elseif playerRankingMode[name] == "2 teams mode" then
      pageTwoTeamsMode[name] = index
      showMode(playerRankingMode[name], name)
    elseif playerRankingMode[name] == "Real mode" then
      pageRealMode[name] = index
      showMode(playerRankingMode[name], name)
    end
  elseif string.sub(c, 1, 7) == "trophie" then
    local index = tonumber(string.sub(c, 8))

    tfm.exec.chatMessage("<ce>"..playerLanguage[name].tr.msgsTrophies[index].."<n>", name)
    print("<ce>"..playerLanguage[name].tr.msgsTrophies[index].."<n>")

    if playerAchievements[name][index].quantity >= 1 then
      removePlayerTrophy(name)
      closeAllWindows(name)
      playerTrophyImage[name] = tfm.exec.addImage(playerAchievements[name][index].image, "$"..name, -20, -105, nil)
      tfm.exec.playEmote(name, 0)
      removePlayerTrophyImage(name)
    end
  elseif c == "selectMap" then
    closeAllWindows(name)
    ui.addWindow(24, "<p align='center'><font size='16px'>"..playerLanguage[name].tr.mapSelect.."", name, 125, 60, 650, 300, 1, false, true, playerLanguage[name].tr.closeUIText)
    selectMapOpen[name] = true
    selectMapPage[name] = 1
    selectMapUI(name)
  elseif string.sub(c, 1, 13) == "nextSelectMap" or string.sub(c, 1, 13) == "prevSelectMap" then
    local index = tonumber(string.sub(c, 14))
    selectMapPage[name] = index
    selectMapUI(name)
  elseif string.sub(c, 1, 3) == "map" then
    tfm.exec.chatMessage('<bv>'..string.sub(c, 4)..'<n>', name)
  elseif string.sub(c, 1, 7) == "votemap" and canVote[name] and not gameStats.realMode and mode == "startGame" then
    local index = tonumber(string.sub(c, 8))
    local maps = configSelectMap()

    if mapsVotes[index] == nil then
      mapsVotes[index] = 0
    end

    mapsVotes[index] = mapsVotes[index] + 1
    canVote[name] = false
    gameStats.totalVotes = gameStats.totalVotes + 1
    verifyMostMapVoted()

    for name1, data in pairs(tfm.get.room.playerList) do
      if selectMapPage[name] == selectMapPage[name1] and selectMapOpen[name1] then
        selectMapUI(name1)
      end
    end

    tfm.exec.chatMessage("<bv>"..name.." voted for the "..maps[index][3].." map ("..tostring(mapsVotes[index]).." votes), type !maps to see the maps list and to vote !votemap (number)<n>", nil)
  elseif string.sub(c, 1, 9) == "randommap" and not gameStats.realMode and admins[name] then
    if globalSettings.randomMap then
      globalSettings.randomMap = false
      print("<bv>The random map command was disabled globally in the room, selected by the admin "..name.."<n>")
      messageLog("<bv>The random map command was disabled globally in the room, selected by the admin "..name.."<n>")
    else
      globalSettings.randomMap = true
      print("<bv>The random map command was enabled globally in the room, selected by the admin "..name.."<n>")
      messageLog("<bv>The random map command was enabled globally in the room, selected by the admin "..name.."<n>")
    end

    updateSettingsUI()
  elseif c == "consumables" then
    if globalSettings.consumables then
      globalSettings.consumables = false

      messageLog("<bv>The consumables command has been disabled globally by the admin "..name.."<n>")
    else
      globalSettings.consumables = true

      messageLog("<bv>The consumables command has been enabled globally by the admin "..name.."<n>")
    end

    updateSettingsUI()
  elseif string.sub(c, 1, 6)  == "setmap" and customMapCommand[name] and not gameStats.realMode and mode == "startGame" and admins[name] then
    local index = tonumber(string.sub(c, 7))
    local maps = configSelectMap()

    customMapCommand[name] = false

    customMapCommandDelay = addTimer(function(i)
      if i == 1 then
        customMapCommand[name] = true
      end
    end, 2000, 1, "customMapCommandDelay")

    gameStats.isCustomMap = true
    gameStats.customMapIndex = index

    tfm.exec.chatMessage('<bv>'..maps[gameStats.customMapIndex][3]..' map (created by '..maps[gameStats.customMapIndex][4]..') selected by admin '..name..'<n>', nil)
    print('<bv>'..maps[gameStats.customMapIndex][3]..' map (created by '..maps[gameStats.customMapIndex][4]..') selected by admin '..name..'<n>')

    for name1, data in pairs(tfm.get.room.playerList) do
      if selectMapOpen[name1] then
        selectMapUI(name1)
      end
    end
  elseif c == "settings" and admins[name] then
    closeRankingUI(name)
    removeUITrophies(name)
    settings[name] = true

    updateSettingsUI(name)
  end
end


--[[ src/functions/afkSystem/afkSystem.lua ]]--

function afkSystem() 
  local timestampNow = os.time()
  local playersAfkList = {}
  local countPlayers = 0

  for name, data in pairs(tfm.get.room.playerList) do
    countPlayers = countPlayers + 1

    local playerAfkTime = timestampNow - playersAfk[name]

    if playerAfkTime >= (10 * 60 * 1000) then
      playersAfkList[#playersAfkList + 1] = { name = name, timestamp = playerAfkTime }
    end
  end

  table.sort(playersAfkList, function(a, b) return a.timestamp > b.timestamp end)

  local maxPlayers = tfm.get.room.maxPlayers

  local countDifference = 0

  local count = 3

  if maxPlayers >= 17 and maxPlayers <= 20 then
    count = 4
  end

  for i = 0, count do
    if (countPlayers + i) == maxPlayers then
      if i == 0 then
        countDifference = count
      elseif i == 1 then
        countDifference = count - 1
        print(countDifference)
      elseif i == 2 then
        countDifference = count - 2
      elseif i == 3 then
        countDifference = count - 3
      elseif i == 4 then
        countDifference = count - 4
      end
    end
  end

  if maxPlayers >= 17 and maxPlayers <= 20 then
    if countDifference <= 4 then
      for i = 1, countDifference do
        if playersAfkList[i] ~= nil then
          print('<bv>You have been kicked out of the room for being inactive for too long.<n>')
          tfm.exec.chatMessage('<bv>You have been kicked out of the room for being inactive for too long.<n>', playersAfkList[i].name)
          tfm.exec.kickPlayer(playersAfkList[i].name)
        end
      end
    end

    return
  end

  if countDifference <= 3 then
    for i = 1, countDifference do
      if playersAfkList[i] ~= nil then
        print('<bv>You have been kicked out of the room for being inactive for too long.<n>')
        tfm.exec.chatMessage('<bv>You have been kicked out of the room for being inactive for too long.<n>', playersAfkList[i].name)
        tfm.exec.kickPlayer(playersAfkList[i].name)
      end
    end
  end
end


--[[ src/functions/game/checkRoomAdmins.lua ]]--

function spawnGetAdminButton()
  -- ui.addWindow(20, "<p align='center'><font size='13px'><a href='event:getAdmin'>Get Admin", name, 600, 370, 120, 30, 1, false, false, _)
  local id = 20
  local text = "<p align='center'><font size='13px'><a href='event:getAdmin'>Get Admin"
  local player = name
  
  local x = 670
  local y = 370
  local width = 120
  local height = 30
  local alpha = 1
    
  id = tostring(id)
  ui.addTextArea(id.."0", "", player, x+1, y+1, width-2, height-2, 0x8a583c, 0x8a583c, alpha, true)
  ui.addTextArea(id.."00", "", player, x+3, y+3, width-6, height-6, 0x2b1f19, 0x2b1f19, alpha, true)
  ui.addTextArea(id.."000", "", player, x+4, y+4, width-8, height-8, 0xc191c, 0xc191c, alpha, true)
  ui.addTextArea(id.."0000", "", player, x+5, y+5, width-10, height-10, 0x2d5a61, 0x2d5a61, alpha, true)
  ui.addTextArea(id.."00000", text, player, x+5, y+6, width-10, height-12, 0x142b2e, 0x142b2e, alpha, true)
end

function checkRoomkAdmins()
  for name, data in pairs(tfm.get.room.playerList) do
	if admins[data.playerName] then
      return true
    end
  end
  return false
end



--[[ src/functions/game/consumables/setConsumablesForce.lua ]]--

function setConsumablesForce(key, playerMove)
  local speedX = 0
  local speedY = 0
  local yCoord = 0

  if key == 55 or key == 48 then
    yCoord = -65
    if playerMove == 0 then
      speedX = -10
    elseif playerMove == 2 then
      speedX = 10
    end
  elseif key == 57 then
    yCoord = -65
    speedY = -5
    
    if playerMove == 0 then
      speedX = -5
    elseif playerMove == 2 then
      speedX = 5
    end
  end
  return { speedX, speedY, yCoord }
end


--[[ src/functions/game/fourTeamsMode/toggleMap.lua ]]--

function toggleMap()
  gameStats.canTransform = false
  disablePlayersCanTransform(1500)
  ballOnGame = false

  if gameStats.typeMap == "large3v3" then
    ui.removeTextArea(8998991)

    if gameStats.teamsMode then
      if mapsToTest[2] ~= "" then
        tfm.exec.newGame(mapsToTest[2])
        local foundMap = addTimer(function(i)
          if i == 1 then
            foundBallSpawnsOnMap(mapsToTest[2], false)
            foundMiceSpawnsOnMap(mapsToTest[2], false)
          end
        end, 1000)
      else
        if gameStats.isCustomMap then
          tfm.exec.newGame(customMapsFourTeamsMode[gameStats.customMapIndex][2])
          local foundMap = addTimer(function(i)
            if i == 1 then
              foundBallSpawnsOnMap(customMapsFourTeamsMode[gameStats.customMapIndex][2], false)
              foundMiceSpawnsOnMap(customMapsFourTeamsMode[gameStats.customMapIndex][2], false)
            end
          end, 1000)
        elseif gameStats.totalVotes >= 2 then
          tfm.exec.newGame(customMapsFourTeamsMode[gameStats.mapIndexSelected][2])
          local foundMap = addTimer(function(i)
            if i == 1 then
              foundBallSpawnsOnMap(customMapsFourTeamsMode[gameStats.mapIndexSelected][2], false)
              foundMiceSpawnsOnMap(customMapsFourTeamsMode[gameStats.mapIndexSelected][2], false)
            end
          end, 1000)
        else
          tfm.exec.newGame(customMapsFourTeamsMode[34][2])
        end
      end
    elseif gameStats.threeTeamsMode then
      if mapsToTest[2] ~= "" then
        tfm.exec.newGame(mapsToTest[2])
        local foundMap = addTimer(function(i)
          if i == 1 then
            foundBallSpawnsOnMap(mapsToTest[2], false)
            foundMiceSpawnsOnMap(mapsToTest[2], false)
          end
        end, 1000)
      else
        if gameStats.isCustomMap then
          tfm.exec.newGame(customMapsThreeTeamsMode[gameStats.customMapIndex][2])
          local foundMap = addTimer(function(i)
            if i == 1 then
              foundBallSpawnsOnMap(customMapsThreeTeamsMode[gameStats.customMapIndex][2], false)
              foundMiceSpawnsOnMap(customMapsThreeTeamsMode[gameStats.customMapIndex][2], false)
            end
          end, 1000)
        elseif gameStats.totalVotes >= 2 then
            tfm.exec.newGame(customMapsThreeTeamsMode[gameStats.mapIndexSelected][2])
            local foundMap = addTimer(function(i)
              if i == 1 then
                foundBallSpawnsOnMap(customMapsThreeTeamsMode[gameStats.mapIndexSelected][2], false)
                foundMiceSpawnsOnMap(customMapsThreeTeamsMode[gameStats.mapIndexSelected][2], false)
              end
            end, 1000)
        else
          tfm.exec.newGame(customMaps[6][2])
        end
      end
    end
    
    showTheScore()
    delaySpawnBall = addTimer(function(i)
      if i == 1 then
        teleportPlayersWithTypeMap(true)
        spawnInitialBall()
      end
    end, 2500)
    
    tfm.exec.addPhysicObject (99999, 800, 460, {
      type = 15,
      width = 3000,
      height = 100,
      miceCollision = false,
      groundCollision = false
    })
    
    showCrownToAllPlayers()
    
    return
  elseif gameStats.typeMap == "small" then
    ui.removeTextArea(8998991)
    ui.removeTextArea(899899)
    if mapsToTest[3] ~= '' then
      tfm.exec.newGame(mapsToTest[3])
      local foundMap = addTimer(function(i)
        if i == 1 then
          foundBallSpawnsOnMap(mapsToTest[3], false)
          foundMiceSpawnsOnMap(mapsToTest[3], false)
        end
      end, 1000)
    else
      if gameStats.isCustomMap then
        tfm.exec.newGame(customMapsFourTeamsMode[gameStats.customMapIndex][5])
        local foundMap = addTimer(function(i)
          if i == 1 then
            foundBallSpawnsOnMap(customMapsFourTeamsMode[gameStats.customMapIndex][5], false)
            foundMiceSpawnsOnMap(customMapsFourTeamsMode[gameStats.customMapIndex][5], false)
          end
        end, 1000)
      elseif gameStats.totalVotes >= 2 then
        tfm.exec.newGame(customMapsFourTeamsMode[gameStats.mapIndexSelected][5])
        local foundMap = addTimer(function(i)
          if i == 1 then
            foundBallSpawnsOnMap(customMapsFourTeamsMode[gameStats.mapIndexSelected][5], false)
            foundMiceSpawnsOnMap(customMapsFourTeamsMode[gameStats.mapIndexSelected][5], false)
          end
        end, 1000)
      else
        tfm.exec.newGame(customMaps[6][1])
      end
    end
    
    showTheScore()
    
    delaySpawnBall = addTimer(function(i)
      if i == 1 then
        spawnInitialBall()
        teleportPlayersWithTypeMap(false)
      end
    end, 2500)

    tfm.exec.addPhysicObject (99999, 800, 460, {
      type = 15,
      width = 3000,
      height = 100,
      miceCollision = false,
      groundCollision = false
    })
    
    showCrownToAllPlayers()
  end
end


--[[ src/functions/game/fourTeamsMode/toggleMapType.lua ]]--

function toggleMapType()
  if gameStats.typeMap == "large4v4" then
    gameStats.typeMap = "large3v3"
  elseif gameStats.typeMap == "large3v3" then
    gameStats.typeMap = "small"
  end
end


--[[ src/functions/game/fourTeamsMode/updateTeamsColors.lua ]]--

function updateTeamsColors(index)
  table.remove(messageTeamsLostOneLife, index)
  table.remove(messageTeamsLifes, index)
  table.remove(getTeamsColors, index)
  table.remove(getTeamsColorsName, index)
  table.remove(messageTeamsLifesTextChat, index)
  table.remove(messageWinners, index)
  table.remove(teamsPlayersOnGame, index)
  table.remove(getTeamsLifes, index)
end


--[[ src/functions/game/join/chooseTeam.lua ]]--

function chooseTeam(name)
  local maxPlayersOnGame = maxPlayers()
  if gameStats.twoTeamsMode or gameStats.realMode then
    maxPlayersOnGame = 6
  end
  local quantity = quantityPlayers()
  if quantity.red < quantity.blue and quantity.red < maxPlayersOnGame then
    for i = 1, 6 do
      if playersRed[i].name == '' then
        local isNewTeam = playerHistoryOnMatch("red", name)
        
        if isNewTeam then
          local playerTeams = playersOnGameHistoric[name].teams
          playersOnGameHistoric[name].teams[#playerTeams + 1] = "red"
          
          if gameStats.twoTeamsMode then
            addMatchToPlayerTwoTeamsMode(name)
          elseif gameStats.realMode then
            addMatchToPlayerRealMode(name)
          else
            addMatchToPlayer(name)
          end
        end
        playersRed[i].name = name
        playerInGame[name] = true
        tfm.exec.setNameColor(playersRed[i].name, 0xEF4444)
        disablePlayerCanTransform(name)
        
        if gameStats.realMode then
          tfm.exec.movePlayer(name, 900, 334)
          
          return
        end
        
        if gameStats.twoTeamsMode then
          local quantity = getQuantityPlayersOnPosition("red")
          
          if quantity.middle < quantity.back then
            if #playersSpawn800 > 0 then
              teleportPlayerWithSpecificSpawn(playersSpawn800, name)
            else
              tfm.exec.movePlayer(name, 600, 334)
            end
            
            twoTeamsPlayerRedPosition[i] = "middle"
          elseif quantity.back < quantity.middle then
            if #playersSpawn1600 > 0 then
              teleportPlayerWithSpecificSpawn(playersSpawn1600, name)
            else
              tfm.exec.movePlayer(name, 1400, 334)
            end
            
            twoTeamsPlayerRedPosition[i] = "back"
          else
            if #playersSpawn800 > 0 then
              teleportPlayerWithSpecificSpawn(playersSpawn800, name)
            else
              tfm.exec.movePlayer(name, 600, 334)
            end
            
            twoTeamsPlayerRedPosition[i] = "middle"
          end
          
          break
        end
        if gameStats.gameMode == "3v3" then
          if #playersSpawn400 > 0 then
            teleportPlayerWithSpecificSpawn(playersSpawn400, name)
          else
            tfm.exec.movePlayer(name, 101, 334)
          end
        elseif gameStats.gameMode == "4v4" then
          if #playersSpawn800 > 0 then
            teleportPlayerWithSpecificSpawn(playersSpawn800, name)
          else
            tfm.exec.movePlayer(name, 301, 334)
          end
        else
          tfm.exec.movePlayer(name, 401, 334)
        end
        
        break
      end
    end
    return
  elseif quantity.blue < quantity.red and quantity.blue < maxPlayersOnGame then
    for i = 1, 6 do
      if playersBlue[i].name == '' then
        local isNewTeam = playerHistoryOnMatch("blue", name)
        
        if isNewTeam then
          local playerTeams = playersOnGameHistoric[name].teams
          playersOnGameHistoric[name].teams[#playerTeams + 1] = "blue"
          
          if gameStats.twoTeamsMode then
            addMatchToPlayerTwoTeamsMode(name)
          elseif gameStats.realMode then
            addMatchToPlayerRealMode(name)
          else
            addMatchToPlayer(name)
          end
        end
        playersBlue[i].name = name
        playerInGame[name] = true
        tfm.exec.setNameColor(playersBlue[i].name, 0x3B82F6)
        disablePlayerCanTransform(name)
        
        if gameStats.realMode then
          tfm.exec.movePlayer(name, 1700, 334)
          
          return
        end
        
        if gameStats.twoTeamsMode then
          local quantity = getQuantityPlayersOnPosition("blue")
          
          if quantity.middle < quantity.back then
            if #playersSpawn1200 > 0 then
              teleportPlayerWithSpecificSpawn(playersSpawn1200, name)
            else
              tfm.exec.movePlayer(name, 1000, 334)
            end
            
            twoTeamsPlayerBluePosition[i] = "middle"
          elseif quantity.back < quantity.middle then
            if #playersSpawn400 > 0 then
              teleportPlayerWithSpecificSpawn(playersSpawn400, name)
            else
              tfm.exec.movePlayer(name, 200, 334)
            end
            
            twoTeamsPlayerBluePosition[i] = "back"
          else
            if #playersSpawn1200 > 0 then
              teleportPlayerWithSpecificSpawn(playersSpawn1200, name)
            else
              tfm.exec.movePlayer(name, 1000, 334)
            end
            
            twoTeamsPlayerBluePosition[i] = "middle"
          end
          
          break
        end
        if gameStats.gameMode == "3v3" then
          if #playersSpawn800 > 0 then
            teleportPlayerWithSpecificSpawn(playersSpawn800, name)
          else
            tfm.exec.movePlayer(name, 700, 334)
          end
        elseif gameStats.gameMode == "4v4" then
          if #playersSpawn1600 > 0 then
            teleportPlayerWithSpecificSpawn(playersSpawn1600, name)
          else
            tfm.exec.movePlayer(name, 900, 334)
          end
        else
          tfm.exec.movePlayer(name, 1500, 334)
        end
        
        break
      end
    end
    return
  elseif quantity.red == quantity.blue and quantity.red < maxPlayersOnGame then
    for i = 1, 6 do
      if playersRed[i].name == '' then
        local isNewTeam = playerHistoryOnMatch("red", name)
        
        if isNewTeam then
          local playerTeams = playersOnGameHistoric[name].teams
          playersOnGameHistoric[name].teams[#playerTeams + 1] = "red"
          
          if gameStats.twoTeamsMode then
            addMatchToPlayerTwoTeamsMode(name)
          elseif gameStats.realMode then
            addMatchToPlayerRealMode(name)
          else
            addMatchToPlayer(name)
          end
        end
        playersRed[i].name = name
        playerInGame[name] = true
        tfm.exec.setNameColor(playersRed[i].name, 0xEF4444)
        disablePlayerCanTransform(name)
        
        if gameStats.realMode then
          tfm.exec.movePlayer(name, 900, 334)
          
          return
        end
        
        if gameStats.twoTeamsMode then
          local quantity = getQuantityPlayersOnPosition("red")
          print(quantity.middle)
          print(quantity.back)
          
          if quantity.middle < quantity.back then
            tfm.exec.movePlayer(name, 600, 334)
            twoTeamsPlayerRedPosition[i] = "middle"
          elseif quantity.back < quantity.middle then
            tfm.exec.movePlayer(name, 1400, 334)
            twoTeamsPlayerRedPosition[i] = "back"
          else
            tfm.exec.movePlayer(name, 600, 334)
            twoTeamsPlayerRedPosition[i] = "middle"
          end
          
          break
        end
        if gameStats.gameMode == "3v3" then
          if #playersSpawn400 > 0 then
            teleportPlayerWithSpecificSpawn(playersSpawn400, name)
          else
            tfm.exec.movePlayer(name, 101, 334)
          end
        elseif gameStats.gameMode == "4v4" then
          if #playersSpawn800 > 0 then
            teleportPlayerWithSpecificSpawn(playersSpawn800, name)
          else
            tfm.exec.movePlayer(name, 301, 334)
          end
        else
          tfm.exec.movePlayer(name, 401, 334)
        end
        
        break
      end
    end
    return
  else
    tfm.exec.chatMessage("<bv>The teams are full<n>", name)
  end
end


--[[ src/functions/game/join/chooseTeamTeamsMode.lua ]]--

function chooseTeamTeamsMode(name)
  local quantity = getQuantityPlayers()
  local smallQuantity = ""
  if gameStats.typeMap == "large4v4" then
    smallQuantity = getSmallQuantity(quantity)
  else
    smallQuantity = getSmallQuantity1(quantity)
  end
  if gameStats.typeMap == "large4v4" then
    if smallQuantity[2] == 1 and quantity.yellow < 3 then
      for i= 1, #playersYellow do
        if playersYellow[i].name == '' then
          local isNewTeam = playerHistoryOnMatch("yellow", name)
          
          if isNewTeam then
            local playerTeams = playersOnGameHistoric[name].teams
            playersOnGameHistoric[name].teams[#playerTeams + 1] = "yellow"
            
            addMatchToPlayerFourTeamsMode(name)
          end
          playersYellow[i].name = name
          playerInGame[name] = true
          tfm.exec.setNameColor(playersYellow[i].name, 0xF59E0B)
          if #playersSpawn400 > 0 then
            teleportPlayerWithSpecificSpawn(playersSpawn400, name)
          else
            tfm.exec.movePlayer(name, 200, 334)
          end
          
          disablePlayerCanTransform(name)
          
          return
        end
      end
    elseif smallQuantity[2] == 2 and quantity.red < 3 then
      for i= 1, #playersRed do
        if playersRed[i].name == '' then
          local isNewTeam = playerHistoryOnMatch("red", name)
          
          if isNewTeam then
            local playerTeams = playersOnGameHistoric[name].teams
            playersOnGameHistoric[name].teams[#playerTeams + 1] = "red"
            
            addMatchToPlayerFourTeamsMode(name)
          end
          playersRed[i].name = name
          playerInGame[name] = true
          tfm.exec.setNameColor(playersRed[i].name, 0xEF4444)
          if #playersSpawn800 > 0 then
            teleportPlayerWithSpecificSpawn(playersSpawn800, name)
          else
            tfm.exec.movePlayer(name, 600, 334)
          end
          
          disablePlayerCanTransform(name)
          
          return
        end
      end
    elseif smallQuantity[2] == 3 and quantity.blue < 3 then
      for i= 1, #playersBlue do
        if playersBlue[i].name == '' then
          local isNewTeam = playerHistoryOnMatch("blue", name)
          
          if isNewTeam then
            local playerTeams = playersOnGameHistoric[name].teams
            playersOnGameHistoric[name].teams[#playerTeams + 1] = "blue"
            
            addMatchToPlayerFourTeamsMode(name)
          end
          playersBlue[i].name = name
          playerInGame[name] = true
          tfm.exec.setNameColor(playersBlue[i].name, 0x3B82F6)
          if #playersSpawn1200 > 0 then
            teleportPlayerWithSpecificSpawn(playersSpawn1200, name)
          else
            tfm.exec.movePlayer(name, 1000, 334)
          end
          
          disablePlayerCanTransform(name)
          
          return
        end
      end
      
    elseif smallQuantity[2] == 4 and quantity.green < 3 then
      for i= 1, #playersGreen do
        if playersGreen[i].name == '' then
          local isNewTeam = playerHistoryOnMatch("green", name)
          
          if isNewTeam then
            local playerTeams = playersOnGameHistoric[name].teams
            playersOnGameHistoric[name].teams[#playerTeams + 1] = "green"
            
            addMatchToPlayerFourTeamsMode(name)
          end
          playersGreen[i].name = name
          playerInGame[name] = true
          tfm.exec.setNameColor(playersGreen[i].name, 0x109267)
          if #playersSpawn1600 > 0 then
            teleportPlayerWithSpecificSpawn(playersSpawn1600, name)
          else
            tfm.exec.movePlayer(name, 1400, 334)
          end
          
          disablePlayerCanTransform(name)
          
          return
        end
      end
    else
      tfm.exec.chatMessage("<bv>The teams are full<n>", name)
    end
  elseif gameStats.typeMap == "large3v3" or gameStats.typeMap == "small" then
    local x = {200, 600, 1000}
    local playersSpawn = { playersSpawn400, playersSpawn800, playersSpawn1200 }
    print("a")
    print(smallQuantity[2])
    for i = 1, #teamsPlayersOnGame do
      if i == smallQuantity[2] then
        for j = 1, #teamsPlayersOnGame[smallQuantity[2]] do
          if teamsPlayersOnGame[smallQuantity[2]][j].name == '' then
            local team = getTeamName(messageTeamsLifes[smallQuantity[2]])
            
            if team == "Yellow" then
              local isNewTeam = playerHistoryOnMatch("yellow", name)
              
              if isNewTeam then
                local playerTeams = playersOnGameHistoric[name].teams
                playersOnGameHistoric[name].teams[#playerTeams + 1] = "yellow"
                
                addMatchToPlayerFourTeamsMode(name)
              end
            elseif team == "Red" then
              local isNewTeam = playerHistoryOnMatch("red", name)
              
              if isNewTeam then
                local playerTeams = playersOnGameHistoric[name].teams
                playersOnGameHistoric[name].teams[#playerTeams + 1] = "red"
                
                addMatchToPlayerFourTeamsMode(name)
              end
            elseif team == "Blue" then
              local isNewTeam = playerHistoryOnMatch("blue", name)
              
              if isNewTeam then
                local playerTeams = playersOnGameHistoric[name].teams
                playersOnGameHistoric[name].teams[#playerTeams + 1] = "blue"
                
                addMatchToPlayerFourTeamsMode(name)
              end
            elseif team == "Green" then
              local isNewTeam = playerHistoryOnMatch("green", name)
              
              if isNewTeam then
                local playerTeams = playersOnGameHistoric[name].teams
                playersOnGameHistoric[name].teams[#playerTeams + 1] = "green"
                
                addMatchToPlayerFourTeamsMode(name)
              end
            end
            teamsPlayersOnGame[smallQuantity[2]][j].name = name
            playerInGame[name] = true
            tfm.exec.setNameColor(name, getTeamsColorsName[smallQuantity[2]])
            if #playersSpawn[smallQuantity[2]] > 0 then
              teleportPlayerWithSpecificSpawn(playersSpawn[smallQuantity[2]], name)
            else
              tfm.exec.movePlayer(name, x[smallQuantity[2]], 334)
            end
            
            disablePlayerCanTransform(name)
            
            return
          end
        end
      end
    end
  end
end


--[[ src/functions/game/join/chooseTeamThreeTeamsMode.lua ]]--

function chooseTeamThreeTeamsMode(name)
  local quantity = getQuantityPlayers()
  local smallQuantity = ""
  if gameStats.typeMap == "large4v4" then
    smallQuantity = getSmallQuantity(quantity)
  else
    smallQuantity = getSmallQuantity1(quantity)
  end
  if gameStats.typeMap == "large4v4" then
    if smallQuantity[2] == 1 and quantity.red < 4 then
      for i= 1, #playersRed do
        if playersRed[i].name == '' then
          local isNewTeam = playerHistoryOnMatch("red", name)
          
          if isNewTeam then
            local playerTeams = playersOnGameHistoric[name].teams
            playersOnGameHistoric[name].teams[#playerTeams + 1] = "red"
            
            addMatchToPlayerThreeTeamsMode(name)
          end
          playersRed[i].name = name
          playerInGame[name] = true
          tfm.exec.setNameColor(playersRed[i].name, 0xEF4444)
          if #playersSpawn400 > 0 then
            teleportPlayerWithSpecificSpawn(playersSpawn400, name)
          else
            tfm.exec.movePlayer(name, 300, 334)
          end
          
          disablePlayerCanTransform(name)
          
          return
        end
      end
    elseif smallQuantity[2] == 2 and quantity.blue < 4 then
      for i= 1, #playersBlue do
        if playersBlue[i].name == '' then
          local isNewTeam = playerHistoryOnMatch("blue", name)
          
          if isNewTeam then
            local playerTeams = playersOnGameHistoric[name].teams
            playersOnGameHistoric[name].teams[#playerTeams + 1] = "blue"
            
            addMatchToPlayerThreeTeamsMode(name)
          end
          playersBlue[i].name = name
          playerInGame[name] = true
          tfm.exec.setNameColor(playersBlue[i].name, 0x3B82F6)
          if #playersSpawn800 > 0 then
            teleportPlayerWithSpecificSpawn(playersSpawn800, name)
          else
            tfm.exec.movePlayer(name, 900, 334)
          end
          
          disablePlayerCanTransform(name)
          
          return
        end
      end
    elseif smallQuantity[2] == 3 and quantity.green < 4 then
      for i= 1, #playersGreen do
        if playersGreen[i].name == '' then
          local isNewTeam = playerHistoryOnMatch("green", name)
          
          if isNewTeam then
            local playerTeams = playersOnGameHistoric[name].teams
            playersOnGameHistoric[name].teams[#playerTeams + 1] = "green"
            
            addMatchToPlayerThreeTeamsMode(name)
          end
          playersGreen[i].name = name
          playerInGame[name] = true
          tfm.exec.setNameColor(playersGreen[i].name, 0x109267)
          if #playersSpawn1200 > 0 then
            teleportPlayerWithSpecificSpawn(playersSpawn1200, name)
          else
            tfm.exec.movePlayer(name, 1500, 334)
          end
          
          disablePlayerCanTransform(name)
          
          return
        end
      end
    else
      tfm.exec.chatMessage("<bv>The teams are full<n>", name)
    end
  elseif gameStats.typeMap == "large3v3" or gameStats.typeMap == "small" then
    local x = {200, 600, 1000}
    local playersSpawn = { playersSpawn400, playersSpawn800, playersSpawn1200 }

    if gameStats.threeTeamsMode then
      x = {300, 900}
      playersSpawn = { playersSpawn400, playersSpawn800 }
    end

    print("a")
    print(smallQuantity[2])
    for i = 1, #teamsPlayersOnGame do
      if i == smallQuantity[2] then
        for j = 1, #teamsPlayersOnGame[smallQuantity[2]] do
          if teamsPlayersOnGame[smallQuantity[2]][j].name == '' then
            local team = getTeamName(messageTeamsLifes[smallQuantity[2]])
            
            if team == "Red" then
              local isNewTeam = playerHistoryOnMatch("red", name)
              
              if isNewTeam then
                local playerTeams = playersOnGameHistoric[name].teams
                playersOnGameHistoric[name].teams[#playerTeams + 1] = "red"
                
                addMatchToPlayerThreeTeamsMode(name)
              end
            elseif team == "Blue" then
              local isNewTeam = playerHistoryOnMatch("blue", name)
              
              if isNewTeam then
                local playerTeams = playersOnGameHistoric[name].teams
                playersOnGameHistoric[name].teams[#playerTeams + 1] = "blue"
                
                addMatchToPlayerThreeTeamsMode(name)
              end
            elseif team == "Green" then
              local isNewTeam = playerHistoryOnMatch("green", name)
              
              if isNewTeam then
                local playerTeams = playersOnGameHistoric[name].teams
                playersOnGameHistoric[name].teams[#playerTeams + 1] = "green"
                
                addMatchToPlayerThreeTeamsMode(name)
              end
            end
            teamsPlayersOnGame[smallQuantity[2]][j].name = name
            playerInGame[name] = true
            tfm.exec.setNameColor(name, getTeamsColorsName[smallQuantity[2]])
            if #playersSpawn[smallQuantity[2]] > 0 then
              teleportPlayerWithSpecificSpawn(playersSpawn[smallQuantity[2]], name)
            else
              tfm.exec.movePlayer(name, x[smallQuantity[2]], 334)
            end
            
            disablePlayerCanTransform(name)
            
            return
          end
        end
      end
    end
  end
end


--[[ src/functions/game/leave/leaveConfigRealMode.lua ]]--

function leaveConfigRealMode(name)
  local quantity = quantityPlayers()

  local team = searchPlayerTeam(name)

  if team == "red" and gameStats.redServe then
    gameStats.aceRed = false
    if quantity.red >= 1 then
      tfm.exec.chatMessage("<ce>[System]: player who was going to serve has left, the system will choose another player to serve<n>", nil)
      ballOnGame = false
      gameStats.canTransform = false
      local delayTeleport = addTimer(function(i)
        if i == 1 then
          choosePlayerServe("red")
          teamServe("red")
        end
      end, 4000, 1, "delayTeleport")
      
      local delaySpawnBall = addTimer(function(i)
        if i == 1 then
          spawnBallRealMode("red")
        end
      end, 6000, 1, "delaySpawnBall")
    end
    
    return
  end

  if quantity.blue >= 1 and gameStats.blueServe then
    gameStats.aceBlue = false
    tfm.exec.chatMessage("<ce>[System]: player who was going to serve has left, the system will choose another player to serve<n>", nil)
    ballOnGame = false
    gameStats.canTransform = false
    local delayTeleport = addTimer(function(i)
      if i == 1 then
        choosePlayerServe("blue")
        teamServe("blue")
      end
    end, 4000, 1, "delayTeleport")
    
    local delaySpawnBall = addTimer(function(i)
      if i == 1 then
        spawnBallRealMode("blue")
      end
    end, 6000, 1, "delaySpawnBall")
  end
end


--[[ src/functions/game/leave/leaveTeam.lua ]]--

function leaveTeam(name)
  playerInGame[name] = false
  tfm.exec.setNameColor(name, 0xD1D5DB)
  for i = 1, #playersRed do
    if playersRed[i].name == name then
      playersRed[i].name = ''
      twoTeamsPlayerRedPosition[i] = ""
      removePlayerOnSpawnConfig(name)
      leaveConfigRealMode(name)
      if killSpecPermanent then
        tfm.exec.killPlayer(name)
      else
        tfm.exec.killPlayer(name)
        
        local movePlayer = addTimer(function(i)
          tfm.exec.respawnPlayer(name)
          
          teleportPlayersToSpecWithSpecificSpawn(name)
        end, 1000, 1, "movePlayer")
      end
    end
    if playersBlue[i].name == name then
      playersBlue[i].name = ''
      twoTeamsPlayerBluePosition[i] = ""
      removePlayerOnSpawnConfig(name)
      leaveConfigRealMode(name)
      if killSpecPermanent then
        tfm.exec.killPlayer(name)
      else
        tfm.exec.killPlayer(name)
        
        local movePlayer = addTimer(function(i)
          tfm.exec.respawnPlayer(name)
          
          teleportPlayersToSpecWithSpecificSpawn(name)
        end, 1000, 1, "movePlayer")
      end
    end
  end
end


--[[ src/functions/game/leave/leaveTeamTeamsMode.lua ]]--

function leaveTeamTeamsMode(name)
  playerInGame[name] = false
  tfm.exec.setNameColor(name, 0xD1D5DB)

  leaveTeamTeamsModeConfig(name)
end



--[[ src/functions/game/leave/leaveTeamTeamsModeConfig.lua ]]--

function leaveTeamTeamsModeConfig(name)
  local count = 0
  local index = 1

  if gameStats.typeMap == "large4v4" then
    if gameStats.teamsMode then
      for i= 1, #playersYellow do
        if playersYellow[i].name == name then
          playersYellow[i].name = ''
          tfm.exec.killPlayer(name)
          removePlayerOnSpawnConfig(name)
          
          local movePlayer = addTimer(function(i)
            tfm.exec.respawnPlayer(name)
            
            teleportPlayersToSpecWithSpecificSpawn(name)
          end, 1000, 1, "movePlayer")
        end
        
        if playersYellow[i].name ~= '' then
          count = count + 1
        end
      end
      if count == 0 then
        ballOnGame = false
        ballOnGame2 = false
        ball_id = nil
        ball_id2 = nil
        updateTwoBallOnGame()
        tfm.exec.chatMessage("<j>Yellow team lost all their lives<n>", nil)
        teamsLifes[1].yellow = 0
        toggleMapType()
        updateTeamsColors(1)
        gameStats.canTransform = false
        disablePlayersCanTransform(4000)
        delayToToggleMap = addTimer(function(i)
          if i == 1 then
            toggleMap()
          end
        end, 3000, 1, "delayToToggleMap")
        
        return
      end
    end
    
    count = 0
    
    for i= 1, #playersRed do
      if playersRed[i].name == name then
        playersRed[i].name = ''
        tfm.exec.killPlayer(name)
        removePlayerOnSpawnConfig(name)
        
        local movePlayer = addTimer(function(i)
          tfm.exec.respawnPlayer(name)
          teleportPlayersToSpecWithSpecificSpawn(name)
        end, 1000, 1, "movePlayer")
      end
      
      if playersRed[i].name ~= '' then
        count = count + 1
      end
    end
    
    if count == 0 then
      ballOnGame = false
      ballOnGame2 = false
      ball_id = nil
      ball_id2 = nil
      updateTwoBallOnGame()
      tfm.exec.chatMessage("<r>Red team lost all their lives<n>", nil)
      teamsLifes[2].red = 0
      toggleMapType()
      local index = 2

      if gameStats.threeTeamsMode then
        index = 1
      end

      updateTeamsColors(index)
      gameStats.canTransform = false
      disablePlayersCanTransform(4000)
      delayToToggleMap = addTimer(function(i)
        if i == 1 then
          toggleMap()
        end
      end, 3000, 1, "delayToToggleMap")
      return
    end
    
    count = 0
    
    for i= 1, #playersBlue do
      if playersBlue[i].name == name then
        playersBlue[i].name = ''
        tfm.exec.killPlayer(name)
        removePlayerOnSpawnConfig(name)
        
        local movePlayer = addTimer(function(i)
          tfm.exec.respawnPlayer(name)
          teleportPlayersToSpecWithSpecificSpawn(name)
        end, 1000, 1, "movePlayer")
      end
      
      if playersBlue[i].name ~= '' then
        count = count + 1
      end
    end
    
    if count == 0 then
      ballOnGame = false
      ballOnGame2 = false
      ball_id = nil
      ball_id2 = nil
      updateTwoBallOnGame()
      tfm.exec.chatMessage("<bv>Blue team lost all their lives<n>", nil)
      teamsLifes[3].blue = 0
      toggleMapType()

      local index = 3

      if gameStats.threeTeamsMode then
        index = 2
      end

      updateTeamsColors(index)
      gameStats.canTransform = false
      disablePlayersCanTransform(4000)
      delayToToggleMap = addTimer(function(i)
        if i == 1 then
          toggleMap()
        end
      end, 3000, 1, "delayToToggleMap")
      return
    end
    
    count = 0
    
    for i= 1, #playersGreen do
      if playersGreen[i].name == name then
        playersGreen[i].name = ''
        tfm.exec.killPlayer(name)
        removePlayerOnSpawnConfig(name)
        
        local movePlayer = addTimer(function(i)
          tfm.exec.respawnPlayer(name)
          teleportPlayersToSpecWithSpecificSpawn(name)
        end, 1000, 1, "movePlayer")
      end
      
      if playersGreen[i].name ~= '' then
        count = count + 1
      end
    end
    
    if count == 0 then
      ballOnGame = false
      ballOnGame2 = false
      ball_id = nil
      ball_id2 = nil
      updateTwoBallOnGame()
      tfm.exec.chatMessage("<vp>Green team lost all their lives<n>", nil)
      teamsLifes[4].green = 0
      toggleMapType()
      local index = 4

      if gameStats.threeTeamsMode then
        index = 3
      end

      updateTeamsColors(index)
      gameStats.canTransform = false
      disablePlayersCanTransform(4000)
      delayToToggleMap = addTimer(function(i)
        if i == 1 then
          toggleMap()
        end
      end, 3000, 1, "delayToToggleMap")
      return
    end
  elseif gameStats.typeMap == "large3v3" then
    for i = 1, #getTeamsLifes do
      for j = 1, #teamsPlayersOnGame[i] do
        if teamsPlayersOnGame[i][j].name == name then
          teamsPlayersOnGame[i][j].name = ''
          tfm.exec.killPlayer(name)
          removePlayerOnSpawnConfig(name)
          
          local movePlayer = addTimer(function(i)
            tfm.exec.respawnPlayer(name)
            teleportPlayersToSpecWithSpecificSpawn(name)
          end, 1000, 1, "movePlayer")
        end
        
        if teamsPlayersOnGame[i][j].name ~= '' then
          count = count + 1
        end
      end
      
      if count == 0 then
        if gameStats.threeTeamsMode then
          tfm.exec.chatMessage(messageTeamsLifes[index], nil)
          print(messageTeamsLifes[index])
          showTheScore()
          updateTeamsColors(index)
          showMessageWinner()
          ballOnGame = false
          ballOnGame2 = false
          ballOnGame3 = false
          ball_id = nil
          ball_id2 = nil
          ball_id3 = nil
          updateTwoBallOnGame()
          threeTeamsModeWinner(messageTeamsLifes[1], teamsPlayersOnGame[1])
          updateRankingThreeTeamsMode()
          tfm.exec.removeObject (ball_id)
          mode = "endGame"
          gameTimeEnd = os.time() + 5000
          return
        end

        ballOnGame = false
        ballOnGame2 = false
        ball_id = nil
        ball_id2 = nil
        updateTwoBallOnGame()
        tfm.exec.chatMessage(messageTeamsLifes[index], nil)
        print(messageTeamsLifes[index])
        updateTeamsColors(index)
        toggleMapType()
        gameStats.canTransform = false
        disablePlayersCanTransform(4000)
        delayToToggleMap = addTimer(function(i)
          if i == 1 then
            toggleMap()
          end
        end, 3000, 1, "delayToToggleMap")
        return
      end
      
      count = 0
      index = index + 1
    end
  elseif gameStats.typeMap == "small" then
    for i = 1, #getTeamsLifes do
      for j = 1, #teamsPlayersOnGame[i] do
        if teamsPlayersOnGame[i][j].name == name then
          teamsPlayersOnGame[i][j].name = ''
          tfm.exec.killPlayer(name)
          removePlayerOnSpawnConfig(name)
          
          local movePlayer = addTimer(function(i)
            tfm.exec.respawnPlayer(name)
            teleportPlayersToSpecWithSpecificSpawn(name)
          end, 1000, 1, "movePlayer")
        end
        
        if teamsPlayersOnGame[i][j].name ~= '' then
          count = count + 1
        end
      end
      
      if count == 0 then
        tfm.exec.chatMessage(messageTeamsLifes[index], nil)
        print(messageTeamsLifes[index])
        showTheScore()
        updateTeamsColors(index)
        showMessageWinner()
        ballOnGame = false
        ballOnGame2 = false
        ball_id = nil
        ball_id2 = nil
        updateTwoBallOnGame()
        fourTeamsModeWinner(messageTeamsLifes[1], teamsPlayersOnGame[1])
        updateRankingFourTeamsMode()
        tfm.exec.removeObject (ball_id)
        mode = "endGame"
        gameTimeEnd = os.time() + 5000
        return
      end
      
      count = 0
      index = index + 1
    end
  end
end


--[[ src/functions/game/miceSpawn/functionalitty/foundMicePlayersConfig.lua ]]--

function foundMicePlayersConfig(map)
  local mapXML = ""
  
  if #map > 10 then
    mapXML = map
  else
    mapXML = tfm.get.room.xmlMapInfo.xml
  end
  
  local pTag = string.match(mapXML, '<C><P%s+([^>]+)')
  
  if pTag then
    local playerForce = string.match(pTag, 'playerForce="([^"]+)"')
    
    if type(tonumber(playerForce)) == 'number' then
      gameStats.psyhicObjectForce = tonumber(playerForce)
    end
  end
end


--[[ src/functions/game/miceSpawn/functionalitty/foundMiceSpawnOnMap.lua ]]--

function foundMiceSpawnsOnMap(map, isLargeMap)
  lobbySpawn = {}
  playersSpawn400 = {}
  playersSpawn800 = {}
  playersSpawn1200 = {}
  playersSpawn1600 = {}
  
  local mapXML = ""
  
  if #map > 10 then
    mapXML = map
  else
    mapXML = tfm.get.room.xmlMapInfo.xml
  end
  
  for tag in string.gmatch(mapXML, '<T%s+.-/>') do
    local x = string.match(tag, 'X="([^"]+)"')
    local y = string.match(tag, 'Y="([^"]+)"')
    local spawn = string.match(tag, 'spawn="([^"]+)"')
    local lobby = string.match(tag, 'lobby="([^"]+)"')
    
    local xNumber = tonumber(x)
    local yNumber = tonumber(y)
    
    if spawn == nil then
      spawn = 99999
    end
    
    if lobby ~= nil then
      setConfigLobbySpawn(xNumber, yNumber)
    else
      setConfigPlayersSpawn(isLargeMap, xNumber, yNumber, tonumber(spawn))
    end
  end
  
  foundMicePlayersConfig(map)
  
  print('400: '..#playersSpawn400..'')
  print('800: '..#playersSpawn800..'')
  print('1200: '..#playersSpawn1200..'')
  print('1600: '..#playersSpawn1600..'')
end


--[[ src/functions/game/miceSpawn/functionalitty/removePlayerOnSpawnConfig.lua ]]--

function removePlayerOnSpawnConfig(name)
  for i = 1, #playersSpawn400 do
    for j = 1, #playersSpawn400[i].players do
      if playersSpawn400[i].players[j] == name then
        table.remove(playersSpawn400[i].players, j)
        
        return
      end
    end
  end

  for i = 1, #playersSpawn800 do
    for j = 1, #playersSpawn800[i].players do
      if playersSpawn800[i].players[j] == name then
        table.remove(playersSpawn800[i].players, j)
        
        return
      end
    end
  end

  for i = 1, #playersSpawn1200 do
    for j = 1, #playersSpawn1200[i].players do
      if playersSpawn1200[i].players[j] == name then
        table.remove(playersSpawn1200[i].players, j)
        
        return
      end
    end
  end

  for i = 1, #playersSpawn1600 do
    for j = 1, #playersSpawn1600[i].players do
      if playersSpawn1600[i].players[j] == name then
        table.remove(playersSpawn1600[i].players, j)
        
        return
      end
    end
  end
end


--[[ src/functions/game/miceSpawn/functionalitty/setConfigLobbySpawn.lua ]]--

function setConfigLobbySpawn(xNumber, yNumber)
  lobbySpawn[#lobbySpawn + 1] = { x = xNumber, y = yNumber }
end


--[[ src/functions/game/miceSpawn/functionalitty/setConfigPlayersSpawn.lua ]]--

function setConfigPlayersSpawn(isLargeMap, xNumber, yNumber, spawnPriority)
  if gameStats.threeTeamsMode then
    if xNumber >= 0 and xNumber <= 600 then
      playersSpawn400[#playersSpawn400 + 1] = { x = xNumber, y = yNumber, spawnPriority = spawnPriority, players = {} }
    end
    
    if xNumber >= 600 and xNumber <= 1200 then
      playersSpawn800[#playersSpawn800 + 1] = { x = xNumber, y = yNumber, spawnPriority = spawnPriority, players = {} }
    end
    
    if xNumber >= 1200 and xNumber <= 1800 then
      playersSpawn1200[#playersSpawn1200 + 1] = { x = xNumber, y = yNumber, spawnPriority = spawnPriority, players = {} }
    end
  else
    if isLargeMap then
      if xNumber >= 0 and xNumber <= 600 then
        playersSpawn800[#playersSpawn800 + 1] = { x = xNumber, y = yNumber, spawnPriority = spawnPriority, players = {}}
      end
      
      if xNumber >= 600 and xNumber <= 1200 then
        playersSpawn1600[#playersSpawn1600 + 1] = { x = xNumber , y = yNumber, spawnPriority = spawnPriority, players = {} }
      end
    else
      if xNumber >= 0 and xNumber <= 400 then
        playersSpawn400[#playersSpawn400 + 1] = { x = xNumber, y = yNumber, spawnPriority = spawnPriority, players = {} }
      end
      
      if xNumber >= 400 and xNumber <= 800 then
        playersSpawn800[#playersSpawn800 + 1] = { x = xNumber, y = yNumber, spawnPriority = spawnPriority, players = {} }
      end
      
      if xNumber >= 800 and xNumber <= 1200 then
        playersSpawn1200[#playersSpawn1200 + 1] = { x = xNumber, y = yNumber, spawnPriority = spawnPriority, players = {} }
      end
      
      if xNumber >= 1200 and xNumber <= 1600 then
        playersSpawn1600[#playersSpawn1600 + 1] = { x = xNumber, y = yNumber, spawnPriority = spawnPriority, players = {} }
      end
    end
  end
end


--[[ src/functions/game/miceSpawn/functionalitty/teleportPlayersToSpecWithSpecificSpawn.lua ]]--

function teleportPlayersToSpecWithSpecificSpawn(name)
  if #lobbySpawn > 0 then
    local index = math.random(1, #lobbySpawn)

    tfm.exec.movePlayer(name, lobbySpawn[index].x, lobbySpawn[index].y)
  else
    if gameStats.threeTeamsMode then
      if gameStats.typeMap == "large4v4" then
        tfm.exec.movePlayer(name, 900, 74)
      else
        tfm.exec.movePlayer(name, 600, 74)
      end
    else
      tfm.exec.movePlayer(name, 391, 74)
    end
  end
end


--[[ src/functions/game/miceSpawn/functionalitty/teleportPlayerWithSpecificSpawn.lua ]]--


function teleportPlayerWithSpecificSpawn(playersSpawn, name)
  local lowestPlayersQuantity
  local availableIndexesToSpawn = {}
  for i = 1, #playersSpawn do
    if lowestPlayersQuantity == nil then
      lowestPlayersQuantity = #playersSpawn[i].players
      availableIndexesToSpawn[#availableIndexesToSpawn + 1] = i
    else
      if #playersSpawn[i].players == lowestPlayersQuantity then
        availableIndexesToSpawn[#availableIndexesToSpawn + 1] = i
      elseif #playersSpawn[i].players < lowestPlayersQuantity then
        lowestPlayersQuantity = #playersSpawn[i].players
        availableIndexesToSpawn = {[1] = i}
      end
    end
  end

  if #availableIndexesToSpawn == 1 then
    local index = availableIndexesToSpawn[1]
    playersSpawn[index].players[#playersSpawn[index].players + 1] = name
    tfm.exec.movePlayer(name, playersSpawn[index].x, playersSpawn[index].y)
    
    return
  end

  local lowestSpawnPriority
  local indexSelected
  local foundDifference = false
  for i = 1, #availableIndexesToSpawn do
    local index = availableIndexesToSpawn[i]
    
    if lowestSpawnPriority == nil then
      lowestSpawnPriority = playersSpawn[index].spawnPriority
      indexSelected = index
    else
      if lowestSpawnPriority ~= playersSpawn[index].spawnPriority then
        foundDifference = true
      end
      
      if playersSpawn[index].spawnPriority < lowestSpawnPriority then
        lowestSpawnPriority = playersSpawn[index].spawnPriority
        indexSelected = index
      end
    end
  end

  if foundDifference then
    playersSpawn[indexSelected].players[#playersSpawn[indexSelected].players + 1] = name
    tfm.exec.movePlayer(name, playersSpawn[indexSelected].x, playersSpawn[indexSelected].y)
    
    return
  end

  local index = availableIndexesToSpawn[math.random(1, #availableIndexesToSpawn)]
  playersSpawn[index].players[#playersSpawn[index].players + 1] = name
  tfm.exec.movePlayer(name, playersSpawn[index].x, playersSpawn[index].y)
end


--[[ src/functions/game/miceSpawn/teleportPlayer.lua ]]--

function teleportPlayer(name, mode)
  local xRed = {[1] = 101}
  local xBlue = {[1] = 700}

  if gameStats.teamsMode then
    print("b")
    teleportPlayerOnTeamsMode(name)
    return
  end

  if mode == "4v4" then
    xRed = {[1] = 301}
    xBlue = {[1] = 900}
  elseif mode == "6v6" then
    xRed = {[1] = 401}
    xBlue = {[1] = 1500}
  end
  for i = 1, #playersRed do
    if playersRed[i].name == name then
      if gameStats.twoTeamsMode then
        if twoTeamsPlayerRedPosition[i] == "middle" then
          tfm.exec.movePlayer(name, 600, 334)
          return
        end
        tfm.exec.movePlayer(name, 1400, 334)
        return
      end
      if gameStats.realMode then
        tfm.exec.movePlayer(name, 900, 334)
        return
      end
      tfm.exec.movePlayer(name, xRed[1], 334)
    end
  end
  for i = 1, #playersBlue do
    if playersBlue[i].name == name then
      if gameStats.twoTeamsMode then
        if twoTeamsPlayerBluePosition[i] == "middle" then
          tfm.exec.movePlayer(name, 1000, 334)
          return
        end
        tfm.exec.movePlayer(name, 200, 334)
        return
      end
      if gameStats.realMode then
        tfm.exec.movePlayer(name, 1700, 334)
        return
      end
      tfm.exec.movePlayer(name, xBlue[1], 334)
    end
  end
end


--[[ src/functions/game/miceSpawn/teleportPlayers.lua ]]--

function teleportPlayers()
  teleportPlayersToSpec()

  if gameStats.twoTeamsMode then
    local spawnOnMiddle = true
    for i = 1, #playersRed do
      if playersRed[i].name ~= '' then
        playersOnGameHistoric[playersRed[i].name] = { teams = {"red"} }
        if spawnOnMiddle then
          if #playersSpawn800 > 0 then
            teleportPlayerWithSpecificSpawn(playersSpawn800, playersRed[i].name)
          else
            tfm.exec.movePlayer(playersRed[i].name, 600, 334)
          end
          
          tfm.exec.setNameColor(playersRed[i].name, 0xEF4444)
          twoTeamsPlayerRedPosition[i] = "middle"
          
          spawnOnMiddle = false
        else
          if #playersSpawn1600 > 0 then
            teleportPlayerWithSpecificSpawn(playersSpawn1600, playersRed[i].name)
          else
            tfm.exec.movePlayer(playersRed[i].name, 1400, 334)
          end
          
          tfm.exec.setNameColor(playersRed[i].name, 0xEF4444)
          
          twoTeamsPlayerRedPosition[i] = "back"
          
          spawnOnMiddle = true
        end
        
      end
      
    end
    
    local spawnOnMiddle = true
    for i = 1, #playersBlue do
      if playersBlue[i].name ~= '' then
        playersOnGameHistoric[playersBlue[i].name] = { teams = {"blue"} }
        if spawnOnMiddle then
          if #playersSpawn1200 > 0 then
            teleportPlayerWithSpecificSpawn(playersSpawn1200, playersBlue[i].name)
          else
            tfm.exec.movePlayer(playersBlue[i].name, 1000, 334)
          end
          tfm.exec.setNameColor(playersBlue[i].name, 0x3B82F6)
          twoTeamsPlayerBluePosition[i] = "middle"
          
          spawnOnMiddle = false
        else
          if #playersSpawn400 > 0 then
            teleportPlayerWithSpecificSpawn(playersSpawn400, playersBlue[i].name)
          else
            tfm.exec.movePlayer(playersBlue[i].name, 200, 334)
          end
          
          tfm.exec.setNameColor(playersBlue[i].name, 0x3B82F6)
          twoTeamsPlayerBluePosition[i] = "back"
          
          spawnOnMiddle = true
        end
      end
      
    end
    
    return
  end

  if gameStats.teamsMode then
    for i = 1, #playersYellow do
      if playersYellow[i].name ~= '' then
        playersOnGameHistoric[playersYellow[i].name] = { teams = {"yellow"} }
        if #playersSpawn400 > 0 then
          teleportPlayerWithSpecificSpawn(playersSpawn400, playersYellow[i].name)
        else
          tfm.exec.movePlayer(playersYellow[i].name, 200, 334)
        end
        
        tfm.exec.setNameColor(playersYellow[i].name, 0xF59E0B)
      end
    end
    for i = 1, #playersRed do
      if playersRed[i].name ~= '' then
        playersOnGameHistoric[playersRed[i].name] = { teams = {"red"} }
        if #playersSpawn800 > 0 then
          teleportPlayerWithSpecificSpawn(playersSpawn800, playersRed[i].name)
        else
          tfm.exec.movePlayer(playersRed[i].name, 600, 334)
        end
        
        tfm.exec.setNameColor(playersRed[i].name, 0xEF4444)
      end
    end
    for i = 1, #playersBlue do
      if playersBlue[i].name ~= '' then
        playersOnGameHistoric[playersBlue[i].name] = { teams = {"blue"} }
        if #playersSpawn1200 > 0 then
          teleportPlayerWithSpecificSpawn(playersSpawn1200, playersBlue[i].name)
        else
          tfm.exec.movePlayer(playersBlue[i].name, 1000, 334)
        end
        
        tfm.exec.setNameColor(playersBlue[i].name, 0x3B82F6)
      end
    end
    for i = 1, #playersGreen do
      if playersGreen[i].name ~= '' then
        playersOnGameHistoric[playersGreen[i].name] = { teams = {"green"} }
        if #playersSpawn1600 > 0 then
          teleportPlayerWithSpecificSpawn(playersSpawn1600, playersGreen[i].name)
        else
          tfm.exec.movePlayer(playersGreen[i].name, 1400, 334)
        end
        
        tfm.exec.setNameColor(playersGreen[i].name, 0x109267)
      end
    end
    
    return
  end

  if gameStats.threeTeamsMode then
    for i = 1, #playersRed do
      if playersRed[i].name ~= '' then
        playersOnGameHistoric[playersRed[i].name] = { teams = {"red"} }
        if #playersSpawn400 > 0 then
          teleportPlayerWithSpecificSpawn(playersSpawn400, playersRed[i].name)
        else
          tfm.exec.movePlayer(playersRed[i].name, 300, 334)
        end
        
        tfm.exec.setNameColor(playersRed[i].name, 0xEF4444)
      end
    end

    for i = 1, #playersBlue do
      if playersBlue[i].name ~= '' then
        playersOnGameHistoric[playersBlue[i].name] = { teams = {"blue"} }
        if #playersSpawn800 > 0 then
          teleportPlayerWithSpecificSpawn(playersSpawn800, playersBlue[i].name)
        else
          tfm.exec.movePlayer(playersBlue[i].name, 900, 334)
        end
        
        tfm.exec.setNameColor(playersBlue[i].name, 0x3B82F6)
      end
    end

    for i = 1, #playersGreen do
      if playersGreen[i].name ~= '' then
        playersOnGameHistoric[playersGreen[i].name] = { teams = {"green"} }
        if #playersSpawn1200 > 0 then
          teleportPlayerWithSpecificSpawn(playersSpawn1200, playersGreen[i].name)
        else
          tfm.exec.movePlayer(playersGreen[i].name, 1500, 334)
        end
        
        tfm.exec.setNameColor(playersGreen[i].name, 0x109267)
      end
    end

    return
  end

  for i = 1, #playersRed do
    if playersRed[i].name ~= '' then
      playersOnGameHistoric[playersRed[i].name] = { teams = {"red"} }
      
      if gameStats.realMode then
        tfm.exec.movePlayer(playersRed[i].name, 900, 334)
      else
        if gameStats.gameMode == "3v3" then
          if #playersSpawn400 > 0 then
            teleportPlayerWithSpecificSpawn(playersSpawn400, playersRed[i].name)
          else
            tfm.exec.movePlayer(playersRed[i].name, 101, 334)
          end
        elseif gameStats.gameMode == "4v4" then
          if #playersSpawn800 > 0 then
            teleportPlayerWithSpecificSpawn(playersSpawn800, playersRed[i].name)
          else
            tfm.exec.movePlayer(playersRed[i].name, 301, 334)
          end
        else
          tfm.exec.movePlayer(playersRed[i].name, 401, 334)
        end
      end
      
      
      tfm.exec.setNameColor(playersRed[i].name, 0xEF4444)
    end
  end
  for i = 1, #playersBlue do
    if playersBlue[i].name ~= '' then
      playersOnGameHistoric[playersBlue[i].name] = { teams = {"blue"} }
      if gameStats.realMode then
        tfm.exec.movePlayer(playersBlue[i].name, 1700, 334)
      else
        if gameStats.gameMode == "3v3" then
          if #playersSpawn800 > 0 then
            teleportPlayerWithSpecificSpawn(playersSpawn800, playersBlue[i].name)
          else
            tfm.exec.movePlayer(playersBlue[i].name, 700, 334)
          end
        elseif gameStats.gameMode == "4v4" then
          if #playersSpawn1600 > 0 then
            teleportPlayerWithSpecificSpawn(playersSpawn1600, playersBlue[i].name)
          else
            tfm.exec.movePlayer(playersBlue[i].name, 900, 334)
          end
        else
          tfm.exec.movePlayer(playersBlue[i].name, 1500, 334)
        end
        tfm.exec.setNameColor(playersBlue[i].name, 0x3B82F6)
      end
    end
  end
end



--[[ src/functions/game/miceSpawn/teleportPlayersOnTeamsMode.lua ]]--

function teleportPlayerOnTeamsMode(name)
  local x = {[1] = 200, [2] = 600, [3] = 1000}

  if gameStats.typeMap == "large4v4" then
    for i= 1, #playersYellow do
      if playersYellow[i].name == name then
        tfm.exec.movePlayer(name, 200, 334)
        
        return
      end
    end
    for i= 1, #playersRed do
      if playersRed[i].name == name then
        tfm.exec.movePlayer(name, 600, 334)
        
        return
      end
    end
    for i= 1, #playersBlue do
      if playersBlue[i].name == name then
        tfm.exec.movePlayer(name, 1000, 334)
        
        return
      end
    end
    
    for i= 1, #playersGreen do
      if playersGreen[i].name == name then
        tfm.exec.movePlayer(name, 1400, 334)
        
        return
      end
    end
  else
    for i = 1, #teamsPlayersOnGame do
      for j = 1, #teamsPlayersOnGame[i] do
        if teamsPlayersOnGame[i][j].name == name then
          print(x[i])
          tfm.exec.movePlayer(name, x[i], 334)
          return
        end
      end
    end
  end
end


--[[ src/functions/game/miceSpawn/teleportPlayersToSpec.lua ]]--

function teleportPlayersToSpec()
  for name, data in pairs(tfm.get.room.playerList) do
    if playerInGame[name] == false then
      print(killSpecPermanent)
      if killSpecPermanent then
        tfm.exec.killPlayer(name)
      else
        teleportPlayersToSpecWithSpecificSpawn(name)
      end
    end
  end
end


--[[ src/functions/game/miceSpawn/teleportPlayersWithTypeMap.lua ]]--

function teleportPlayersWithTypeMap(islargeMode)
  teleportPlayersToSpec()

  local sideToTeleport = {}
  local teleportX = {}
  local teamsToTeleport = {teamsLifes[1].yellow, teamsLifes[2].red, teamsLifes[3].blue, teamsLifes[4].green}
  local teamsPlayers = {playersYellow, playersRed, playersBlue, playersGreen}
  local teamsColors = {0xF59E0B, 0xEF4444, 0x3B82F6, 0x109267}
  local spawnTeleport = { playersSpawn400, playersSpawn800, playersSpawn1200 }

  if islargeMode then
    sideToTeleport = { true, true, true }
    if gameStats.threeTeamsMode then
      teleportX = { 300, 900 }
    else
      teleportX = { 200, 600, 1000 }
    end
    
    messageTeamsLifes = {}
    messageTeamsLostOneLife = {}
    messageTeamsLifesTextChat = {}
    messageWinners = {}
  else
    teamsPlayers = {}
    sideToTeleport = { true, true }
    teleportX = { 200, 600 }
    teamsToTeleport = {getTeamsLifes[1], getTeamsLifes[2]}
    for i = 1, #teamsPlayersOnGame do
      teamsPlayers[#teamsPlayers + 1] = teamsPlayersOnGame[i]
    end
  end

  local teamsColorsText = {"<j>", "<r>", "<bv>", "<vp>"}
  local mapCoords = {gameStats.yellowX, gameStats.redX, gameStats.blueX, gameStats.greenX}
  local mapCoordsX = {399, 799, 801}
  local messageLostAllLifes = {"<j>Yellow team lost all their lives<n>", "<r>Red team lost all their lives<n>", "<bv>Blue team lost all their lives<n>", "<vp>Green team lost all their lives<n>"}
  local messageLostOneLife = {"<j>Yellow team lost a life<n>", "<r>Red team lost a life<n>", "<bv>Blue team lost a life<n>", "<vp>Green team lost a life<n>"}
  local messageTeamsLifesText = {"<j>Team Yellow<n>", "<r>Team Red<n>", "<bv>Team Blue<n>", "<vp>Team Green<n>"}
  local messageWinnersText = {"<j>Team Yellow won!<n>", "<r>Team Red won!<n>", "<bv>Team Blue won!<n>", "<vp>Team Green won!<n>"}

  if gameStats.threeTeamsMode then
    teamsToTeleport = {teamsLifes[2].red, teamsLifes[3].blue, teamsLifes[4].green}
    teamsPlayers = {playersRed, playersBlue, playersGreen}
    teamsColors = {0xEF4444, 0x3B82F6, 0x109267}
    spawnTeleport = {playersSpawn400, playersSpawn800 }

    teamsColorsText = {"<r>", "<bv>", "<vp>"}
    mapCoords = {gameStats.redX, gameStats.blueX, gameStats.greenX}
    mapCoordsX = {599, 601}
    messageLostAllLifes = {"<r>Red team lost all their lives<n>", "<bv>Blue team lost all their lives<n>", "<vp>Green team lost all their lives<n>"}
    messageLostOneLife = {"<r>Red team lost a life<n>", "<bv>Blue team lost a life<n>", "<vp>Green team lost a life<n>"}
    messageTeamsLifesText = {"<r>Team Red<n>", "<bv>Team Blue<n>", "<vp>Team Green<n>"}
    messageWinnersText = {"<r>Team Red won!<n>", "<bv>Team Blue won!<n>", "<vp>Team Green won!<n>"}
  end

  mapCoordsTeams = {}
  getTeamsLifes = {}

  if gameStats.typeMap == "large3v3" or gameStats.typeMap == "small" then
    for i = 1, #teamsToTeleport do
      if teamsToTeleport[i] >= 1 then
        if gameStats.typeMap == "large3v3" then
          teamsPlayersOnGame[#teamsPlayersOnGame + 1] = teamsPlayers[i]
          getTeamsColors[#getTeamsColors + 1] = teamsColorsText[i]
          messageTeamsLifes[#messageTeamsLifes + 1] = messageLostAllLifes[i]
          messageTeamsLostOneLife[#messageTeamsLostOneLife + 1] = messageLostOneLife[i]
          messageTeamsLifesTextChat[#messageTeamsLifesTextChat + 1] = messageTeamsLifesText[i]
          messageWinners[#messageWinners + 1] = messageWinnersText[i]
        end
        getTeamsLifes[#getTeamsLifes + 1] = teamsToTeleport[i]
        for j = 1, #sideToTeleport do
          mapCoords[i] = mapCoordsX[j]
          mapCoordsTeams[#mapCoordsTeams + 1] = mapCoords[i]
          if sideToTeleport[j] then
            sideToTeleport[j] = false
            for h = 1, #teamsPlayers[i] do
              if teamsPlayers[i][h].name ~= '' then
                if #spawnTeleport[j] > 0 then
                  teleportPlayerWithSpecificSpawn(spawnTeleport[j], teamsPlayers[i][h].name)
                else
                  tfm.exec.movePlayer(teamsPlayers[i][h].name, teleportX[j], 334)
                end
                
                if gameStats.typeMap == "large3v3" then
                  tfm.exec.setNameColor(teamsPlayers[i][h].name, teamsColors[i])
                else
                  tfm.exec.setNameColor(teamsPlayers[i][h].name, getTeamsColorsName[i])
                end
                
              end
            end
            break
          end
        end
      end
    end
  end
end


--[[ src/functions/game/miceTransform/disablePlayerCanTransform.lua ]]--

function disablePlayerCanTransform(name)
  playerCanTransform[name] = false
  playersCanTransform = addTimer(function(i)
    if i == 1 then
      playerCanTransform[name] = true
    end
  end, 2000, 1, "playersCanTransform")
end


--[[ src/functions/game/miceTransform/disablePlayersCanTransform.lua ]]--

function disablePlayersCanTransform(time)
  playersCanTransform = addTimer(function(i)
    if i == 1 then
      gameStats.canTransform = true
    end
  end, time, 1, "playersCanTransform")
end


--[[ src/functions/game/realMode/chooseInitialPlayer.lua ]]--

function chooseInitialPlayer()
  local teams = {"red", "blue"}

  local chooseTeam = teams[math.random(1, #teams)]

  if chooseTeam == "red" then
    gameStats.redServeIndex = math.random(1, 6)
    if gameStats.redServeIndex == 6 then
      for i = 1, 6 do
        if playersRed[i].name ~= "" then
          gameStats.redServeIndex = i
          gameStats.redPlayerServe = playersRed[i].name
          gameStats.redServe = true
          tfm.exec.movePlayer(playersRed[i].name, 700, 334)
          tfm.exec.chatMessage("<bv>"..playersRed[i].name.." will serve the ball<n>", nil)
          print("<bv>"..playersRed[i].name.." will serve the ball<n>")
          return chooseTeam
        end
      end
    else
      for i = gameStats.redServeIndex, 6 do
        if playersRed[i].name ~= "" and gameStats.redServeIndex ~= i then
          gameStats.redServeIndex = i
          gameStats.redPlayerServe = playersRed[i].name
          gameStats.redServe = true
          tfm.exec.movePlayer(playersRed[i].name, 700, 334)
          tfm.exec.chatMessage("<bv>"..playersRed[i].name.." will serve the ball<n>", nil)
          print("<bv>"..playersRed[i].name.." will serve the ball<n>")
          return chooseTeam
        end
      end

      for i = 1, gameStats.redServeIndex do
        if playersRed[i].name ~= "" then
          gameStats.redServeIndex = i
          gameStats.redPlayerServe = playersRed[i].name
          gameStats.redServe = true
          tfm.exec.movePlayer(playersRed[i].name, 700, 334)
          tfm.exec.chatMessage("<bv>"..playersRed[i].name.." will serve the ball<n>", nil)
          print("<bv>"..playersRed[i].name.." will serve the ball<n>")
          return chooseTeam
        end
      end
    end
    gameStats.redServe = true
  elseif chooseTeam == "blue" then
    gameStats.blueServeIndex = math.random(1, 6)
    if gameStats.blueServeIndex == 6 then
      for i = 1, 6 do
        if playersBlue[i].name ~= "" then
          gameStats.blueServeIndex = i
          gameStats.bluePlayerServe = playersBlue[i].name
          gameStats.blueServe = true
          tfm.exec.movePlayer(playersBlue[i], name, 1900, 334)
          tfm.exec.chatMessage("<bv>"..playersBlue[i].name.." will serve the ball<n>", nil)
          print("<bv>"..playersBlue[i].name.." will serve the ball<n>")
          return chooseTeam
        end
      end
    else
      for i = gameStats.blueServeIndex, 6 do
        if playersBlue[i].name ~= "" and gameStats.blueServeIndex ~= i then
          gameStats.blueServeIndex = i
          gameStats.bluePlayerServe = playersBlue[i].name
          gameStats.blueServe = true
          tfm.exec.movePlayer(playersBlue[i].name, 1900, 334)
          tfm.exec.chatMessage("<bv>"..playersBlue[i].name.." will serve the ball<n>", nil)
          print("<bv>"..playersBlue[i].name.." will serve the ball<n>")
          return chooseTeam
        end
      end

      for i = 1, gameStats.redServeIndex do
        if playersBlue[i].name ~= "" and gameStats.blueServeIndex ~= i then
          gameStats.blueServeIndex = i
          gameStats.bluePlayerServe = playersBlue[i].name
          gameStats.blueServe = true
          tfm.exec.movePlayer(playersBlue[i].name, 1900, 334)
          tfm.exec.chatMessage("<bv>"..playersBlue[i].name.." will serve the ball<n>", nil)
          print("<bv>"..playersBlue[i].name.." will serve the ball<n>")
          return chooseTeam
        end
      end
    end
    gameStats.blueServe = true
  end

  return chooseTeam

end


--[[ src/functions/game/realMode/choosePlayerServe.lua ]]--

function choosePlayerServe(team)
  print(team)
  gameStats.redServe = false
  gameStats.blueServe = false
  gameStats.lastPlayerRed = ""
  gameStats.lastPlayerBlue = ""

  if gameStats.aceRed then
    tfm.exec.movePlayer(gameStats.redPlayerServe, 700, 334)
    tfm.exec.chatMessage("<bv>"..gameStats.redPlayerServe.." will serve the ball<n>", nil)
    print("red condition ace")
    print("<bv>"..gameStats.redPlayerServe.." will serve the ball<n>")
    return chooseTeam
  end

  if gameStats.aceBlue then
    tfm.exec.movePlayer(gameStats.bluePlayerServe, 1900, 334)
    tfm.exec.chatMessage("<bv>"..gameStats.bluePlayerServe.." will serve the ball<n>", nil)
    print("blue condition ace")
    print("<bv>"..gameStats.bluePlayerServe.." will serve the ball<n>")
    return chooseTeam
  end


  if team == "red" then
    if gameStats.redServeIndex == 6 then
      for i = 1, 6 do
        if playersRed[i].name ~= "" then
          gameStats.redServeIndex = i
          gameStats.redPlayerServe = playersRed[i].name
          gameStats.redServe = true
          gameStats.aceRed = true
          tfm.exec.movePlayer(playersRed[i].name, 700, 334)
          tfm.exec.chatMessage("<bv>"..playersRed[i].name.." will serve the ball<n>", nil)
          print("<bv>"..playersRed[i].name.." will serve the ball<n>")
          return chooseTeam
        end
      end
    else
      for i = gameStats.redServeIndex, 6 do
        if playersRed[i].name ~= "" and gameStats.redServeIndex ~= i then
          gameStats.redServeIndex = i
          gameStats.redPlayerServe = playersRed[i].name
          gameStats.redServe = true
          gameStats.aceRed = true
          tfm.exec.movePlayer(playersRed[i].name, 700, 334)
          tfm.exec.chatMessage("<bv>"..playersRed[i].name.." will serve the ball<n>", nil)
          print("<bv>"..playersRed[i].name.." will serve the ball<n>")
          return chooseTeam
        end
      end

      for i = 1, gameStats.redServeIndex do
        if playersRed[i].name ~= "" then
          gameStats.redServeIndex = i
          gameStats.redPlayerServe = playersRed[i].name
          gameStats.redServe = true
          gameStats.aceRed = true
          tfm.exec.movePlayer(playersRed[i].name, 700, 334)
          tfm.exec.chatMessage("<bv>"..playersRed[i].name.." will serve the ball<n>", nil)
          print("<bv>"..playersRed[i].name.." will serve the ball<n>")
          return chooseTeam
        end
      end
    end
    gameStats.redServe = true
    gameStats.aceRed = true
  elseif team == "blue" then
    if gameStats.blueServeIndex == 6 then
      for i = 1, 6 do
        if playersBlue[i].name ~= "" then
          gameStats.blueServeIndex = i
          gameStats.bluePlayerServe = playersBlue[i].name
          gameStats.blueServe = true
          gameStats.aceBlue = true
          tfm.exec.movePlayer(playersBlue[i].name, 1900, 334)
          tfm.exec.chatMessage("<bv>"..playersBlue[i].name.." will serve the ball<n>", nil)
          print("<bv>"..playersBlue[i].name.." will serve the ball<n>")
          return chooseTeam
        end
      end
    else
      for i = gameStats.blueServeIndex, 6 do
        if playersBlue[i].name ~= "" and gameStats.blueServeIndex ~= i then
          gameStats.blueServeIndex = i
          gameStats.bluePlayerServe = playersBlue[i].name
          gameStats.blueServe = true
          gameStats.aceBlue = true
          tfm.exec.movePlayer(playersBlue[i].name, 1900, 334)
          tfm.exec.chatMessage("<bv>"..playersBlue[i].name.." will serve the ball<n>", nil)
          print("<bv>"..playersBlue[i].name.." will serve the ball<n>")
          return chooseTeam
        end
      end

      for i = 1, gameStats.blueServeIndex do
        if playersBlue[i].name ~= "" then
          gameStats.blueServeIndex = i
          gameStats.bluePlayerServe = playersBlue[i].name
          gameStats.blueServe = true
          gameStats.aceBlue = true
          tfm.exec.movePlayer(playersBlue[i].name, 1900, 334)
          tfm.exec.chatMessage("<bv>"..playersBlue[i].name.." will serve the ball<n>", nil)
          print("<bv>"..playersBlue[i].name.." will serve the ball<n>")
          return chooseTeam
        end
      end
    end

    gameStats.blueServe = true
    gameStats.aceBlue = true
  end
end


--[[ src/functions/game/realMode/playerNearOfTheBall.lua ]]--

function playerNearOfTheBall(name, x, y)
  if ballOnGame then
    resetQuantityTeams()
    local ballX = tfm.get.room.objectList[ball_id].x + tfm.get.room.objectList[ball_id].vx
    local ballY = tfm.get.room.objectList[ball_id].y + tfm.get.room.objectList[ball_id].vy
    
    if (ballX + 15) >= 1250 and (ballX - 15) <= 1350 and x >= 1250 and x <= 1350 and ballY <= 297 then
      local team = searchPlayerTeam(name)
      
      if team == "red" then
        gameStats.lastPlayerRed = name
        gameStats.blueQuantitySpawn = 0
        if gameStats.blueServe then
          gameStats.blueLimitSpawn = 1
        else
          gameStats.blueLimitSpawn = 3
        end
      elseif team == "blue" then
        gameStats.lastPlayerBlue = name
        gameStats.redQuantitySpawn = 0
        if gameStats.redServe then
          gameStats.redLimitSpawn = 1
        else
          gameStats.redLimitSpawn = 3
        end
      end
    end
    
    showTheScore()
  end
end


--[[ src/functions/game/realMode/resetQuantityTeams.lua ]]--

function resetQuantityTeams()
  if ballOnGame then
    local ballX = tfm.get.room.objectList[ball_id].x + tfm.get.room.objectList[ball_id].vx
    print("<br>normal:"..ballX.."<br><r>red:"..(ballX + 300).."<n><br><bv>blue:"..(ballX - 300).."<n>")
    
    if (ballX + 100) >= 1299 then
      print("caiu no red")
      gameStats.redQuantitySpawn = 0
      gameStats.lastPlayerRed = ""
      if gameStats.redServe then
        gameStats.redLimitSpawn = 1
      else
        gameStats.redLimitSpawn = 3
      end
    end
    if (ballX - 100) <= 1301 then
      print("caiu no blue")
      gameStats.lastPlayerBlue = ""
      gameStats.blueQuantitySpawn = 0
      if gameStats.blueServe then
        gameStats.blueLimitSpawn = 1
      else
        gameStats.blueLimitSpawn = 3
      end
    end
    
    showTheScore()
  end
end


--[[ src/functions/game/realMode/searchPlayerTeam.lua ]]--

function searchPlayerTeam(name)
  local team = ""

  for i = 1, #playersRed do
    if playersRed[i].name == name then
      team = "red"
      
      return team
    end
  end

  for i = 1, #playersBlue do
    if playersBlue[i].name == name then
      team = "blue"
      
      return team
    end
  end
end


--[[ src/functions/game/realMode/teamServe.lua ]]--

function teamServe(team)
  gameStats.redQuantitySpawn = 0
  gameStats.blueQuantitySpawn = 0
  if team == "red" then
    gameStats.redLimitSpawn = 1
    gameStats.blueLimitSpawn = 3
    showTheScore()
    return
  end

  gameStats.redLimitSpawn = 3
  gameStats.blueLimitSpawn = 1
  showTheScore()
end


--[[ src/functions/game/realMode/verifyPlayerTeam.lua ]]--

function verifyPlayerTeam(name)
  if playerOutOfCourt[name] then
    return
  end

  for i = 1, #playersRed do
    if playersRed[i].name == name then
      if gameStats.redQuantitySpawn == gameStats.redLimitSpawn then
        return false
      end
      if gameStats.redQuantitySpawn < gameStats.redLimitSpawn then
        if gameStats.redLimitSpawn == 1 and name ~= gameStats.redPlayerServe and gameStats.lastPlayerRed == name then
          return false
        end
        gameStats.redQuantitySpawn = gameStats.redQuantitySpawn + 1
        gameStats.lastPlayerRed = name
        showTheScore()
        
        return true
      end
    end
  end

  for i = 1, #playersBlue do
    if playersBlue[i].name == name then
      if gameStats.blueQuantitySpawn == gameStats.blueLimitSpawn then
        return false
      end
      
      if gameStats.blueQuantitySpawn < gameStats.blueLimitSpawn then
        if gameStats.blueLimitSpawn == 1 and name ~= gameStats.bluePlayerServe and gameStats.lastPlayerBlue == name then
          return false
        end
        
        gameStats.blueQuantitySpawn = gameStats.blueQuantitySpawn + 1
        gameStats.lastPlayerBlue = name
        showTheScore()
        
        return true
      end
    end
  end
end


--[[ src/functions/game/selectMap.lua ]]--

function selectMap()
  local maps = {
    [1] = customMaps[6][1],
    [2] = customMaps[6][2],
    [3] = '<C><P L="1800" F="0" G="0,4" MEDATA="13,1;;;;-0;0:::1-"/><Z><S><S T="7" X="900" Y="400" L="1800" H="100" P="0,0,0.1,0.2,0,0,0,0" c="3" N=""/><S T="9" X="600" Y="430" L="1200" H="10" P="0,0,0,0,0,0,0,0"/><S T="1" X="901" Y="350" L="10" H="200" P="0,0,0,0.2,0,0,0,0"/><S T="12" X="400" Y="455" L="800" H="10" P="0,0,0.3,0.2,0,0,0,0" o="6a7495"/><S T="12" X="-10" Y="200" L="20" H="2000" P="0,0,0.2,0,0,0,0,0" o="FF0000" m=""/><S T="12" X="1810" Y="200" L="20" H="2000" P="0,0,0.2,0,0,0,0,0" o="FF0000" m=""/><S T="13" X="300" Y="359" L="10" P="0,0,0,0,0,0,0,0" o="324650" c="4"/><S T="13" X="1500" Y="359" L="10" P="0,0,0,0,0,0,0,0" o="324650" c="4"/><S T="12" X="250" Y="45" L="100" H="105" P="0,0,0.3,0.2,0,0,0,0" o="324650" c="4"/><S T="1" X="900" Y="-5" L="1800" H="10" P="0,0,0,0.2,0,0,0,0" c="3"/><S T="12" X="900" Y="95" L="1800" H="10" P="0,0,0.3,0.2,0,0,0,0" o="FFF200" c="3" m=""/><S T="12" X="305" Y="48" L="10" H="100" P="0,0,0.3,0.2,0,0,0,0" o="FFF200" c="3" m=""/><S T="12" X="1495" Y="48" L="10" H="100" P="0,0,0.3,0.2,0,0,0,0" o="FFF200" c="3" m=""/><S T="12" X="900" Y="225" L="1800" H="10" P="0,0,0.3,0.2,0,0,0,0" o="FFF200" c="3" m=""/><S T="12" X="900" Y="240" L="10" H="40" P="0,0,0,0,0,0,0,0" o="FFF200" c="3" m=""/><S T="12" X="900" Y="791" L="800" H="10" P="0,0,0.3,0.2,90,0,0,0" o="FF0000" m=""/><S T="12" X="316" Y="-129" L="20" H="200" P="0,0,0.2,0.2,0,0,0,0" o="6a7495" c="3"/><S T="12" X="407" Y="-133" L="20" H="200" P="0,0,0.2,0.2,0,0,0,0" o="6a7495" c="3"/><S T="12" X="363" Y="-92" L="20" H="100" P="0,0,0.2,0.2,90,0,0,0" o="6a7495" c="3"/><S T="12" X="360" Y="-206" L="20" H="100" P="0,0,0.2,0.2,90,0,0,0" o="6a7495" c="3"/><S T="12" X="900" Y="460" L="2600" H="120" P="0,0,0.3,0.2,0,0,0,0" o="6a7495" c="4" N=""/><S T="12" X="1550" Y="45" L="100" H="105" P="0,0,0.3,0.2,0,0,0,0" o="324650" c="4"/><S T="12" X="900" Y="-800" L="1840" H="20" P="0,0,0,0.2,0,0,0,0" o="FF0000" m=""/><S T="12" X="900" Y="1190" L="1840" H="20" P="0,0,0,0.2,0,0,0,0" o="FF0000" m=""/></S><D><P X="1499" Y="365" T="10" P="1,0"/><P X="299" Y="365" T="10" P="1,0"/><DS X="365" Y="-141"/></D><O/><L/></Z></C>'
  }

  if gameStats.realMode then
    tfm.exec.newGame('<C><P L="2600" F="0" G="0,4" MEDATA=";0,1;;;-0;0:::1-"/><Z><S><S T="7" X="1300" Y="400" L="2600" H="100" P="0,0,0.1,0.2,0,0,0,0" c="3" N=""/><S T="9" X="600" Y="430" L="1200" H="10" P="0,0,0,0,0,0,0,0"/><S T="1" X="1300" Y="350" L="10" H="200" P="0,0,0,0.2,0,0,0,0"/><S T="12" X="400" Y="455" L="800" H="10" P="0,0,0.3,0.2,0,0,0,0" o="6a7495"/><S T="12" X="-10" Y="200" L="20" H="2000" P="0,0,0.2,0,0,0,0,0" o="FF0000" m=""/><S T="12" X="2610" Y="200" L="20" H="2000" P="0,0,0.2,0,0,0,0,0" o="FF0000" m=""/><S T="13" X="700" Y="359" L="10" P="0,0,0,0,0,0,0,0" o="324650" c="4"/><S T="13" X="1900" Y="359" L="10" P="0,0,0,0,0,0,0,0" o="324650" c="4"/><S T="1" X="1300" Y="-5" L="2600" H="10" P="0,0,0,0.2,0,0,0,0" c="3"/><S T="12" X="1300" Y="95" L="2600" H="10" P="0,0,0.3,0.2,0,0,0,0" o="FFF200" c="3" m=""/><S T="12" X="305" Y="48" L="10" H="100" P="0,0,0.3,0.2,0,0,0,0" o="FFF200" c="3" m=""/><S T="12" X="2295" Y="48" L="10" H="100" P="0,0,0.3,0.2,0,0,0,0" o="FFF200" c="3" m=""/><S T="12" X="1200" Y="45" L="100" H="105" P="0,0,0.3,0.2,0,0,0,0" o="324650" c="4"/><S T="12" X="1300" Y="225" L="2600" H="10" P="0,0,0.3,0.2,0,0,0,0" o="FFF200" c="3" m=""/><S T="12" X="1300" Y="240" L="10" H="40" P="0,0,0,0,0,0,0,0" o="FFF200" c="3" m=""/><S T="12" X="1300" Y="790" L="800" H="10" P="0,0,0.3,0.2,90,0,0,0" o="FF0000" N="" m=""/><S T="12" X="600" Y="770" L="10" H="840" P="0,0,0.3,0.2,0,0,0,0" o="FFFFFF" N=""/><S T="12" X="2000" Y="770" L="10" H="840" P="0,0,0.3,0.2,0,0,0,0" o="FFFFFF" N=""/><S T="12" X="316" Y="-129" L="20" H="200" P="0,0,0.2,0.2,0,0,0,0" o="6a7495" c="3"/><S T="12" X="407" Y="-133" L="20" H="200" P="0,0,0.2,0.2,0,0,0,0" o="6a7495" c="3"/><S T="12" X="363" Y="-92" L="20" H="100" P="0,0,0.2,0.2,90,0,0,0" o="6a7495" c="3"/><S T="12" X="360" Y="-206" L="20" H="100" P="0,0,0.2,0.2,90,0,0,0" o="6a7495" c="3"/><S T="12" X="1300" Y="460" L="3400" H="120" P="0,0,0.3,0.2,0,0,0,0" o="6a7495" c="4" N=""/><S T="12" X="1400" Y="45" L="100" H="105" P="0,0,0.3,0.2,0,0,0,0" o="324650" c="4"/><S T="12" X="1300" Y="-800" L="2640" H="20" P="0,0,0,0.2,0,0,0,0" o="FF0000" m=""/><S T="12" X="1300" Y="1190" L="2640" H="20" P="0,0,0,0.2,0,0,0,0" o="FF0000" m=""/><S T="12" X="600" Y="355" L="10" H="10" P="0,0,20,0.2,45,0,0,0" o="FFFFFF" c="2"/><S T="12" X="2000" Y="355" L="10" H="10" P="0,0,20,0.2,45,0,0,0" o="FFFFFF" c="2"/></S><D><P X="1900" Y="365" T="10" P="1,0"/><P X="700" Y="365" T="10" P="1,0"/><DS X="365" Y="-141"/></D><O/><L/></Z></C>')
    return
  end

  if gameStats.threeTeamsMode then
    if mapsToTest[1] ~= "" then
      tfm.exec.newGame(mapsToTest[1])
      local foundMap = addTimer(function(i)
        if i == 1 then
          foundBallSpawnsOnMap(mapsToTest[1], false)
          foundMiceSpawnsOnMap(mapsToTest[1], false)
        end
      end, 1000)

      return
    end
    
    if gameStats.isCustomMap then
      tfm.exec.newGame(customMapsThreeTeamsMode[gameStats.customMapIndex][1])
      local foundMap = addTimer(function(i)
        if i == 1 then
          foundBallSpawnsOnMap(customMapsThreeTeamsMode[gameStats.customMapIndex][1], false)
          foundMiceSpawnsOnMap(customMapsThreeTeamsMode[gameStats.customMapIndex][1], false)
        end
      end, 1000)
      
      return
    end

    if gameStats.totalVotes == 1 then
      tfm.exec.chatMessage('<bv>It is necessary that at least 2 players have used the !votemap command for a map to be selected<n>', nil)
    end
    if gameStats.totalVotes >= 2 then
      tfm.exec.newGame(customMapsThreeTeamsMode[gameStats.mapIndexSelected][1])
      local foundMap = addTimer(function(i)
        if i == 1 then
          foundBallSpawnsOnMap(customMapsThreeTeamsMode[gameStats.mapIndexSelected][1], false)
          foundMiceSpawnsOnMap(customMapsThreeTeamsMode[gameStats.mapIndexSelected][1], false)
        end
      end, 1000)
      tfm.exec.chatMessage("<bv>The "..customMapsThreeTeamsMode[gameStats.mapIndexSelected][3].." map (created by "..customMapsThreeTeamsMode[gameStats.mapIndexSelected][4]..") was selected ("..tostring(mapsVotes[gameStats.mapIndexSelected]).." votes)<n>", nil)
      print("<bv>The "..customMapsThreeTeamsMode[gameStats.mapIndexSelected][3].." map (created by "..customMapsThreeTeamsMode[gameStats.mapIndexSelected][4]..") was selected ("..tostring(mapsVotes[gameStats.mapIndexSelected]).." votes)<n>")

      return
    end

    tfm.exec.newGame(customMapsThreeTeamsMode[1][1])

    return
  end

  if gameStats.teamsMode then
    if mapsToTest[1] ~= "" then
      tfm.exec.newGame(mapsToTest[1])
      local foundMap = addTimer(function(i)
        if i == 1 then
          foundBallSpawnsOnMap(mapsToTest[1], false)
          foundMiceSpawnsOnMap(mapsToTest[1], false)
        end
      end, 1000)

      return
    end
    if gameStats.isCustomMap then
      tfm.exec.newGame(customMapsFourTeamsMode[gameStats.customMapIndex][1])
      local foundMap = addTimer(function(i)
        if i == 1 then
          foundBallSpawnsOnMap(customMapsFourTeamsMode[gameStats.customMapIndex][1], false)
          foundMiceSpawnsOnMap(customMapsFourTeamsMode[gameStats.customMapIndex][1], false)
        end
      end, 1000)

      return
    end
    if gameStats.totalVotes == 1 then
      tfm.exec.chatMessage('<bv>It is necessary that at least 2 players have used the !votemap command for a map to be selected<n>', nil)
    end
    if gameStats.totalVotes >= 2 then
      tfm.exec.newGame(customMapsFourTeamsMode[gameStats.mapIndexSelected][1])
      local foundMap = addTimer(function(i)
        if i == 1 then
          foundBallSpawnsOnMap(customMapsFourTeamsMode[gameStats.mapIndexSelected][1], false)
          foundMiceSpawnsOnMap(customMapsFourTeamsMode[gameStats.mapIndexSelected][1], false)
        end
      end, 1000)
      
      tfm.exec.chatMessage("<bv>The "..customMapsFourTeamsMode[gameStats.mapIndexSelected][3].." map (created by "..customMapsFourTeamsMode[gameStats.mapIndexSelected][4]..") was selected ("..tostring(mapsVotes[gameStats.mapIndexSelected]).." votes)<n>", nil)
      print("<bv>The "..customMapsFourTeamsMode[gameStats.mapIndexSelected][3].." map (created by "..customMapsFourTeamsMode[gameStats.mapIndexSelected][4]..") was selected ("..tostring(mapsVotes[gameStats.mapIndexSelected]).." votes)<n>")

      return
    end
    tfm.exec.newGame(customMapsFourTeamsMode[34][1])
    return
  end

  if gameStats.twoTeamsMode then
    if mapsToTest[1] ~= "" then
      tfm.exec.newGame(mapsToTest[1])
      local foundMap = addTimer(function(i)
        if i == 1 then
          foundBallSpawnsOnMap(mapsToTest[1], false)
          foundMiceSpawnsOnMap(mapsToTest[1], false)
        end
      end, 1000)

      return
    end
    if gameStats.isCustomMap then
      tfm.exec.newGame(customMapsFourTeamsMode[gameStats.customMapIndex][1])
      local foundMap = addTimer(function(i)
        if i == 1 then
          foundBallSpawnsOnMap(customMapsFourTeamsMode[gameStats.customMapIndex][1], false)
          foundMiceSpawnsOnMap(customMapsFourTeamsMode[gameStats.customMapIndex][1], false)
        end
      end, 1000)
      
      return
    end
    if gameStats.totalVotes == 1 then
      tfm.exec.chatMessage('<bv>It is necessary that at least 2 players have used the !votemap command for a map to be selected<n>', nil)
    end
    if gameStats.totalVotes >= 2 then
      tfm.exec.newGame(customMapsFourTeamsMode[gameStats.mapIndexSelected][1])
      local foundMap = addTimer(function(i)
        if i == 1 then
          foundBallSpawnsOnMap(customMapsFourTeamsMode[gameStats.mapIndexSelected][1], false)
          foundMiceSpawnsOnMap(customMapsFourTeamsMode[gameStats.mapIndexSelected][1], false)
        end
      end, 1000)
      
      tfm.exec.chatMessage("<bv>The "..customMapsFourTeamsMode[gameStats.mapIndexSelected][3].." map (created by "..customMapsFourTeamsMode[gameStats.mapIndexSelected][4]..") was selected ("..tostring(mapsVotes[gameStats.mapIndexSelected]).." votes)<n>", nil)
      print("<bv>The "..customMapsFourTeamsMode[gameStats.mapIndexSelected][3].." map (created by "..customMapsFourTeamsMode[gameStats.mapIndexSelected][4]..") was selected ("..tostring(mapsVotes[gameStats.mapIndexSelected]).." votes)<n>")

      return
    end
    tfm.exec.newGame(customMapsFourTeamsMode[34][1])
    return
  end

  if gameStats.setMapName == "" then
    if gameStats.gameMode == "3v3" then
      if mapsToTest[1] ~= "" then
        tfm.exec.newGame(mapsToTest[1])
        local foundMap = addTimer(function(i)
          if i == 1 then
            foundBallSpawnsOnMap(mapsToTest[1], false)
            foundMiceSpawnsOnMap(mapsToTest[1], false)
          end
        end, 1000)

        return
      end
      if gameStats.isCustomMap then
        tfm.exec.newGame(customMaps[gameStats.customMapIndex][1])
        local foundMap = addTimer(function(i)
          if i == 1 then
            foundBallSpawnsOnMap(customMaps[gameStats.customMapIndex][1], false)
            foundMiceSpawnsOnMap(customMaps[gameStats.customMapIndex][1], false)
          end
        end, 1000)
      else
        if gameStats.totalVotes == 1 then
          tfm.exec.chatMessage('<bv>It is necessary that at least 2 players have used the !votemap command for a map to be selected<n>', nil)
        end
        if gameStats.totalVotes >= 2 then
          tfm.exec.newGame(customMaps[gameStats.mapIndexSelected][1])
          local foundMap = addTimer(function(i)
            if i == 1 then
              foundBallSpawnsOnMap(customMaps[gameStats.mapIndexSelected][1], false)
              foundMiceSpawnsOnMap(customMaps[gameStats.mapIndexSelected][1], false)
            end
          end, 1000)
          
          tfm.exec.chatMessage("<bv>The "..customMaps[gameStats.mapIndexSelected][3].." map (created by "..customMaps[gameStats.mapIndexSelected][4]..") was selected ("..tostring(mapsVotes[gameStats.mapIndexSelected]).." votes)<n>", nil)
          print("<bv>The "..customMaps[gameStats.mapIndexSelected][3].." map (created by "..customMaps[gameStats.mapIndexSelected][4]..") was selected ("..tostring(mapsVotes[gameStats.mapIndexSelected]).." votes)<n>")
        else
          tfm.exec.newGame(maps[1])
        end

      end

    else
      if mapsToTest[1] ~= "" then
        tfm.exec.newGame(mapsToTest[1])
        local foundMap = addTimer(function(i)
          if i == 1 then
            foundBallSpawnsOnMap(mapsToTest[1], true)
            foundMiceSpawnsOnMap(mapsToTest[1], true)
          end
        end, 1000)

        return
      end
      if gameStats.isCustomMap then
        tfm.exec.newGame(customMaps[gameStats.customMapIndex][2])
        local foundMap = addTimer(function(i)
          if i == 1 then
            foundBallSpawnsOnMap(customMaps[gameStats.customMapIndex][2], true)
            foundMiceSpawnsOnMap(customMaps[gameStats.customMapIndex][2], true)
          end
        end, 1000)
      else
        if gameStats.totalVotes == 1 then
          tfm.exec.chatMessage('<bv>It is necessary that at least 2 players have used the !votemap command for a map to be selected<n>', nil)
        end
        if gameStats.totalVotes >= 2 then
          tfm.exec.newGame(customMaps[gameStats.mapIndexSelected][2])
          local foundMap = addTimer(function(i)
            if i == 1 then
              foundBallSpawnsOnMap(customMaps[gameStats.mapIndexSelected][2], true)
              foundMiceSpawnsOnMap(customMaps[gameStats.mapIndexSelected][2], true)
            end
          end, 1000)
          
          tfm.exec.chatMessage("<bv>The "..customMaps[gameStats.mapIndexSelected][3].." map (created by "..customMaps[gameStats.mapIndexSelected][4]..") was selected ("..tostring(mapsVotes[gameStats.mapIndexSelected]).." votes)<n>", nil)
        else
          tfm.exec.newGame(maps[2])
        end
      end
    end
  else
    if gameStats.setMapName == "small" then
      gameStats.gameMode = "3v3"
      gameStats.redX = 399
      gameStats.blueX = 401
      if mapsToTest[1] ~= "" then
        tfm.exec.newGame(mapsToTest[1])
        local foundMap = addTimer(function(i)
          if i == 1 then
            foundBallSpawnsOnMap(mapsToTest[1], false)
            foundMiceSpawnsOnMap(mapsToTest[1], false)
          end
        end, 1000)

        return
      end
      if gameStats.isCustomMap then
        tfm.exec.newGame(customMaps[gameStats.customMapIndex][1])
        local foundMap = addTimer(function(i)
          if i == 1 then
            foundBallSpawnsOnMap(customMaps[gameStats.customMapIndex][1], false)
            foundMiceSpawnsOnMap(customMaps[gameStats.customMapIndex][1], false)
          end
        end, 1000)
      else
        if gameStats.totalVotes == 1 then
          tfm.exec.chatMessage('<bv>It is necessary that at least 2 players have used the !votemap command for a map to be selected<n>', nil)
        end
        if gameStats.totalVotes >= 2 then
          tfm.exec.newGame(customMaps[gameStats.mapIndexSelected][1])
          local foundMap = addTimer(function(i)
            if i == 1 then
              foundBallSpawnsOnMap(customMaps[gameStats.mapIndexSelected][1], false)
              foundMiceSpawnsOnMap(customMaps[gameStats.mapIndexSelected][1], false)
            end
          end, 1000)
          tfm.exec.chatMessage("<bv>The "..customMaps[gameStats.mapIndexSelected][3].." map (created by "..customMaps[gameStats.mapIndexSelected][4]..") was selected ("..tostring(mapsVotes[gameStats.mapIndexSelected]).." votes)<n>", nil)
        else
          tfm.exec.newGame(maps[1])
        end
      end
    elseif gameStats.setMapName == "large" then
      gameStats.gameMode = "4v4"
      gameStats.redX = 599
      gameStats.blueX = 601
      if mapsToTest[1] ~= "" then
        tfm.exec.newGame(mapsToTest[1])
        local foundMap = addTimer(function(i)
          if i == 1 then
            foundBallSpawnsOnMap(mapsToTest[1], true)
            foundMiceSpawnsOnMap(mapsToTest[1], true)
          end
        end, 1000)
        return
      end
      
      if gameStats.isCustomMap then
        tfm.exec.newGame(customMaps[gameStats.customMapIndex][2])
        local foundMap = addTimer(function(i)
          if i == 1 then
            foundBallSpawnsOnMap(customMaps[gameStats.customMapIndex][2], true)
            foundMiceSpawnsOnMap(customMaps[gameStats.customMapIndex][2], true)
          end
        end, 1000)
      else
        if gameStats.totalVotes == 1 then
          tfm.exec.chatMessage('<bv>It is necessary that at least 2 players have used the !votemap command for a map to be selected<n>', nil)
        end
        if gameStats.totalVotes >= 2 then
          tfm.exec.newGame(customMaps[gameStats.mapIndexSelected][2])
          local foundMap = addTimer(function(i)
            if i == 1 then
              foundBallSpawnsOnMap(customMaps[gameStats.mapIndexSelected][2], true)
              foundMiceSpawnsOnMap(customMaps[gameStats.mapIndexSelected][2], true)
            end
          end, 1000)
          tfm.exec.chatMessage("<bv>The "..customMaps[gameStats.mapIndexSelected][3].." map (created by "..customMaps[gameStats.mapIndexSelected][4]..") was selected ("..tostring(mapsVotes[gameStats.mapIndexSelected]).." votes)<n>", nil)
        else
          tfm.exec.newGame(maps[2])
        end
      end
    elseif gameStats.setMapName == "extra-large" then
      gameStats.gameMode = "6v6"
      gameStats.redX = 899
      gameStats.blueX = 901

      tfm.exec.newGame(maps[3])
    end
  end
end


--[[ src/functions/game/spawnBall/functionalitty/foundBallSpawnsOnMap.lua ]]--

function foundBallSpawnsOnMap(map, isLargeMap)
  local tags_T131 = {}
  spawnBallArea400 = {}
  spawnBallArea800 = {}
  spawnBallArea1200 = {}
  spawnBallArea1600 = {}
  
  local mapXML = ""
  
  if #map > 10 then
    mapXML = map
  else
    mapXML = tfm.get.room.xmlMapInfo.xml
  end
  
  for tag in string.gmatch(mapXML, '<P[^>]*T="131"[^>]*/?>') do
    table.insert(tags_T131, tag)
  end
  
  for _, tag in ipairs(tags_T131) do
    local xString = tag:match('X="(%d+)"')
    local yString = tag:match('Y="(%d+)"')
    
    local x = tonumber(xString)
    local y = tonumber(yString)
    if gameStats.threeTeamsMode then
      if x >= 0 and x <= 600 then
        spawnBallArea400[#spawnBallArea400 + 1] = { x = x, y = y}
      end
      if x >= 600 and x <= 1200 then
        spawnBallArea800[#spawnBallArea800 + 1] = { x  = x, y = y}
      end
      if x >= 1200 and x <= 1800 then
        spawnBallArea1200[#spawnBallArea1200 + 1] = { x = x, y = y}
      end
    else
      if isLargeMap then
        if x >= 0 and x <= 600 then
          spawnBallArea800[#spawnBallArea800 + 1] = {x = x, y = y}
        end
        if x >= 600 and x <= 1200 then
          spawnBallArea1600[#spawnBallArea1600 + 1] = {x = x, y = y}
        end
      else
        if x >= 0 and x <= 400 then
          spawnBallArea400[#spawnBallArea400 + 1] = { x = x, y = y}
        end
        if x >= 400 and x <= 800 then
          spawnBallArea800[#spawnBallArea800 + 1] = { x  = x, y = y}
        end
        if x >= 800 and x <= 1200 then
          spawnBallArea1200[#spawnBallArea1200 + 1] = { x = x, y = y}
        end
        if x >= 1200 and x <= 1600 then
          spawnBallArea1600[#spawnBallArea1600 + 1] = { x = x, y = y}
        end
      end
    end
  end
end


--[[ src/functions/game/spawnBall/functionalitty/spawnBallOnSpecificPlaces.lua ]]--

function spawnBallsOnSpecificPlaces(spawnBallsTable, defaultSpawnBallTable)
  local spawnBalls = spawnBallsTable
  local defaultSpawnBall = defaultSpawnBallTable
  
  local randomIndex = 0
  local spawnPlaces = {[1] = {x = 0, y = 50}, [2] = {x = 0, y = 50}, [3] = {x = 0, y = 50}}
  local maxIndex = 2

  if gameStats.threeTeamsMode then
    maxIndex = 3
  end

  for i = 1, maxIndex do
    local randomTeamSpawn = math.random(1, #spawnBalls)
    if #spawnBalls > 0 and #spawnBalls[randomTeamSpawn] ~= 0 then
      randomIndex = math.random(1, #spawnBalls[randomTeamSpawn])
      spawnPlaces[i].x = spawnBalls[randomTeamSpawn][randomIndex].x
      spawnPlaces[i].y = spawnBalls[randomTeamSpawn][randomIndex].y
      table.remove(spawnBalls, randomTeamSpawn)
    else
      randomIndex = math.random(1, #defaultSpawnBall)
      spawnPlaces[i].x = defaultSpawnBall[randomIndex]
      table.remove(defaultSpawnBall, randomIndex)
    end
  end
  
  return spawnPlaces
end


--[[ src/functions/game/spawnBall/spawnBall.lua ]]--

function spawnBall(x, index, y)
  local ballSpawnX = x
  local ballSpawnY = 50

  if y ~= nil then
    ballSpawnY = y
  end

  if index == 1 then
    tfm.exec.removeObject(ball_id)
    ball_id = nil
    ballOnGame = false
    updateTwoBallOnGame()
    showTheScore()

    if gameStats.customBall then
      ball_id = tfm.exec.addShamanObject(balls[gameStats.customBallId].id, ballSpawnX, ballSpawnY, 0, 0, -5, true)
      
      if balls[gameStats.customBallId].isImage then
        tfm.exec.addImage(balls[gameStats.customBallId].image, "#"..ball_id, -15, -15, nil, 1, 1, _, 10)
      end

      ballOnGame = true
      updateTwoBallOnGame()
      return
    else
      ball_id = tfm.exec.addShamanObject(6, ballSpawnX, ballSpawnY, 0, 0, -5, true)
      ballOnGame = true
      updateTwoBallOnGame()
      return
    end

  elseif index == 2 then
    tfm.exec.removeObject(ball_id2)
    ball_id2 = nil
    ballOnGame2 = false
    updateTwoBallOnGame()
    showTheScore()

    if gameStats.customBall then
      ball_id2 = tfm.exec.addShamanObject(balls[gameStats.customBallId].id, ballSpawnX, ballSpawnY, 0, 0, -5, true)
      
      if balls[gameStats.customBallId].isImage then
        tfm.exec.addImage(balls[gameStats.customBallId].image, "#"..ball_id2, -15, -15, nil, 1, 1, _, 10)
      end
      ballOnGame2 = true
      updateTwoBallOnGame()
      return
    else
      ball_id2 = tfm.exec.addShamanObject(6, ballSpawnX, ballSpawnY, 0, 0, -5, true)
      ballOnGame2 = true
      updateTwoBallOnGame()
      return
    end
  elseif index == 3 then
    tfm.exec.removeObject(ball_id3)
    ball_id3 = nil
    ballOnGame3 = false
    updateTwoBallOnGame()
    showTheScore()

    if gameStats.customBall then
      ball_id3 = tfm.exec.addShamanObject(balls[gameStats.customBallId].id, ballSpawnX, ballSpawnY, 0, 0, -5, true)
      
      if balls[gameStats.customBallId].isImage then
        tfm.exec.addImage(balls[gameStats.customBallId].image, "#"..ball_id3, -15, -15, nil, 1, 1, _, 10)
      end
      ballOnGame3 = true
      updateTwoBallOnGame()
      return
    else
      ball_id3 = tfm.exec.addShamanObject(6, ballSpawnX, ballSpawnY, 0, 0, -5, true)
      ballOnGame3 = true
      updateTwoBallOnGame()
      return
    end
  end
end


--[[ src/functions/game/spawnBall/spawnBallConfig.lua ]]--

function spawnBallConfig(spawnBalls, x)
  local customBallId = 6
  local ballPlaces = spawnBallsOnSpecificPlaces(spawnBalls, x)
  
  -- print("Ball places:")
  -- print(ballPlaces)
  
  if gameStats.customBall then
    customBallId = balls[gameStats.customBallId].id
  end
  
  ball_id = tfm.exec.addShamanObject(customBallId, ballPlaces[1].x, ballPlaces[1].y, 0, 0, -5, true)
  
  if gameStats.customBall then
    if balls[gameStats.customBallId].isImage then
      tfm.exec.addImage(balls[gameStats.customBallId].image, "#"..ball_id, -15, -15, nil, 1, 1, _, 10)
    end
  end
  
  if gameStats.twoBalls or gameStats.threeBalls then
    ball_id2 = tfm.exec.addShamanObject(customBallId, ballPlaces[2].x, ballPlaces[2].y, 0, 0, -5, true)
    
    if gameStats.customBall then
      if balls[gameStats.customBallId].isImage then
        tfm.exec.addImage(balls[gameStats.customBallId].image, "#"..ball_id2, -15, -15, nil, 1, 1, _, 10)
      end
    end
    ballOnGame2 = true
  end

  if gameStats.threeBalls then
    ball_id3 = tfm.exec.addShamanObject(customBallId, ballPlaces[3].x, ballPlaces[3].y, 0, 0, -5, true)
    
    if gameStats.customBall then
      if balls[gameStats.customBallId].isImage then
        tfm.exec.addImage(balls[gameStats.customBallId].image, "#"..ball_id3, -15, -15, nil, 1, 1, _, 10)
      end
    end
    ballOnGame3 = true
  end
  
  ballOnGame = true
  updateTwoBallOnGame()
end


--[[ src/functions/game/spawnBall/spawnBallRealMode.lua ]]--

function spawnBallRealMode(team)
  gameStats.reduceForce = true
  if team == "red" then
    gameStats.teamWithOutAce = "blue"

    ballOnGame = false
    tfm.exec.removeObject (ball_id)
    gameStats.redServe = true

    if gameStats.customBall then
      ball_id = tfm.exec.addShamanObject(balls[gameStats.customBallId].id, 700, 50, 0, 0, -5, true)
      if balls[gameStats.customBallId].isImage then
        tfm.exec.addImage(balls[gameStats.customBallId].image, "#"..ball_id, -15, -15, nil, 1, 1, _, 10)
      end
    else
      ball_id = tfm.exec.addShamanObject(6, 700, 50, 0, 0, -5, true)
    end

    ballOnGame = true
    showTheScore()
    gameStats.canTransform = true

    return
  elseif team == "blue" then
    gameStats.teamWithOutAce = "red"
    ballOnGame = false
    tfm.exec.removeObject (ball_id)
    gameStats.blueServe = true
    if gameStats.customBall then
      ball_id = tfm.exec.addShamanObject(balls[gameStats.customBallId].id, 1900, 50, 0, 0, -5, true)
      if balls[gameStats.customBallId].isImage then
        tfm.exec.addImage(balls[gameStats.customBallId].image, "#"..ball_id, -15, -15, nil, 1, 1, _, 10)
      end
    else
      ball_id = tfm.exec.addShamanObject(6, 1900, 50, 0, 0, -5, true)
    end

    gameStats.canTransform = true
    ballOnGame = true
    showTheScore()

  end
end


--[[ src/functions/game/spawnBall/spawnInitialBall.lua ]]--

function spawnInitialBall()
  local x = {}

  if gameStats.threeTeamsMode and gameStats.typeMap == "large4v4" then
    local spawnBalls = { spawnBallArea400, spawnBallArea800, spawnBallArea1200 }

    x = {300, 900, 1500}

    spawnBallConfig(spawnBalls, x)

    return
  elseif gameStats.threeTeamsMode and gameStats.typeMap == "large3v3" then
    local spawnBalls = { spawnBallArea400, spawnBallArea800 }

    x = {300, 600, 900}

    spawnBallConfig(spawnBalls, x)

    return
  end

  if gameStats.teamsMode and gameStats.typeMap == "large4v4" or gameStats.twoTeamsMode then
    local spawnBalls = { spawnBallArea400, spawnBallArea800, spawnBallArea1200, spawnBallArea1600 }

    x = {200, 600, 1000, 1400}

    spawnBallConfig(spawnBalls, x)

    return
  elseif gameStats.teamsMode and gameStats.typeMap == "large3v3" then
    x = {200, 600, 1000}
    local spawnBalls = { spawnBallArea400, spawnBallArea800, spawnBallArea1200 }

    spawnBallConfig(spawnBalls, x)

    return
  elseif gameStats.teamsMode and gameStats.typeMap == "small" then
    x = {200, 600}
    local spawnBalls = { spawnBallArea400, spawnBallArea800 }

    spawnBallConfig(spawnBalls, x)

    return
  end

  if gameStats.realMode then
    ballOnGame = false
    local team = chooseInitialPlayer()

    print(team)
    gameStats.reduceForce = true
    if team == "red" then
      gameStats.aceRed = true
      gameStats.redLimitSpawn = 1
      local delaySpawnBall = addTimer(function(i)
        if i == 1 then
          if gameStats.customBall then
            ball_id = tfm.exec.addShamanObject(balls[gameStats.customBallId].id, 700, 50, 0, 0, -5, true)
            if balls[gameStats.customBallId].isImage then
              tfm.exec.addImage(balls[gameStats.customBallId].image, "#"..ball_id, -15, -15, nil, 1, 1, _, 10)
            end
          else
            ball_id = tfm.exec.addShamanObject(6, 700, 50, 0, 0, -5, true)
          end
        end
      end, 4000, 1, "delaySpawnBall")
    elseif team == "blue" then
      gameStats.aceBlue = true
      gameStats.blueLimitSpawn = 1
      local delaySpawnBall = addTimer(function(i)
        if i == 1 then
          if gameStats.customBall then
            ball_id = tfm.exec.addShamanObject(balls[gameStats.customBallId].id, 1900, 50, 0, 0, -5, true)
            if balls[gameStats.customBallId].isImage then
              tfm.exec.addImage(balls[gameStats.customBallId].image, "#"..ball_id, -15, -15, nil, 1, 1, _, 10)
            end
          else
            ball_id = tfm.exec.addShamanObject(6, 1900, 50, 0, 0, -5, true)
          end
        end
      end, 4000, 1, "delaySpawnBall")
    end

    showTheScore()

    delayToVerifyBall = addTimer(function(i)
      if i == 1 then
        ballOnGame = true
      end
    end, 2000, 1, "delayToVerifyBall")
    return
  end

  local spawnBalls = {}
  if gameStats.gameMode == "3v3" then
    x = {200, 600}
    spawnBalls = {spawnBallArea400, spawnBallArea800}
  elseif gameStats.gameMode == "4v4" then
    x = {400, 800}
    spawnBalls = {spawnBallArea800, spawnBallArea1600}
  else
    gameStats.psyhicObjectForce = 1.2
    x = {400, 1400}
  end

  --print(x)

  spawnBallConfig(spawnBalls, x)
  ballOnGame = true
  updateTwoBallOnGame()
end


--[[ src/functions/game/spawnBall/updateTwoBallsOnGame.lua ]]--

function updateTwoBallOnGame()
  ballOnGameTwoBalls = {ballOnGame, ballOnGame2, ballOnGame3}
  ballsId = {ball_id, ball_id2, ball_id3}
end


--[[ src/functions/game/startGame.lua ]]--

function startGame()
  gameStats.canTransform = false
  disablePlayersCanTransform(1500)

  addMatchesToAllPlayers()
  selectMap()

  duration = os.time() + durationTimerPause * 1000

  local timer = math.ceil((duration - os.time())/1000)

  tfm.exec.setGameTime(timer, true)

  tfm.exec.addPhysicObject (99999, 800, 460, 
  {
    type = 15,
    width = 3000,
    height = 100,
    miceCollision = false,
    groundCollision = false   
  })

  removeTextAreasOfLobby()
  showTheScore()

  delaySpawnBall = addTimer(function(i)
    if i == 1 then
      teleportPlayers()
      spawnInitialBall()
    end
  end, 2500)

  verifyIsPoint()
  showCrownToAllPlayers()
  mode = "gameStart"
  tfm.exec.chatMessage("<ch>If you don't want to see the ranking crowns, type the command !crown false<n>", nil)
end


--[[ src/functions/game/verifyIsPoint/setLostLife.lua ]]--

function setLostLife()
  local quantityBalls = 1
  
  if gameStats.twoBalls then
    quantityBalls = 2
  end
  
  for j = 1, quantityBalls do
    local onCondition = false
    local lostLife = false
    
    print(ballsId[j])
    print(ballOnGameTwoBalls[j])
    print('===')
    if gameStats.typeMap == "large4v4" and ballOnGameTwoBalls[j] and ballsId[j] ~= nil then
      if tfm.get.room.objectList[ballsId[j]].x <= gameStats.yellowX and tfm.get.room.objectList[ballsId[j]].y >= 368 and teamsLifes[1].yellow >= 1 and not lostLife then
        lostLife = true
        onCondition = true
        teamsLifes[1].yellow = teamsLifes[1].yellow - 1
        if teamsLifes[1].yellow == 0 then
          ballOnGame = false
          ballOnGame2 = false
          updateTwoBallOnGame()
          
          for i = 1, #playersYellow do
            tfm.exec.setNameColor(playersYellow[i].name, 0xD1D5DB)
            tfm.exec.movePlayer(playersYellow[i].name, 391, 74)
            playerInGame[playersYellow[i].name] = false
            playersYellow[i].name = ''
          end
          tfm.exec.chatMessage("<j>Yellow team lost all their lives<n>", nil)
          toggleMapType()
          updateTeamsColors(1)
          gameStats.canTransform = false
          disablePlayersCanTransform(4000)
          delayToToggleMap = addTimer(function(i)
            if i == 1 then
              toggleMap()
            end
          end, 3000, 1, "delayToToggleMap")
          
          return
        end
        tfm.exec.chatMessage("<j>Yellow team lost a life<n>", nil)
        tfm.exec.chatMessage("<j>Team Yellow<n> "..teamsLifes[1].yellow.." | <r>Team Red<n> "..teamsLifes[2].red.." | <bv>Team Blue<n> "..teamsLifes[3].blue.." | <vp>Team Green<n> "..teamsLifes[4].green.."", nil)
        print("<j>Team Yellow<n> "..teamsLifes[1].yellow.." | <r>Team Red<n> "..teamsLifes[2].red.." | <bv>Team Blue<n> "..teamsLifes[3].blue.." | <vp>Team Green<n> "..teamsLifes[4].green.."")
        local ballSpawnX = 0
        local ballSpawnY = 0
        
        if #spawnBallArea400 ~= 0 then
          randomIndex = math.random(1, #spawnBallArea400)
          ballSpawnX = spawnBallArea400[randomIndex].x
          ballSpawnY = spawnBallArea400[randomIndex].y
          spawnBall(ballSpawnX, j, ballSpawnY)
        else
          spawnBall(200, j)
        end
        
        showTheScore()
      elseif tfm.get.room.objectList[ballsId[j]].x <= gameStats.redX and tfm.get.room.objectList[ballsId[j]].y >= 368 and teamsLifes[2].red >= 1 and not onCondition and not lostLife then
        lostLife = true
        onCondition = true
        teamsLifes[2].red = teamsLifes[2].red - 1
        if teamsLifes[2].red == 0 then
          ballOnGame = false
          ballOnGame2 = false
          updateTwoBallOnGame()
          for i = 1, #playersRed do
            tfm.exec.setNameColor(playersRed[i].name, 0xD1D5DB)
            tfm.exec.movePlayer(playersRed[i].name, 391, 74)
            playerInGame[playersRed[i].name] = false
            playersRed[i].name = ''
          end
          tfm.exec.chatMessage("<r>Red team lost all their lives<n>", nil)
          toggleMapType()
          updateTeamsColors(2)
          gameStats.canTransform = false
          disablePlayersCanTransform(4000)
          delayToToggleMap = addTimer(function(i)
            if i == 1 then
              toggleMap()
            end
          end, 3000, 1, "delayToToggleMap")
          return
        end
        local ballSpawnX = 0
        local ballSpawnY = 0
        
        tfm.exec.chatMessage("<r>Red team lost a life<n>", nil)
        tfm.exec.chatMessage("<j>Team Yellow<n> "..teamsLifes[1].yellow.." | <r>Team Red<n> "..teamsLifes[2].red.." | <bv>Team Blue<n> "..teamsLifes[3].blue.." | <vp>Team Green<n> "..teamsLifes[4].green.."", nil)
        print("<j>Team Yellow<n> "..teamsLifes[1].yellow.." | <r>Team Red<n> "..teamsLifes[2].red.." | <bv>Team Blue<n> "..teamsLifes[3].blue.." | <vp>Team Green<n> "..teamsLifes[4].green.."")
        if #spawnBallArea800 ~= 0 then
          randomIndex = math.random(1, #spawnBallArea800)
          ballSpawnX = spawnBallArea800[randomIndex].x
          ballSpawnY = spawnBallArea800[randomIndex].y
          spawnBall(ballSpawnX, j, ballSpawnY)
        else
          spawnBall(600, j)
        end
        showTheScore()
      elseif tfm.get.room.objectList[ballsId[j]].x <= gameStats.blueX and tfm.get.room.objectList[ballsId[j]].y >= 368 and teamsLifes[3].blue >= 1 and not onCondition and not lostLife then
        lostLife = true
        onCondition = true
        teamsLifes[3].blue = teamsLifes[3].blue - 1
        if teamsLifes[3].blue == 0 then
          ballOnGame = false
          ballOnGame2 = false
          updateTwoBallOnGame()
          for i = 1, #playersBlue do
            tfm.exec.setNameColor(playersBlue[i].name, 0xD1D5DB)
            tfm.exec.movePlayer(playersBlue[i].name, 391, 74)
            playerInGame[playersBlue[i].name] = false
            playersBlue[i].name = ''
          end
          tfm.exec.chatMessage("<bv>Blue team lost all their lives<n>", nil)
          toggleMapType()
          updateTeamsColors(3)
          gameStats.canTransform = false
          disablePlayersCanTransform(4000)
          delayToToggleMap = addTimer(function(i)
            if i == 1 then
              toggleMap()
            end
          end, 3000, 1, "delayToToggleMap")
          return
        end
        tfm.exec.chatMessage("<bv>Blue team lost a life<n>", nil)
        tfm.exec.chatMessage("<j>Team Yellow<n> "..teamsLifes[1].yellow.." | <r>Team Red<n> "..teamsLifes[2].red.." | <bv>Team Blue<n> "..teamsLifes[3].blue.." | <vp>Team Green<n> "..teamsLifes[4].green.."", nil)
        print("<j>Team Yellow<n> "..teamsLifes[1].yellow.." | <r>Team Red<n> "..teamsLifes[2].red.." | <bv>Team Blue<n> "..teamsLifes[3].blue.." | <vp>Team Green<n> "..teamsLifes[4].green.."")
        local ballSpawnX = 0
        local ballSpawnY = 0
        if #spawnBallArea1200 ~= 0 then
          randomIndex = math.random(1, #spawnBallArea1200)
          ballSpawnX = spawnBallArea1200[randomIndex].x
          ballSpawnY = spawnBallArea1200[randomIndex].y
          spawnBall(ballSpawnX, j, ballSpawnY)
        else
          spawnBall(1000, j)
        end
        
        showTheScore()
      elseif tfm.get.room.objectList[ballsId[j]].x >= gameStats.greenX and tfm.get.room.objectList[ballsId[j]].y >= 368 and teamsLifes[4].green >= 1 and not onCondition and not lostLife then
        lostLife = true
        onCondition = true
        teamsLifes[4].green = teamsLifes[4].green - 1
        if teamsLifes[4].green == 0 then
          ballOnGame = false
          ballOnGame2 = false
          updateTwoBallOnGame()
          for i = 1, #playersGreen do
            tfm.exec.setNameColor(playersGreen[i].name, 0xD1D5DB)
            tfm.exec.movePlayer(playersGreen[i].name, 391, 74)
            playerInGame[playersGreen[i].name] = false
            playersGreen[i].name = ''
          end
          tfm.exec.chatMessage("<vp>Green team lost all their lives<n>", nil)
          toggleMapType()
          updateTeamsColors(4)
          gameStats.canTransform = false
          disablePlayersCanTransform(4000)
          delayToToggleMap = addTimer(function(i)
            if i == 1 then
              toggleMap()
            end
          end, 3000, 1, "delayToToggleMap")
          return
        end
        local ballSpawnX = 0
        local ballSpawnY = 0
        
        tfm.exec.chatMessage("<vp>Green team lost a life<n>", nil)
        tfm.exec.chatMessage("<j>Team Yellow<n> "..teamsLifes[1].yellow.." | <r>Team Red<n> "..teamsLifes[2].red.." | <bv>Team Blue<n> "..teamsLifes[3].blue.." | <vp>Team Green<n> "..teamsLifes[4].green.."", nil)
        print("<j>Team Yellow<n> "..teamsLifes[1].yellow.." | <r>Team Red<n> "..teamsLifes[2].red.." | <bv>Team Blue<n> "..teamsLifes[3].blue.." | <vp>Team Green<n> "..teamsLifes[4].green.."")
        if #spawnBallArea1600 ~= 0 then
          randomIndex = math.random(1, #spawnBallArea1600)
          ballSpawnX = spawnBallArea1600[randomIndex].x
          ballSpawnY = spawnBallArea1600[randomIndex].y
          spawnBall(ballSpawnX, j, ballSpawnY)
        else
          spawnBall(1400, j)
        end
        showTheScore()
      end
    elseif gameStats.typeMap == "large3v3" and ballOnGameTwoBalls[j] and ballsId[j] ~= nil then
      for i = 1, #getTeamsLifes do
        if tfm.get.room.objectList[ballsId[j]].x <= 399 and tfm.get.room.objectList[ballsId[j]].y >= 368 and getTeamsLifes[1] >= 1 and i == 1 and not lostLife then
          lostLife = true
          getTeamsLifes[1] = getTeamsLifes[1] - 1
          if getTeamsLifes[1] == 0 then
            ballOnGame = false
            ballOnGame2 = false
            updateTwoBallOnGame()
            for j = 1, #teamsPlayersOnGame[i] do
              tfm.exec.setNameColor(teamsPlayersOnGame[i][j].name, 0xD1D5DB)
              tfm.exec.movePlayer(teamsPlayersOnGame[i][j].name, 391, 74)
              playerInGame[teamsPlayersOnGame[i][j].name] = false
              teamsPlayersOnGame[i][j].name = ''
            end
            tfm.exec.chatMessage(messageTeamsLifes[1], nil)
            print(messageTeamsLifes[1])
            updateTeamsColors(1)
            toggleMapType()
            gameStats.canTransform = false
            disablePlayersCanTransform(4000)
            delayToToggleMap = addTimer(function(i)
              if i == 1 then
                toggleMap()
              end
            end, 3000, 1, "delayToToggleMap")
            return
          end
          tfm.exec.chatMessage(messageTeamsLostOneLife[1], nil)
          print(messageTeamsLostOneLife[1])
          tfm.exec.chatMessage(""..messageTeamsLifesTextChat[1].." "..getTeamsLifes[1].." | "..messageTeamsLifesTextChat[2].." "..getTeamsLifes[2].." | "..messageTeamsLifesTextChat[3].." "..getTeamsLifes[3].."", nil)
          print(""..messageTeamsLifesTextChat[1].." "..getTeamsLifes[1].." | "..messageTeamsLifesTextChat[2].." "..getTeamsLifes[2].." | "..messageTeamsLifesTextChat[3].." "..getTeamsLifes[3].."")
          
          local ballSpawnX = 0
          local ballSpawnY = 0
          
          if #spawnBallArea400 ~= 0 then
            randomIndex = math.random(1, #spawnBallArea400)
            ballSpawnX = spawnBallArea400[randomIndex].x
            ballSpawnY = spawnBallArea400[randomIndex].y
            spawnBall(ballSpawnX, j, ballSpawnY)
          else
            spawnBall(200, j)
          end
          showTheScore()
        elseif tfm.get.room.objectList[ballsId[j]].x <= 799 and tfm.get.room.objectList[ballsId[j]].y >= 368 and getTeamsLifes[2] >= 1 and i == 2 and not lostLife then
          lostLife = true
          getTeamsLifes[2] = getTeamsLifes[2] - 1
          if getTeamsLifes[2] == 0 then
            ballOnGame = false
            ballOnGame2 = false
            updateTwoBallOnGame()
            for j = 1, #teamsPlayersOnGame[i] do
              tfm.exec.setNameColor(teamsPlayersOnGame[i][j].name, 0xD1D5DB)
              tfm.exec.movePlayer(teamsPlayersOnGame[i][j].name, 391, 74)
              playerInGame[teamsPlayersOnGame[i][j].name] = false
              teamsPlayersOnGame[i][j].name = ''
            end
            tfm.exec.chatMessage(messageTeamsLifes[2], nil)
            print(messageTeamsLifes[2])
            toggleMapType()
            updateTeamsColors(2)
            gameStats.canTransform = false
            disablePlayersCanTransform(4000)
            delayToToggleMap = addTimer(function(i)
              if i == 1 then
                toggleMap()
              end
            end, 3000, 1, "delayToToggleMap")
            return
          end
          tfm.exec.chatMessage(messageTeamsLostOneLife[2], nil)
          print(messageTeamsLostOneLife[2])
          tfm.exec.chatMessage(""..messageTeamsLifesTextChat[1].." "..getTeamsLifes[1].." | "..messageTeamsLifesTextChat[2].." "..getTeamsLifes[2].." | "..messageTeamsLifesTextChat[3].." "..getTeamsLifes[3].."", nil)
          print(""..messageTeamsLifesTextChat[1].." "..getTeamsLifes[1].." | "..messageTeamsLifesTextChat[2].." "..getTeamsLifes[2].." | "..messageTeamsLifesTextChat[3].." "..getTeamsLifes[3].."")
          
          local ballSpawnX = 0
          local ballSpawnY = 0
          
          if #spawnBallArea800 ~= 0 then
            randomIndex = math.random(1, #spawnBallArea800)
            ballSpawnX = spawnBallArea800[randomIndex].x
            ballSpawnY = spawnBallArea800[randomIndex].y
            spawnBall(ballSpawnX, j, ballSpawnY)
          else
            spawnBall(600, j)
          end
          showTheScore()
        elseif tfm.get.room.objectList[ballsId[j]].x >= 801 and tfm.get.room.objectList[ballsId[j]].y >= 368 and getTeamsLifes[3] >= 1 and i == 3 and not lostLife then
          lostLife = true
          getTeamsLifes[3] = getTeamsLifes[3] - 1
          if getTeamsLifes[3] == 0 then
            ballOnGame = false
            ballOnGame2 = false
            updateTwoBallOnGame()
            for j = 1, #teamsPlayersOnGame[i] do
              tfm.exec.setNameColor(teamsPlayersOnGame[i][j].name, 0xD1D5DB)
              tfm.exec.movePlayer(teamsPlayersOnGame[i][j].name, 391, 74)
              playerInGame[teamsPlayersOnGame[i][j].name] = false
              teamsPlayersOnGame[i][j].name = ''
            end
            tfm.exec.chatMessage(messageTeamsLifes[3], nil)
            print(messageTeamsLifes[3])
            toggleMapType()
            updateTeamsColors(3)
            gameStats.canTransform = false
            disablePlayersCanTransform(4000)
            delayToToggleMap = addTimer(function(i)
              if i == 1 then
                toggleMap()
              end
            end, 3000, 1, "delayToToggleMap")
            return
          end
          
          tfm.exec.chatMessage(messageTeamsLostOneLife[3], nil)
          print(messageTeamsLostOneLife[3])
          tfm.exec.chatMessage(""..messageTeamsLifesTextChat[1].." "..getTeamsLifes[1].." | "..messageTeamsLifesTextChat[2].." "..getTeamsLifes[2].." | "..messageTeamsLifesTextChat[3].." "..getTeamsLifes[3].."", nil)
          print(""..messageTeamsLifesTextChat[1].." "..getTeamsLifes[1].." | "..messageTeamsLifesTextChat[2].." "..getTeamsLifes[2].." | "..messageTeamsLifesTextChat[3].." "..getTeamsLifes[3].."")
          local ballSpawnX = 0
          local ballSpawnY = 0
          
          if #spawnBallArea1200 ~= 0 then
            randomIndex = math.random(1, #spawnBallArea1200)
            ballSpawnX = spawnBallArea1200[randomIndex].x
            ballSpawnY = spawnBallArea1200[randomIndex].y
            spawnBall(ballSpawnX, j, ballSpawnY)
          else
            spawnBall(1000, j)
          end
          showTheScore()
        end
      end
    elseif gameStats.typeMap == "small" and ballOnGameTwoBalls[j] and ballsId[j] ~= nil then
      for i = 1, #getTeamsLifes do
        if tfm.get.room.objectList[ballsId[j]].x <= 399 and tfm.get.room.objectList[ballsId[j]].y >= 368 and getTeamsLifes[1] >= 1 and i == 1 and not lostLife then
          lostLife = true
          getTeamsLifes[1] = getTeamsLifes[1] - 1
          if getTeamsLifes[1] == 0 then
            for j = 1, #teamsPlayersOnGame[i] do
              tfm.exec.setNameColor(teamsPlayersOnGame[i][j].name, 0xD1D5DB)
              tfm.exec.movePlayer(teamsPlayersOnGame[i][j].name, 391, 74)
              playerInGame[teamsPlayersOnGame[i][j].name] = false
              teamsPlayersOnGame[i][j].name = ''
            end
            print(teamsPlayersOnGame)
            print(messageTeamsLifes[1])
            tfm.exec.chatMessage(messageTeamsLifes[1], nil)
            showTheScore()
            updateTeamsColors(1)
            showMessageWinner()
            ballOnGame = false
            ballOnGame2 = false
            fourTeamsModeWinner(messageTeamsLifes[1], teamsPlayersOnGame[1])
            updateRankingFourTeamsMode()
            updateTwoBallOnGame()
            
            tfm.exec.removeObject (ballsId[j])
            mode = "endGame"
            gameTimeEnd = os.time() + 5000
            return
          end
          tfm.exec.chatMessage(messageTeamsLostOneLife[1], nil)
          print(messageTeamsLostOneLife[1])
          tfm.exec.chatMessage(""..messageTeamsLifesTextChat[1].." "..getTeamsLifes[1].." | "..messageTeamsLifesTextChat[2].." "..getTeamsLifes[2].."", nil)
          print(""..messageTeamsLifesTextChat[1].." "..getTeamsLifes[1].." | "..messageTeamsLifesTextChat[2].." "..getTeamsLifes[2].."")
          local ballSpawnX = 0
          local ballSpawnY = 0
          
          if #spawnBallArea400 ~= 0 then
            randomIndex = math.random(1, #spawnBallArea400)
            ballSpawnX = spawnBallArea400[randomIndex].x
            ballSpawnY = spawnBallArea400[randomIndex].y
            spawnBall(ballSpawnX, j, ballSpawnY)
          else
            spawnBall(200, j)
          end
          showTheScore()
        elseif tfm.get.room.objectList[ballsId[j]].x >= 401 and tfm.get.room.objectList[ballsId[j]].y >= 368 and getTeamsLifes[2] >= 1 and i == 2 and not lostLife then
          lostLife = true
          getTeamsLifes[2] = getTeamsLifes[2] - 1
          if getTeamsLifes[2] == 0 then
            for j = 1, #teamsPlayersOnGame[i] do
              tfm.exec.setNameColor(teamsPlayersOnGame[i][j].name, 0xD1D5DB)
              tfm.exec.movePlayer(teamsPlayersOnGame[i][j].name, 391, 74)
              playerInGame[teamsPlayersOnGame[i][j].name] = false
              teamsPlayersOnGame[i][j].name = ''
            end
            tfm.exec.chatMessage(messageTeamsLifes[2], nil)
            print(messageTeamsLifes[2])
            showTheScore()
            updateTeamsColors(2)
            showMessageWinner()
            ballOnGame = false
            ballOnGame2 = false
            fourTeamsModeWinner(messageTeamsLifes[1], teamsPlayersOnGame[1])
            updateRankingFourTeamsMode()
            updateTwoBallOnGame()
            tfm.exec.removeObject (ballsId[j])
            mode = "endGame"
            gameTimeEnd = os.time() + 5000
            return
          end
          tfm.exec.chatMessage(messageTeamsLostOneLife[2], nil)
          print(messageTeamsLostOneLife[2])
          tfm.exec.chatMessage(""..messageTeamsLifesTextChat[1].." "..getTeamsLifes[1].." | "..messageTeamsLifesTextChat[2].." "..getTeamsLifes[2].."", nil)
          print(""..messageTeamsLifesTextChat[1].." "..getTeamsLifes[1].." | "..messageTeamsLifesTextChat[2].." "..getTeamsLifes[2].."")
          local ballSpawnX = 0
          local ballSpawnY = 0
          
          if #spawnBallArea800 ~= 0 then
            randomIndex = math.random(1, #spawnBallArea800)
            ballSpawnX = spawnBallArea800[randomIndex].x
            ballSpawnY = spawnBallArea800[randomIndex].y
            spawnBall(ballSpawnX, j, ballSpawnY)
          else
            spawnBall(600, j)
          end
          showTheScore()
        end
      end
    end
  end
end


--[[ src/functions/game/verifyIsPoint/verifyIsPoint.lua ]]--

function verifyIsPoint()
  verifyBallCoordinates = addTimer(function(i)
    if gameStats.teamsMode and ballOnGame then
      setLostLife()
      
      return
    end

    if gameStats.threeTeamsMode then
      verifyIsPointThreeTeamsMode()
      
      return
    end
    
    if gameStats.twoTeamsMode and ballOnGame then
      verifyIsPointTwoTeamsMode()
      
      return
    end
    if gameStats.realMode and ballOnGame then
      verifyIsPointRealMode()
      
      return
    end
    
    local quantityBalls = 1
    
    if gameStats.twoBalls then
      quantityBalls = 2
    end
    
    for j = 1, quantityBalls do
      if ballOnGameTwoBalls[j] and ballsId[j] ~= nil then
        if tfm.get.room.objectList[ballsId[j]].x <= gameStats.redX and tfm.get.room.objectList[ballsId[j]].y >= 368 then
          score_blue = score_blue + 1
          tfm.exec.chatMessage("<bv>Team Blue scored!<n>", nil)
          tfm.exec.chatMessage("<r>Team Red<n> "..score_red.." X "..score_blue.." <bv>Team Blue<n>", nil)
          if score_blue >= gameStats.winscore then
            ballOnGame = false
            ballOnGame2 = false
            updateTwoBallOnGame()
            tfm.exec.removeObject(ballsId[j])
            showTheScore()
            showMessageWinner()
            normalModeTeamWinner("blue")
            updateRankingNormalMode()
            mode = "endGame"
            gameTimeEnd = os.time() + 5000
          else
            if gameStats.gameMode == "3v3" then
              if #spawnBallArea800 ~= 0 then
                randomIndex = math.random(1, #spawnBallArea800)
                ballSpawnX = spawnBallArea800[randomIndex].x
                ballSpawnY = spawnBallArea800[randomIndex].y
                spawnBall(ballSpawnX, j, ballSpawnY)
              else
                spawnBall(600, j)
              end
            elseif gameStats.gameMode == "4v4" then
              if #spawnBallArea1600 ~= 0 then
                randomIndex = math.random(1, #spawnBallArea1600)
                ballSpawnX = spawnBallArea1600[randomIndex].x
                ballSpawnY = spawnBallArea1600[randomIndex].y
                spawnBall(ballSpawnX, j, ballSpawnY)
              else
                spawnBall(800, j)
              end
            else
              spawnBall(1400, j)
            end
          end
        elseif tfm.get.room.objectList[ballsId[j]].x >= gameStats.blueX and tfm.get.room.objectList[ballsId[j]].y >= 368 then
          score_red = score_red + 1
          tfm.exec.chatMessage("<r>Team Red scored!<n>", nil)
          tfm.exec.chatMessage("<r>Team Red<n> "..score_red.." X "..score_blue.." <bv>Team Blue<n>", nil)
          if score_red >= gameStats.winscore then
            showTheScore()
            showMessageWinner()
            ballOnGame = false
            ballOnGame2 = false
            updateTwoBallOnGame()
            tfm.exec.removeObject(ballsId[j])
            normalModeTeamWinner("red")
            updateRankingNormalMode()
            mode = "endGame"
            gameTimeEnd = os.time() + 5000
          else
            if gameStats.gameMode == "3v3" then
              if #spawnBallArea400 ~= 0 then
                randomIndex = math.random(1, #spawnBallArea400)
                ballSpawnX = spawnBallArea400[randomIndex].x
                ballSpawnY = spawnBallArea400[randomIndex].y
                spawnBall(ballSpawnX, j, ballSpawnY)
              else
                spawnBall(200, j)
              end
            elseif gameStats.gameMode == "4v4" then
              if #spawnBallArea800 ~= 0 then
                randomIndex = math.random(1, #spawnBallArea800)
                ballSpawnX = spawnBallArea800[randomIndex].x
                ballSpawnY = spawnBallArea800[randomIndex].y
                spawnBall(ballSpawnX, j, ballSpawnY)
              else
                spawnBall(400, j)
              end
            else
              spawnBall(400, j)
            end
          end
        end
      end
    end
  end, 5000, 0, "verifyBallCoordinates")
end


--[[ src/functions/game/verifyIsPoint/verifyIsPointRealMode.lua ]]--

function verifyIsPointRealMode()
  local ballX = tfm.get.room.objectList[ball_id].x
  local ballY = tfm.get.room.objectList[ball_id].y
  
  resetQuantityTeams()
  
  if ballX <= 599 and ballY >= 368 then
    if gameStats.redQuantitySpawn > 0 or gameStats.redServe then
      gameStats.aceRed = false
      score_blue = score_blue + 1
      tfm.exec.chatMessage("<bv>Team Blue scored!<n>", nil)
    else
      gameStats.aceBlue = false
      score_red = score_red + 1
      tfm.exec.chatMessage("<r>Team Red scored!<n>", nil)
    end
    tfm.exec.chatMessage("<r>Team Red<n> "..score_red.." X "..score_blue.." <bv>Team Blue<n>", nil)
    if score_red >= gameStats.winscore or score_blue >= gameStats.winscore then
      showTheScore()
      showMessageWinner()
      ballOnGame = false
      tfm.exec.removeObject (ball_id)
      if gameStats.redQuantitySpawn > 0 or gameStats.redServe then
        realModeWinner("blue")
      else
        realModeWinner("red")
      end
      updateRankingRealMode()
      mode = "endGame"
      gameTimeEnd = os.time() + 5000
    else
      ballOnGame = false
      if gameStats.redQuantitySpawn > 0 or gameStats.redServe then
        gameStats.canTransform = false
        local delayTeleport = addTimer(function(i)
          if i == 1 then
            choosePlayerServe("blue")
            teamServe("blue")
          end
        end, 4000, 1, "delayTeleport")
        
        local delaySpawnBall = addTimer(function(i)
          if i == 1 then
            spawnBallRealMode("blue")
          end
        end, 6000, 1, "delaySpawnBall")
      else
        gameStats.canTransform = false
        local delayTeleport = addTimer(function(i)
          if i == 1 then
            choosePlayerServe("red")
            teamServe("red")
          end
        end, 4000, 1, "delayTeleport")
        
        local delaySpawnBall = addTimer(function(i)
          if i == 1 then
            spawnBallRealMode("red")
          end
        end, 6000, 1, "delaySpawnBall")
      end
    end
    showTheScore()
    return
  elseif ballX >= gameStats.redX and ballX <= 1299 and ballY >= 368 then
    score_blue = score_blue + 1
    gameStats.aceRed = false
    tfm.exec.chatMessage("<bv>Team Blue scored!<n>", nil)
    tfm.exec.chatMessage("<r>Team Red<n> "..score_red.." X "..score_blue.." <bv>Team Blue<n>", nil)
    if score_blue >= gameStats.winscore then
      ballOnGame = false
      tfm.exec.removeObject (ball_id)
      showTheScore()
      showMessageWinner()
      realModeWinner("blue")
      updateRankingRealMode()
      mode = "endGame"
      gameTimeEnd = os.time() + 5000
    else
      ballOnGame = false
      gameStats.canTransform = false
      local delayTeleport = addTimer(function(i)
        if i == 1 then
          choosePlayerServe("blue")
          teamServe("blue")
        end
      end, 4000, 1, "delayTeleport")
      
      local delaySpawnBall = addTimer(function(i)
        if i == 1 then
          spawnBallRealMode("blue")
        end
      end, 6000, 1, "delaySpawnBall")
    end
    showTheScore()
    return
  elseif ballX >= 1301 and ballX <= gameStats.blueX and ballY >= 368 then
    score_red = score_red + 1
    gameStats.aceBlue = false
    tfm.exec.chatMessage("<r>Team Red scored!<n>", nil)
    tfm.exec.chatMessage("<r>Team Red<n> "..score_red.." X "..score_blue.." <bv>Team Blue<n>", nil)
    if score_red >= gameStats.winscore then
      showTheScore()
      showMessageWinner()
      realModeWinner("red")
      updateRankingRealMode()
      ballOnGame = false
      tfm.exec.removeObject (ball_id)
      mode = "endGame"
      gameTimeEnd = os.time() + 5000
    else
      ballOnGame = false
      gameStats.canTransform = false
      local delayTeleport = addTimer(function(i)
        if i == 1 then
          choosePlayerServe("red")
          teamServe("red")
        end
      end, 4000, 1, "delayTeleport")
      
      local delaySpawnBall = addTimer(function(i)
        if i == 1 then
          spawnBallRealMode("red")
        end
      end, 6000, 1, "delaySpawnBall")
    end
    showTheScore()
    return
  elseif ballX >= 2001 and ballY >= 368 then
    if gameStats.blueQuantitySpawn > 0 or gameStats.blueServe then
      gameStats.aceBlue = false
      score_red = score_red + 1
      tfm.exec.chatMessage("<r>Team Red scored!<n>", nil)
    else
      gameStats.aceRed = false
      score_blue = score_blue + 1
      tfm.exec.chatMessage("<bv>Team Blue scored!<n>", nil)
    end
    
    tfm.exec.chatMessage("<r>Team Red<n> "..score_red.." X "..score_blue.." <bv>Team Blue<n>", nil)
    if score_blue >= gameStats.winscore or score_red >= gameStats.winscore then
      ballOnGame = false
      tfm.exec.removeObject (ball_id)
      showTheScore()
      showMessageWinner()
      if gameStats.blueQuantitySpawn > 0 or gameStats.blueServe then
        realModeWinner("red")
      else
        realModeWinner("blue")
      end
      updateRankingRealMode()
      mode = "endGame"
      gameTimeEnd = os.time() + 5000
    else
      ballOnGame = false
      if gameStats.blueQuantitySpawn > 0 or gameStats.blueServe then
        gameStats.canTransform = false
        local delayTeleport = addTimer(function(i)
          if i == 1 then
            choosePlayerServe("red")
            teamServe("red")
          end
        end, 4000, 1, "delayTeleport")
        
        local delaySpawnBall = addTimer(function(i)
          if i == 1 then
            spawnBallRealMode("red")
          end
        end, 6000, 1, "delaySpawnBall")
      else
        gameStats.canTransform = false
        local delayTeleport = addTimer(function(i)
          if i == 1 then
            choosePlayerServe("blue")
            teamServe("blue")
          end
        end, 4000, 1, "delayTeleport")
        
        local delaySpawnBall = addTimer(function(i)
          if i == 1 then
            spawnBallRealMode("blue")
          end
        end, 6000, 1, "delaySpawnBall")
      end
    end
    showTheScore()
    return
  end
end


--[[ src/functions/game/verifyIsPoint/verifyIsPointThreeTeamsMode.lua ]]--

function verifyIsPointThreeTeamsMode()
  local quantityBalls = 1
  
  if gameStats.twoBalls then
    quantityBalls = 2
  end

  if gameStats.threeBalls then
    quantityBalls = 3
  end
  
  for j = 1, quantityBalls do
    local onCondition = false
    local lostLife = false
    
    print(ballsId[j])
    print(ballOnGameTwoBalls[j])
    print('===')
    if gameStats.typeMap == "large4v4" and ballOnGameTwoBalls[j] and ballsId[j] ~= nil then
      if tfm.get.room.objectList[ballsId[j]].x <= gameStats.redX and tfm.get.room.objectList[ballsId[j]].y >= 368 and teamsLifes[2].red >= 1 and not onCondition and not lostLife then
        lostLife = true
        onCondition = true
        teamsLifes[2].red = teamsLifes[2].red - 1
        if teamsLifes[2].red == 0 then
          ballOnGame = false
          ballOnGame2 = false
          ballOnGame3 = false
          updateTwoBallOnGame()
          for i = 1, #playersRed do
            tfm.exec.setNameColor(playersRed[i].name, 0xD1D5DB)
            tfm.exec.movePlayer(playersRed[i].name, 391, 74)
            playerInGame[playersRed[i].name] = false
            playersRed[i].name = ''
          end
          tfm.exec.chatMessage("<r>Red team lost all their lives<n>", nil)
          toggleMapType()
          updateTeamsColors(1)
          gameStats.canTransform = false
          disablePlayersCanTransform(4000)
          delayToToggleMap = addTimer(function(i)
            if i == 1 then
              toggleMap()
            end
          end, 3000, 1, "delayToToggleMap")
          return
        end
        local ballSpawnX = 0
        local ballSpawnY = 0
        
        tfm.exec.chatMessage("<r>Red team lost a life<n>", nil)
        tfm.exec.chatMessage("<r>Team Red<n> "..teamsLifes[2].red.." | <bv>Team Blue<n> "..teamsLifes[3].blue.." | <vp>Team Green<n> "..teamsLifes[4].green.."", nil)
        print("<r>Team Red<n> "..teamsLifes[2].red.." | <bv>Team Blue<n> "..teamsLifes[3].blue.." | <vp>Team Green<n> "..teamsLifes[4].green.."")
        if #spawnBallArea400 ~= 0 then
          randomIndex = math.random(1, #spawnBallArea400)
          ballSpawnX = spawnBallArea400[randomIndex].x
          ballSpawnY = spawnBallArea400[randomIndex].y
          spawnBall(ballSpawnX, j, ballSpawnY)
        else
          spawnBall(300, j)
        end
        showTheScore()
      elseif tfm.get.room.objectList[ballsId[j]].x <= gameStats.blueX and tfm.get.room.objectList[ballsId[j]].y >= 368 and teamsLifes[3].blue >= 1 and not onCondition and not lostLife then
        lostLife = true
        onCondition = true
        teamsLifes[3].blue = teamsLifes[3].blue - 1
        if teamsLifes[3].blue == 0 then
          ballOnGame = false
          ballOnGame2 = false
          ballOnGame3 = false
          updateTwoBallOnGame()
          for i = 1, #playersBlue do
            tfm.exec.setNameColor(playersBlue[i].name, 0xD1D5DB)
            tfm.exec.movePlayer(playersBlue[i].name, 391, 74)
            playerInGame[playersBlue[i].name] = false
            playersBlue[i].name = ''
          end
          tfm.exec.chatMessage("<bv>Blue team lost all their lives<n>", nil)
          toggleMapType()
          updateTeamsColors(2)
          gameStats.canTransform = false
          disablePlayersCanTransform(4000)
          delayToToggleMap = addTimer(function(i)
            if i == 1 then
              toggleMap()
            end
          end, 3000, 1, "delayToToggleMap")
          return
        end
        tfm.exec.chatMessage("<bv>Blue team lost a life<n>", nil)
        tfm.exec.chatMessage("<r>Team Red<n> "..teamsLifes[2].red.." | <bv>Team Blue<n> "..teamsLifes[3].blue.." | <vp>Team Green<n> "..teamsLifes[4].green.."", nil)
        print("<r>Team Red<n> "..teamsLifes[2].red.." | <bv>Team Blue<n> "..teamsLifes[3].blue.." | <vp>Team Green<n> "..teamsLifes[4].green.."")
        local ballSpawnX = 0
        local ballSpawnY = 0
        if #spawnBallArea800 ~= 0 then
          randomIndex = math.random(1, #spawnBallArea800)
          ballSpawnX = spawnBallArea800[randomIndex].x
          ballSpawnY = spawnBallArea800[randomIndex].y
          spawnBall(ballSpawnX, j, ballSpawnY)
        else
          spawnBall(900, j)
        end
        
        showTheScore()
      elseif tfm.get.room.objectList[ballsId[j]].x >= gameStats.greenX and tfm.get.room.objectList[ballsId[j]].y >= 368 and teamsLifes[4].green >= 1 and not onCondition and not lostLife then
        lostLife = true
        onCondition = true
        teamsLifes[4].green = teamsLifes[4].green - 1
        if teamsLifes[4].green == 0 then
          ballOnGame = false
          ballOnGame2 = false
          ballOnGame3 = false
          updateTwoBallOnGame()
          for i = 1, #playersGreen do
            tfm.exec.setNameColor(playersGreen[i].name, 0xD1D5DB)
            tfm.exec.movePlayer(playersGreen[i].name, 391, 74)
            playerInGame[playersGreen[i].name] = false
            playersGreen[i].name = ''
          end
          tfm.exec.chatMessage("<vp>Green team lost all their lives<n>", nil)
          toggleMapType()
          updateTeamsColors(3)
          gameStats.canTransform = false
          disablePlayersCanTransform(4000)
          delayToToggleMap = addTimer(function(i)
            if i == 1 then
              toggleMap()
            end
          end, 3000, 1, "delayToToggleMap")
          return
        end
        local ballSpawnX = 0
        local ballSpawnY = 0
        
        tfm.exec.chatMessage("<vp>Green team lost a life<n>", nil)
        tfm.exec.chatMessage("<r>Team Red<n> "..teamsLifes[2].red.." | <bv>Team Blue<n> "..teamsLifes[3].blue.." | <vp>Team Green<n> "..teamsLifes[4].green.."", nil)
        print("<r>Team Red<n> "..teamsLifes[2].red.." | <bv>Team Blue<n> "..teamsLifes[3].blue.." | <vp>Team Green<n> "..teamsLifes[4].green.."")
        if #spawnBallArea1200 ~= 0 then
          randomIndex = math.random(1, #spawnBallArea1200)
          ballSpawnX = spawnBallArea1200[randomIndex].x
          ballSpawnY = spawnBallArea1200[randomIndex].y
          spawnBall(ballSpawnX, j, ballSpawnY)
        else
          spawnBall(1500, j)
        end
        showTheScore()
      end
    elseif gameStats.typeMap == "large3v3" and ballOnGameTwoBalls[j] and ballsId[j] ~= nil then
      for i = 1, #getTeamsLifes do
        if tfm.get.room.objectList[ballsId[j]].x <= 599 and tfm.get.room.objectList[ballsId[j]].y >= 368 and getTeamsLifes[1] >= 1 and i == 1 and not lostLife then
          lostLife = true
          getTeamsLifes[1] = getTeamsLifes[1] - 1
          if getTeamsLifes[1] == 0 then
            for j = 1, #teamsPlayersOnGame[i] do
              tfm.exec.setNameColor(teamsPlayersOnGame[i][j].name, 0xD1D5DB)
              tfm.exec.movePlayer(teamsPlayersOnGame[i][j].name, 391, 74)
              playerInGame[teamsPlayersOnGame[i][j].name] = false
              teamsPlayersOnGame[i][j].name = ''
            end
            print(teamsPlayersOnGame)
            print(messageTeamsLifes[1])
            tfm.exec.chatMessage(messageTeamsLifes[1], nil)
            showTheScore()
            updateTeamsColors(1)
            showMessageWinner()
            ballOnGame = false
            ballOnGame2 = false
            ballOnGame3 = false
            threeTeamsModeWinner(messageTeamsLifes[1], teamsPlayersOnGame[1])
            updateRankingThreeTeamsMode()
            updateTwoBallOnGame()
            
            tfm.exec.removeObject (ballsId[j])
            mode = "endGame"
            gameTimeEnd = os.time() + 5000
            return
          end
          tfm.exec.chatMessage(messageTeamsLostOneLife[1], nil)
          print(messageTeamsLostOneLife[1])
          tfm.exec.chatMessage(""..messageTeamsLifesTextChat[1].." "..getTeamsLifes[1].." | "..messageTeamsLifesTextChat[2].." "..getTeamsLifes[2].."", nil)
          print(""..messageTeamsLifesTextChat[1].." "..getTeamsLifes[1].." | "..messageTeamsLifesTextChat[2].." "..getTeamsLifes[2].."")
          
          local ballSpawnX = 0
          local ballSpawnY = 0
          
          if #spawnBallArea400 ~= 0 then
            randomIndex = math.random(1, #spawnBallArea400)
            ballSpawnX = spawnBallArea400[randomIndex].x
            ballSpawnY = spawnBallArea400[randomIndex].y
            spawnBall(ballSpawnX, j, ballSpawnY)
          else
            spawnBall(300, j)
          end
          showTheScore()
        elseif tfm.get.room.objectList[ballsId[j]].x >= 601 and tfm.get.room.objectList[ballsId[j]].y >= 368 and getTeamsLifes[2] >= 1 and i == 2 and not lostLife then
          lostLife = true
          getTeamsLifes[2] = getTeamsLifes[2] - 1
          if getTeamsLifes[2] == 0 then
            for j = 1, #teamsPlayersOnGame[i] do
              tfm.exec.setNameColor(teamsPlayersOnGame[i][j].name, 0xD1D5DB)
              tfm.exec.movePlayer(teamsPlayersOnGame[i][j].name, 391, 74)
              playerInGame[teamsPlayersOnGame[i][j].name] = false
              teamsPlayersOnGame[i][j].name = ''
            end
            tfm.exec.chatMessage(messageTeamsLifes[2], nil)
            print(messageTeamsLifes[2])
            showTheScore()
            updateTeamsColors(2)
            showMessageWinner()
            ballOnGame = false
            ballOnGame2 = false
            ballOnGame3 = false
            threeTeamsModeWinner(messageTeamsLifes[1], teamsPlayersOnGame[1])
            updateRankingThreeTeamsMode()
            updateTwoBallOnGame()
            tfm.exec.removeObject (ballsId[j])
            mode = "endGame"
            gameTimeEnd = os.time() + 5000
            return
          end
          tfm.exec.chatMessage(messageTeamsLostOneLife[2], nil)
          print(messageTeamsLostOneLife[2])
          tfm.exec.chatMessage(""..messageTeamsLifesTextChat[1].." "..getTeamsLifes[1].." | "..messageTeamsLifesTextChat[2].." "..getTeamsLifes[2].."", nil)
          print(""..messageTeamsLifesTextChat[1].." "..getTeamsLifes[1].." | "..messageTeamsLifesTextChat[2].." "..getTeamsLifes[2].."")
          
          local ballSpawnX = 0
          local ballSpawnY = 0
          
          if #spawnBallArea800 ~= 0 then
            randomIndex = math.random(1, #spawnBallArea800)
            ballSpawnX = spawnBallArea800[randomIndex].x
            ballSpawnY = spawnBallArea800[randomIndex].y
            spawnBall(ballSpawnX, j, ballSpawnY)
          else
            spawnBall(900, j)
          end
          showTheScore()
        end
      end
    end
  end
end


--[[ src/functions/game/verifyIsPoint/verifyIsPointTwoTeamMode.lua ]]--

function verifyIsPointTwoTeamsMode()
  
  local quantityBalls = 1
  
  if gameStats.twoBalls then
    quantityBalls = 2
  end
  
  for j = 1, quantityBalls do
    if ballOnGameTwoBalls[j] and ballsId[j] ~= nil then
      if tfm.get.room.objectList[ballsId[j]].x <= gameStats.blueX and tfm.get.room.objectList[ballsId[j]].y >= 368 then
        score_red = score_red + 1
        tfm.exec.chatMessage("<r>Team Red scored!<n>", nil)
        tfm.exec.chatMessage("<r>Team Red<n> "..score_red.." X "..score_blue.." <bv>Team Blue<n>", nil)
        if score_red >= gameStats.winscore then
          showTheScore()
          showMessageWinner()
          ballOnGame = false
          ballOnGame2 = false
          updateTwoBallOnGame()
          twoTeamsModeWinner("red")
          updateRankingTwoTeamsMode()
          tfm.exec.removeObject (ballsId[j])
          mode = "endGame"
          gameTimeEnd = os.time() + 5000
        else
          if #spawnBallArea800 ~= 0 then
            randomIndex = math.random(1, #spawnBallArea800)
            ballSpawnX = spawnBallArea800[randomIndex].x
            ballSpawnY = spawnBallArea800[randomIndex].y
            spawnBall(ballSpawnX, j, ballSpawnY)
          else
            spawnBall(600, j)
          end
        end
        showTheScore()
      elseif tfm.get.room.objectList[ballsId[j]].x <= gameStats.redX and tfm.get.room.objectList[ballsId[j]].y >= 368 then
        score_blue = score_blue + 1
        tfm.exec.chatMessage("<bv>Team Blue scored!<n>", nil)
        tfm.exec.chatMessage("<r>Team Red<n> "..score_red.." X "..score_blue.." <bv>Team Blue<n>", nil)
        if score_blue >= gameStats.winscore then
          ballOnGame = false
          ballOnGame2 = false
          updateTwoBallOnGame()
          twoTeamsModeWinner("blue")
          updateRankingTwoTeamsMode()
          tfm.exec.removeObject (ballsId[j])
          showTheScore()
          showMessageWinner()
          mode = "endGame"
          gameTimeEnd = os.time() + 5000
        else
          if #spawnBallArea400 ~= 0 then
            randomIndex = math.random(1, #spawnBallArea400)
            ballSpawnX = spawnBallArea400[randomIndex].x
            ballSpawnY = spawnBallArea400[randomIndex].y
            spawnBall(ballSpawnX, j, ballSpawnY)
          else
            spawnBall(200, j)
          end
        end
        showTheScore()
      elseif tfm.get.room.objectList[ballsId[j]].x <= gameStats.blueX2 and tfm.get.room.objectList[ballsId[j]].y >= 368 then
        score_red = score_red + 1
        tfm.exec.chatMessage("<r>Team Red scored!<n>", nil)
        tfm.exec.chatMessage("<r>Team Red<n> "..score_red.." X "..score_blue.." <bv>Team Blue<n>", nil)
        if score_red >= gameStats.winscore then
          showTheScore()
          showMessageWinner()
          ballOnGame = false
          ballOnGame2 = false
          updateTwoBallOnGame()
          twoTeamsModeWinner("red")
          updateRankingTwoTeamsMode()
          tfm.exec.removeObject (ballsId[j])
          mode = "endGame"
          gameTimeEnd = os.time() + 5000
        else
          if #spawnBallArea1600 ~= 0 then
            randomIndex = math.random(1, #spawnBallArea1600)
            ballSpawnX = spawnBallArea1600[randomIndex].x
            ballSpawnY = spawnBallArea1600[randomIndex].y
            spawnBall(ballSpawnX, j, ballSpawnY)
          else
            spawnBall(1400, j)
          end
        end
        showTheScore()
      elseif tfm.get.room.objectList[ballsId[j]].x >= gameStats.redX2 and tfm.get.room.objectList[ballsId[j]].y >= 368 then
        score_blue = score_blue + 1
        tfm.exec.chatMessage("<bv>Team Blue scored!<n>", nil)
        tfm.exec.chatMessage("<r>Team Red<n> "..score_red.." X "..score_blue.." <bv>Team Blue<n>", nil)
        if score_blue >= gameStats.winscore then
          ballOnGame = false
          ballOnGame2 = false
          updateTwoBallOnGame()
          twoTeamsModeWinner("blue")
          updateRankingTwoTeamsMode()
          tfm.exec.removeObject (ballsId[j])
          showTheScore()
          showMessageWinner()
          mode = "endGame"
          gameTimeEnd = os.time() + 5000
        else
          if #spawnBallArea1200 ~= 0 then
            randomIndex = math.random(1, #spawnBallArea1200)
            ballSpawnX = spawnBallArea1200[randomIndex].x
            ballSpawnY = spawnBallArea1200[randomIndex].y
            spawnBall(ballSpawnX, j, ballSpawnY)
          else
            spawnBall(1000, j)
          end
        end
        showTheScore()
      end
    end
  end
end


--[[ src/functions/ranking/addMatch/addMatchesToAllPlayers.lua ]]--

function addMatchesToAllPlayers()
  local mode = verifyMode()

  if mode == "Normal mode" then
    for name, value in pairs(playerInGame) do
      if value then
        playersNormalMode[name].matches = playersNormalMode[name].matches + 1
        playersNormalMode[name].winRatio = winRatioPercentage(playersNormalMode[name].wins, playersNormalMode[name].matches)
      end
    end
  elseif mode == "4 teams mode" then
    for name, value in pairs(playerInGame) do
      if value then
        playersFourTeamsMode[name].matches = playersFourTeamsMode[name].matches + 1
        playersFourTeamsMode[name].winRatio = winRatioPercentage(playersFourTeamsMode[name].wins, playersFourTeamsMode[name].matches)
      end
    end
  elseif mode == "3 teams mode" then
    for name, value in pairs(playerInGame) do
      if value then
        playersThreeTeamsMode[name].matches = playersThreeTeamsMode[name].matches + 1
        playersThreeTeamsMode[name].winRatio = winRatioPercentage(playersThreeTeamsMode[name].wins, playersThreeTeamsMode[name].matches)
      end
    end
  elseif mode == "2 teams mode" then
    for name, value in pairs(playerInGame) do
      if value then
        playersTwoTeamsMode[name].matches = playersTwoTeamsMode[name].matches + 1
        playersTwoTeamsMode[name].winRatio = winRatioPercentage(playersTwoTeamsMode[name].wins, playersTwoTeamsMode[name].matches)
      end
    end
  elseif mode == "Real mode" then
    for name, value in pairs(playerInGame) do
      if value then
        playersRealMode[name].matches = playersRealMode[name].matches + 1
        playersRealMode[name].winRatio = winRatioPercentage(playersRealMode[name].wins, playersRealMode[name].matches)
      end
    end
  end
end



--[[ src/functions/ranking/addMatch/addMatchToPlayer.lua ]]--

function addMatchToPlayer(name)
  playersNormalMode[name].matches = playersNormalMode[name].matches + 1
  playersNormalMode[name].winRatio = winRatioPercentage(playersNormalMode[name].wins, playersNormalMode[name].matches)
end


--[[ src/functions/ranking/addMatch/addMatchToPlayerFourTeamsMode.lua ]]--

function addMatchToPlayerFourTeamsMode(name)
  playersFourTeamsMode[name].matches = playersFourTeamsMode[name].matches + 1
  playersFourTeamsMode[name].winRatio = winRatioPercentage(playersFourTeamsMode[name].wins, playersFourTeamsMode[name].matches)
end


--[[ src/functions/ranking/addMatch/addMatchToPlayerRealMode.lua ]]--

function addMatchToPlayerRealMode(name)
  playersRealMode[name].matches = playersRealMode[name].matches + 1
  playersRealMode[name].winRatio = winRatioPercentage(playersRealMode[name].wins, playersRealMode[name].matches)
end


--[[ src/functions/ranking/addMatch/addMatchToPlayerThreeTeamsMode.lua ]]--

function addMatchToPlayerThreeTeamsMode(name)
  playersThreeTeamsMode[name].matches = playersThreeTeamsMode[name].matches + 1
  playersThreeTeamsMode[name].winRatio = winRatioPercentage(playersThreeTeamsMode[name].wins, playersThreeTeamsMode[name].matches)
end


--[[ src/functions/ranking/addMatch/addMatchToPlayerTwoTeamsMode.lua ]]--

function addMatchToPlayerTwoTeamsMode(name)
  playersTwoTeamsMode[name].matches = playersTwoTeamsMode[name].matches + 1
  playersTwoTeamsMode[name].winRatio = winRatioPercentage(playersTwoTeamsMode[name].wins, playersTwoTeamsMode[name].matches)
end


--[[ src/functions/ranking/addWin/fourTeamsModeWinner.lua ]]--

function fourTeamsModeWinner(teamText, playersOnTeam)
  local team = getTeamName(teamText)

  if team == "Yellow" then
    for i = 1, #playersOnTeam do
      local player = playersOnTeam[i].name

      if player ~= 'a' and player ~= '' then
        playersFourTeamsMode[player].wins = playersFourTeamsMode[player].wins + 1
        playersFourTeamsMode[player].winRatio = winRatioPercentage(playersFourTeamsMode[player].wins, playersFourTeamsMode[player].matches)
        playersFourTeamsMode[player].winsYellow = playersFourTeamsMode[player].winsYellow + 1
      end
    end

    return
  elseif team == "Red" then
    for i = 1, #playersOnTeam do
      local player = playersOnTeam[i].name

      if player ~= 'a' and player ~= '' then
        playersFourTeamsMode[player].wins = playersFourTeamsMode[player].wins + 1
        playersFourTeamsMode[player].winRatio = winRatioPercentage(playersFourTeamsMode[player].wins, playersFourTeamsMode[player].matches)
        playersFourTeamsMode[player].winsRed = playersFourTeamsMode[player].winsRed + 1
      end
    end

    return
  elseif team == "Blue" then
    for i = 1, #playersOnTeam do
      local player = playersOnTeam[i].name

      if player ~= 'a' and player ~= '' then
        playersFourTeamsMode[player].wins = playersFourTeamsMode[player].wins + 1
        playersFourTeamsMode[player].winRatio = winRatioPercentage(playersFourTeamsMode[player].wins, playersFourTeamsMode[player].matches)
        playersFourTeamsMode[player].winsBlue = playersFourTeamsMode[player].winsBlue + 1
      end
    end

    return
  elseif team == "Green" then
    for i = 1, #playersOnTeam do
      local player = playersOnTeam[i].name

      if player ~= 'a' and player ~= '' then
        playersFourTeamsMode[player].wins = playersFourTeamsMode[player].wins + 1
        playersFourTeamsMode[player].winRatio = winRatioPercentage(playersFourTeamsMode[player].wins, playersFourTeamsMode[player].matches)
        playersFourTeamsMode[player].winsGreen = playersFourTeamsMode[player].winsGreen + 1
      end
    end

    return
  end
end


--[[ src/functions/ranking/addWin/normalModeTeamWinner.lua ]]--

function normalModeTeamWinner(team)
  if team == "red" then
    for i = 1, #playersRed do
      local player = playersRed[i].name
      if player ~= "a" and player ~= '' then
        playersNormalMode[player].wins = playersNormalMode[player].wins + 1
        playersNormalMode[player].winRatio = winRatioPercentage(playersNormalMode[player].wins, playersNormalMode[player].matches)
        playersNormalMode[player].winsRed = playersNormalMode[player].winsRed + 1
      end
    end

    return
  end

  for i = 1, #playersBlue do
    local player = playersBlue[i].name

    if player ~= "a" and player ~= '' then
      playersNormalMode[player].wins = playersNormalMode[player].wins + 1
      playersNormalMode[player].winRatio = winRatioPercentage(playersNormalMode[player].wins, playersNormalMode[player].matches)
      playersNormalMode[player].winsBlue = playersNormalMode[player].winsBlue + 1
    end
  end
end


--[[ src/functions/ranking/addWin/realModeWinner.lua ]]--

function realModeWinner(team)
  if team == "red" then
    for i = 1, #playersRed do
      local player = playersRed[i].name
      if player ~= "a" and player ~= '' then
        playersRealMode[player].wins = playersRealMode[player].wins + 1
        playersRealMode[player].winRatio = winRatioPercentage(playersRealMode[player].wins, playersRealMode[player].matches)
        playersRealMode[player].winsRed = playersRealMode[player].winsRed + 1
      end
    end

    return
  end

  for i = 1, #playersBlue do
    local player = playersBlue[i].name

    if player ~= "a" and player ~= '' then
      playersRealMode[player].wins = playersRealMode[player].wins + 1
      playersRealMode[player].winRatio = winRatioPercentage(playersRealMode[player].wins, playersRealMode[player].matches)
      playersRealMode[player].winsBlue = playersRealMode[player].winsBlue + 1
    end
  end
end


--[[ src/functions/ranking/addWin/threeTeamsModeWinner.lua ]]--

function threeTeamsModeWinner(teamText, playersOnTeam)
  local team = getTeamName(teamText)

  if team == "Red" then
    for i = 1, #playersOnTeam do
      local player = playersOnTeam[i].name

      if player ~= 'a' and player ~= '' then
        playersThreeTeamsMode[player].wins = playersThreeTeamsMode[player].wins + 1
        playersThreeTeamsMode[player].winRatio = winRatioPercentage(playersThreeTeamsMode[player].wins, playersThreeTeamsMode[player].matches)
        playersThreeTeamsMode[player].winsRed = playersThreeTeamsMode[player].winsRed + 1
      end
    end

    return
  elseif team == "Blue" then
    for i = 1, #playersOnTeam do
      local player = playersOnTeam[i].name

      if player ~= 'a' and player ~= '' then
        playersThreeTeamsMode[player].wins = playersThreeTeamsMode[player].wins + 1
        playersThreeTeamsMode[player].winRatio = winRatioPercentage(playersThreeTeamsMode[player].wins, playersThreeTeamsMode[player].matches)
        playersThreeTeamsMode[player].winsBlue = playersThreeTeamsMode[player].winsBlue + 1
      end
    end

    return
  elseif team == "Green" then
    for i = 1, #playersOnTeam do
      local player = playersOnTeam[i].name

      if player ~= 'a' and player ~= '' then
        playersThreeTeamsMode[player].wins = playersThreeTeamsMode[player].wins + 1
        playersThreeTeamsMode[player].winRatio = winRatioPercentage(playersThreeTeamsMode[player].wins, playersThreeTeamsMode[player].matches)
        playersThreeTeamsMode[player].winsGreen = playersThreeTeamsMode[player].winsGreen + 1
      end
    end

    return
  end
end


--[[ src/functions/ranking/addWin/twoTeamsModeWinner.lua ]]--

function twoTeamsModeWinner(team)
  if team == "red" then
    for i = 1, #playersRed do
      local player = playersRed[i].name
      if player ~= "a" and player ~= '' then
        playersTwoTeamsMode[player].wins = playersTwoTeamsMode[player].wins + 1
        playersTwoTeamsMode[player].winRatio = winRatioPercentage(playersTwoTeamsMode[player].wins, playersTwoTeamsMode[player].matches)
        playersTwoTeamsMode[player].winsRed = playersTwoTeamsMode[player].winsRed + 1
      end
    end

    return
  end

  for i = 1, #playersBlue do
    local player = playersBlue[i].name

    if player ~= "a" and player ~= '' then
      playersTwoTeamsMode[player].wins = playersTwoTeamsMode[player].wins + 1
      playersTwoTeamsMode[player].winRatio = winRatioPercentage(playersTwoTeamsMode[player].wins, playersTwoTeamsMode[player].matches)
      playersTwoTeamsMode[player].winsBlue = playersTwoTeamsMode[player].winsBlue + 1
    end
  end
end


--[[ src/functions/ranking/playerHistoryOnMatch.lua ]]--

function playerHistoryOnMatch(team, name)
  local playerTeams = playersOnGameHistoric[name].teams
  local notFindSameTeam = true
  
  for i = 1, #playerTeams do
    if playerTeams[i] == team then
      notFindSameTeam = false
    end
  end
  
  if notFindSameTeam then
    return true
  end
  
  return false
end


--[[ src/functions/ranking/positions.lua ]]--

function positions(page)
  local positions = {}
  
  for i = 1, 10 do
    positions[#positions + 1] = i
  end
  
  return positions
end


--[[ src/functions/ranking/positionsString.lua ]]--

function positionsString(page)
  local positions = {}
  
  for i = 1, 10 do
    if i == 1 and page == 1 then
      positions[#positions + 1] = "<j>"..tostring( i + (10 * (page - 1)))..".<n>"
    elseif i == 2 and page == 1 then
      positions[#positions + 1] = "<n2>"..tostring( i + (10 * (page - 1)))..".<n>"
    elseif i == 3 and page == 1 then
      positions[#positions + 1] = "<ce>"..tostring( i + (10 * (page - 1)))..".<n>"
    else
      positions[#positions + 1] = "<n>"..tostring( i + (10 * (page - 1)))..".<n>"
    end
  end
  
  return positions
end


--[[ src/functions/ranking/rankMode.lua ]]--

function rankMode(mode)
  if mode == "Normal mode" then
    return rankNormalMode
  elseif mode == "4 teams mode" then
    return rankFourTeamsMode
  elseif mode == "3 teams mode" then
    return rankThreeTeamsMode
  elseif mode == "2 teams mode" then
    return rankTwoTeamsMode
  elseif mode == "Real mode" then
    return rankRealMode
  end
end


--[[ src/functions/ranking/rankPageMode.lua ]]--

function rankPageMode(mode, name)
  if mode == "Normal mode" then
    return pageNormalMode[name]
  elseif mode == "4 teams mode" then
    return pageFourTeamsMode[name]
  elseif mode == "3 teams mode" then
    return pageThreeTeamsMode[name]
  elseif mode == "2 teams mode" then
    return pageTwoTeamsMode[name]
  elseif mode == "Real mode" then
    return pageRealMode[name]
  end
end


--[[ src/functions/ranking/showMode.lua ]]--

function showMode(mode, name)
  removeUITrophies(name)
  if mode ~= "4 teams mode" then
    ui.removeTextArea(9999564, name)
    ui.removeTextArea(9999565, name)
  end
  
  local rank = rankMode(mode)
  local page = rankPageMode(mode, name)
  
  local y = 137
  local colorBackground = 0x2d5a61
  local indexPositions = positionsString(page)
  local namesRank = ""
  local matchesRank = ""
  local winsRank = ""
  local winRatioRank = ""
  local winsRed = ""
  local winsBlue = ""
  local winsYellow = ""
  local winsGreen = ""
  
  for i = 9999554, 9999563 do
    local index = (i - 9999553) + (10 * (page - 1))
    
    if rank[index] ~= nil then
      local winRatioString = tostring(rank[index].winRatio)
      
      ui.addTextArea(i, "", name, 135, y, 630, 6, colorBackground, colorBackground, 1, true)
      
      if page == 1 and index == 1 then
        namesRank = ""..namesRank.."<br>"..indexPositions[(i - 9999553)].." <cs>"..string.sub(rank[index].name, 1, #rank[index].name - 5).."<n><bl>"..string.sub(rank[index].name, #rank[index].name - 4).."<n>"
      else
        namesRank = ""..namesRank.."<br>"..indexPositions[(i - 9999553)].." "..string.sub(rank[index].name, 1, #rank[index].name - 5).."<bl>"..string.sub(rank[index].name, #rank[index].name - 4).."<n>"
      end
      matchesRank = ""..matchesRank.."<br>"..rank[index].matches..""
      winsRank = ""..winsRank.."<br>"..rank[index].wins..""
      winRatioRank = ""..winRatioRank.."<br>"..string.sub(winRatioString, 1, 4).."%"
      winsRed = ""..winsRed.."<br>"..rank[index].winsRed..""
      winsBlue = ""..winsBlue.."<br>"..rank[index].winsBlue..""
      
      if mode == "4 teams mode" then
        winsYellow = ""..winsYellow.."<br>"..rank[index].winsYellow..""
        winsGreen = ""..winsGreen.."<br>"..rank[index].winsGreen..""
      elseif mode == "3 teams mode" then
        winsGreen = ""..winsGreen.."<br>"..rank[index].winsGreen..""
      end
      
      if colorBackground == 0x2d5a61 then
        colorBackground = 0x142b2e
      else
        colorBackground = 0x2d5a61
      end
    else
      ui.addTextArea(i, "", name, 135, y, 630, 6, colorBackground, colorBackground, 0, true)
    end
    
    y = y + 16
  end
  
  local findNextIndexValue = 1 + (10 * (page))
  
  ui.addTextArea(9999545, "<p align='center'><font size='11px'>"..playerRankingMode[name].."", name, 390, 85, 120, 20, 0x161616, 0x161616, 0, true)
  if mode == "Normal mode" then
    ui.addTextArea(9999546, "<p align='center'><font size='13px'><n2>«<n>", name, 350, 86, 30, 18, 0x142b2e, 0x8a583c, 1, true)
    ui.addTextArea(9999547, "<p align='center'><font size='13px'><a href='event:4 teams mode'>»</a>", name, 520, 86, 30, 18, 0x142b2e, 0x8a583c, 1, true)
  elseif mode == "4 teams mode" then
    ui.addTextArea(9999546, "<p align='center'><font size='13px'><a href='event:Normal mode'>«</a>", name, 350, 86, 30, 18, 0x142b2e, 0x8a583c, 1, true)
    ui.addTextArea(9999547, "<p align='center'><font size='13px'><a href='event:3 teams mode'>»</a>", name, 520, 86, 30, 18, 0x142b2e, 0x8a583c, 1, true)
  elseif mode == "3 teams mode" then
    ui.addTextArea(9999546, "<p align='center'><font size='13px'><a href='event:4 teams mode'>«</a>", name, 350, 86, 30, 18, 0x142b2e, 0x8a583c, 1, true)
    ui.addTextArea(9999547, "<p align='center'><font size='13px'><a href='event:2 teams mode'>»</a>", name, 520, 86, 30, 18, 0x142b2e, 0x8a583c, 1, true)
  elseif mode == "2 teams mode" then
    ui.addTextArea(9999546, "<p align='center'><font size='13px'><a href='event:3 teams mode'>«</a>", name, 350, 86, 30, 18, 0x142b2e, 0x8a583c, 1, true)
    ui.addTextArea(9999547, "<p align='center'><font size='13px'><a href='event:Real mode'>»</a>", name, 520, 86, 30, 18, 0x142b2e, 0x8a583c, 1, true)
  elseif mode == "Real mode" then
    ui.addTextArea(9999546, "<p align='center'><font size='13px'><a href='event:2 teams mode'>«</a>", name, 350, 86, 30, 18, 0x142b2e, 0x8a583c, 1, true)
    ui.addTextArea(9999547, "<p align='center'><font size='13px'><n2>»</n>", name, 520, 86, 30, 18, 0x142b2e, 0x8a583c, 1, true)
  end
  ui.addTextArea(9999548, "<textformat leading='3px'><j>Name<n>"..namesRank.."", name, 135, 115, 185, 185, 0x161616, 0x161616, 0, true)
  ui.addTextArea(9999549, "<textformat leading='3px'><j>Matches<n>"..matchesRank.."", name, 335, 115, 50, 185, 0x161616, 0x161616, 0, true)
  ui.addTextArea(9999550, "<textformat leading='3px'><j>Wins<n>"..winsRank.."", name, 400, 115, 50, 185, 0x161616, 0x161616, 0, true)
  ui.addTextArea(9999551, "<textformat leading='3px'><j>Win rate<n>"..winRatioRank.."", name, 465, 115, 55, 185, 0x161616, 0x161616, 0, true)
  if mode == "4 teams mode" then
    ui.addTextArea(9999552, "<textformat leading='3px'><r>WR<n>"..winsRed.."", name, 535, 115, 50, 185, 0x161616, 0x161616, 0, true)
    ui.addTextArea(9999553, "<textformat leading='3px'><bv>WB<n>"..winsBlue.."", name, 597, 115, 50, 185, 0x161616, 0x161616, 0, true)
    ui.addTextArea(9999564, "<textformat leading='3px'><j>WY<n>"..winsYellow.."", name, 659, 115, 50, 185, 0x161616, 0x161616, 0, true)
    ui.addTextArea(9999565, "<textformat leading='3px'><vp>WG<n>"..winsGreen.."", name, 721, 115, 50, 185, 0x161616, 0x161616, 0, true)
  elseif mode == "3 teams mode" then
    ui.addTextArea(9999552, "<textformat leading='3px'><r>WR<n>"..winsRed.."", name, 597, 115, 50, 185, 0x161616, 0x161616, 0, true)
    ui.addTextArea(9999553, "<textformat leading='3px'><bv>WB<n>"..winsBlue.."", name, 659, 115, 50, 185, 0x161616, 0x161616, 0, true)
    ui.addTextArea(9999565, "<textformat leading='3px'><vp>WG<n>"..winsGreen.."", name, 721, 115, 50, 185, 0x161616, 0x161616, 0, true)
  else
    ui.addTextArea(9999552, "<textformat leading='3px'><r>WR<n>"..winsRed.."", name, 650, 115, 50, 185, 0x161616, 0x161616, 0, true)
    ui.addTextArea(9999553, "<textformat leading='3px'><bv>WB<n>"..winsBlue.."", name, 715, 115, 50, 185, 0x161616, 0x161616, 0, true)
  end
  
  if page == 1 then
    buttonNextOrPrev(26, name, 135, 300, 200, 30, 1, "<n2>"..playerLanguage[name].tr.previousMessage.."</n>")
  else
    buttonNextOrPrev(26, name, 135, 300, 200, 30, 1, "<a href='event:prevRank"..tostring(page - 1).."'>"..playerLanguage[name].tr.previousMessage.."</a>")
  end
  
  if rank[findNextIndexValue] == nil or findNextIndexValue > 30 then
    buttonNextOrPrev(25, name, 560, 300, 200, 30, 1, "<n2>"..playerLanguage[name].tr.nextMessage.."</n>")
  else
    buttonNextOrPrev(25, name, 560, 300, 200, 30, 1, "<a href='event:nextRank"..tostring(page + 1).."'>"..playerLanguage[name].tr.nextMessage.."</a>")
  end
end


--[[ src/functions/ranking/updateRanking/updateRankingFourTeamsMode.lua ]]--

function updateRankingFourTeamsMode()
  local rank_list = {}

  for name, stats in pairs(playersFourTeamsMode) do
    if stats.matches > 0 then
      rank_list[#rank_list + 1] = {name = name, matches = stats.matches, wins = stats.wins, winRatio = stats.winRatio, winsRed = stats.winsRed, winsBlue = stats.winsBlue, winsYellow = stats.winsYellow, winsGreen = stats.winsGreen}
    end
  end

  table.sort(rank_list, function(a, b)
    if a.wins == b.wins then
      return a.matches < b.matches
    else
      return a.wins > b.wins
    end
  end)

  rankFourTeamsMode = rank_list
end


--[[ src/functions/ranking/updateRanking/updateRankingNormalMode.lua ]]--

function updateRankingNormalMode()
  local rank_list = {}

  for name, stats in pairs(playersNormalMode) do
    if stats.matches > 0 then
      rank_list[#rank_list + 1] = {name = name, matches = stats.matches, wins = stats.wins, winRatio = stats.winRatio, winsRed = stats.winsRed, winsBlue = stats.winsBlue}
    end
  end

  table.sort(rank_list, function(a, b)
    if a.wins == b.wins then
      return a.matches < b.matches
    else
      return a.wins > b.wins
    end
  end)

  rankNormalMode = rank_list
end


--[[ src/functions/ranking/updateRanking/updateRankingRealMode.lua ]]--

function updateRankingRealMode()
  local rank_list = {}

  for name, stats in pairs(playersRealMode) do
    if stats.matches > 0 then
      rank_list[#rank_list + 1] = {name = name, matches = stats.matches, wins = stats.wins, winRatio = stats.winRatio, winsRed = stats.winsRed, winsBlue = stats.winsBlue}
    end
  end

  table.sort(rank_list, function(a, b)
    if a.wins == b.wins then
      return a.matches < b.matches
    else
      return a.wins > b.wins
    end
  end)

  rankRealMode = rank_list
end



--[[ src/functions/ranking/updateRanking/updateRankingThreeTeamsMode.lua ]]--

function updateRankingThreeTeamsMode()
  local rank_list = {}

  for name, stats in pairs(playersThreeTeamsMode) do
    if stats.matches > 0 then
      rank_list[#rank_list + 1] = {name = name, matches = stats.matches, wins = stats.wins, winRatio = stats.winRatio, winsRed = stats.winsRed, winsBlue = stats.winsBlue, winsGreen = stats.winsGreen}
    end
  end

  table.sort(rank_list, function(a, b)
    if a.wins == b.wins then
      return a.matches < b.matches
    else
      return a.wins > b.wins
    end
  end)

  rankThreeTeamsMode = rank_list
end


--[[ src/functions/ranking/updateRanking/updateRankingTwoTeamsMode.lua ]]--

function updateRankingTwoTeamsMode()
  local rank_list = {}

  for name, stats in pairs(playersTwoTeamsMode) do
    if stats.matches > 0 then
      rank_list[#rank_list + 1] = {name = name, matches = stats.matches, wins = stats.wins, winRatio = stats.winRatio, winsRed = stats.winsRed, winsBlue = stats.winsBlue}
    end
  end

  table.sort(rank_list, function(a, b)
    if a.wins == b.wins then
      return a.matches < b.matches
    else
      return a.wins > b.wins
    end
  end)

  rankTwoTeamsMode = rank_list
end


--[[ src/functions/ranking/winRatioPercentage.lua ]]--

function winRatioPercentage(wins, matches)
  if matches == 0 then
    return 0
  end

  return (wins / matches) * 100
end


--[[ src/functions/settings/getActionsMode.lua ]]--

function getActionsModes()
  local modes = getModesText()
  
  for i = 1, #modes do
    if globalSettings.mode == modes[i] then
      modes[i] = "<j>"..modes[i].."<n>"
    else
      modes[i] = "<a href='event:setMode"..i.."'>"..modes[i].."</a>"
    end
  end
  
  return modes
end


--[[ src/functions/sync/textSyncCondition.lua ]]--

function textSyncCondition(sync)
  local syncConditionValues = {50, 100, 150, 200}
  local syncText = {"Perfect", "Good", "Fair", "Bad", "Terrible"}
  
  for i = 1, #syncConditionValues do
    if sync <= syncConditionValues[i] then
      return syncText[i]
    end
  end
  
  return syncText[5]
end


--[[ src/functions/utils/appendAchievementsImages.lua ]]--

function appendAchievementsImages(name, tableImages)
  for i = 1, #tableImages do
    playerAchievementsImages[name][#playerAchievementsImages[name] + 1] = tableImages[i]
  end
end


--[[ src/functions/utils/configSelectMap.lua ]]--

function configSelectMap()
  local maps
  
  if gameStats.realMode then
    return {}
  end

  if gameStats.threeTeamsMode then
    maps = customMapsThreeTeamsMode

    return maps
  end
  
  if gameStats.teamsMode or gameStats.twoTeamsMode then
    maps = customMapsFourTeamsMode
    return maps
  end
  
  maps = customMaps
  
  return maps
end


--[[ src/functions/utils/crown/showCrownToAllPlayers.lua ]]--

function showCrownToAllPlayers()
  local crowns = {redCrown, blueCrown, greenCrown, yellowCrown}
  local teams = {playersRed, playersBlue, playersGreen, playersYellow}
  
  for j = 1, #teams do
    for i = 1, #teams[j] do
      local player = teams[j][i].name
      
      if player ~= '' and playerInGame[player] then
        for i = 1, 10 do
          if rankCrown[i] ~= nil then
            if rankCrown[i].name == player then
              for name1, data in pairs(tfm.get.room.playerList) do
                if showCrownImages[name1] then
                  tfm.exec.addImage(crowns[j][i], "$"..player, -20, -135, name1)
                end
              end
              break
            end
          end
        end
      end
    end
  end
end


--[[ src/functions/utils/crown/showCrownToPlayer.lua ]]--

function setCrownToPlayer(playerName)
  local crowns = {redCrown, blueCrown, greenCrown, yellowCrown}
  local teams = {playersRed, playersBlue, playersGreen, playersYellow}
  
  for j = 1, #teams do
    for i = 1, #teams[j] do
      local player = teams[j][i].name
      
      if player == playerName and playerInGame[player] then
        for i = 1, 10 do
          if rankCrown[i] ~= nil then
            if rankCrown[i].name == player then
              for name1, data in pairs(tfm.get.room.playerList) do
                if showCrownImages[name1] then
                  tfm.exec.addImage(crowns[j][i], "$"..player, -20, -135, name1)
                end
              end
              break
            end
          end
        end
        
        return
      end
    end
  end
end


--[[ src/functions/utils/formatMapName.lua ]]--

function formatMapName(map)
  if #map > 14 then
    return ""..string.sub(map, 1, 10).."..."
  end
  
  return map
end


--[[ src/functions/utils/getMapTypesActions.lua ]]--

function getMapTypesActions() 
  local modes = getMapTypesText()
  
  for i = 1, #modes do
    if globalSettings.mapType == string.lower(modes[i]) then
      modes[i] = "<j>"..modes[i].."<n>"
    else
      modes[i] = "<a href='event:setMapType"..i.."'>"..modes[i].."</a>"
    end
  end
  
  return modes
end


--[[ src/functions/utils/getMapTypesText.lua ]]--

function getMapTypesText()
  local modes = {"Small", "Large", "Extra-Large"}

  return modes
end


--[[ src/functions/utils/getMaxPageMap.lua ]]--

function getMaxPageMap(mapsList)
  local count = math.floor(#mapsList / 5)
  
  if #mapsList % 5 ~= 0 then
    count = count + 1
  end
  
  return count
end


--[[ src/functions/utils/getModesText.lua ]]--

function getModesText()
  local modes = {"Normal mode", "4 teams mode", "3 teams mode", "2 teams mode", "Real mode"}
  
  return modes
end


--[[ src/functions/utils/getQuantityPlayers.lua ]]--

function getQuantityPlayers()
  local quantity = {yellow = 0, red = 0, blue = 0, green = 0}
  if gameStats.typeMap == "large4v4" then
    if gameStats.teamsMode then
      for i = 1, #playersYellow do
        if playersYellow[i].name ~= "" then
          quantity.yellow = quantity.yellow + 1
        end
      end
    end
    for i = 1, #playersRed do
      if playersRed[i].name ~= "" then
        quantity.red = quantity.red + 1
      end
    end
    for i = 1, #playersBlue do
      if playersBlue[i].name ~= "" then
        quantity.blue = quantity.blue + 1
      end
    end
    for i = 1, #playersGreen do
      if playersGreen[i].name ~= "" then
        quantity.green = quantity.green + 1
      end
    end
    
    return quantity
  elseif gameStats.typeMap ~= "large4v4" then
    local quantity = {}
    local count = 0
    for i = 1, #teamsPlayersOnGame do
      for j = 1, #teamsPlayersOnGame[i] do
        if teamsPlayersOnGame[i][j].name ~= '' then
          count = count + 1
        end
      end
      if count > 0 then
        quantity[#quantity + 1] = count
      end
      
      count = 0
    end
    return quantity
  end
end


--[[ src/functions/utils/getQuantityPlayersOnPosition.lua ]]--

function getQuantityPlayersOnPosition(team)
  local quantity = {middle = 0, back = 0}

  if team == "red" then
    for i = 1, #playersRed do
      if playersRed[i].name ~= '' then
        if twoTeamsPlayerRedPosition[i] == "middle" then
          quantity.middle = quantity.middle + 1
        elseif twoTeamsPlayerRedPosition[i] == "back" then
          quantity.back = quantity.back + 1
        end
      end
    end
    
    return quantity
  end

  for i = 1, #playersBlue do
    if playersBlue[i].name ~= '' then
      if twoTeamsPlayerBluePosition[i] == "middle" then
        quantity.middle = quantity.middle + 1
      elseif twoTeamsPlayerBluePosition[i] == "back" then
        quantity.back = quantity.back + 1
      end
    end
  end

  return quantity
end


--[[ src/functions/utils/getSmallQuantity.lua ]]--

function getSmallQuantity(quantity)
  local quantityNumbers = {quantity.yellow, quantity.red, quantity.blue, quantity.green}

  if gameStats.threeTeamsMode then
    quantityNumbers = {quantity.red, quantity.blue, quantity.green}
  end

  local smallNumber = 9999
  local index = 0
  for i = 1, #quantityNumbers do
    if quantityNumbers[i] < smallNumber and quantityNumbers[i] > 0 then
      smallNumber = quantityNumbers[i]
      index = i
    end
  end

  local smallQuantity = {[1] = smallNumber, [2] = index}
  return smallQuantity
end


--[[ src/functions/utils/getSmallQuantity1.lua ]]--

function getSmallQuantity1(quantity)
  local smallNumber = 9999
  local index = 0

  for i = 1, #quantity do
    if quantity[i] < smallNumber and quantity[i] > 0 then
      smallNumber = quantity[i]
      index = i
    end
  end

  local smallQuantity = {[1] = smallNumber, [2] = index}
  return smallQuantity
end


--[[ src/functions/utils/getTeamName.lua ]]--

function getTeamName(text)
  if string.sub(text, 1, 9) == "<j>Yellow" then
    return "Yellow"
  elseif string.sub(text, 1, 6) == "<r>Red" then
    return "Red"
  elseif string.sub(text, 1, 8) == "<bv>Blue" then
    return "Blue"
  elseif string.sub(text, 1, 9) == "<vp>Green" then
    return "Green"
  end
end


--[[ src/functions/utils/isInactivePermanentAdmin.lua ]]--

function isInactivePermanentAdmin(name)
  for i = 1, #inactivePermanentAdmins do
    local admin = inactivePermanentAdmins[i]
    if name == admin then
      return true
    end
  end

  return false
end


--[[ src/functions/utils/isPermanentAdmin.lua ]]--

function isPermanentAdmin(name)
  for i = 1, #permanentAdmins do
    local admin = permanentAdmins[i]
    if name == admin then
      return true
    end
  end

  return false
end


--[[ src/functions/utils/maxPlayers.lua ]]--

function maxPlayers()
  local maxPlayers = 0
  if gameStats.gameMode == "3v3" then
    maxPlayers = 3
  elseif gameStats.gameMode == "4v4" or gameStats.gameMode == "6v6" then
    maxPlayers = 6
  end

  return maxPlayers
end


--[[ src/functions/utils/messages/commandNotAvailable.lua ]]--

function commandNotAvailable(command, name)
  tfm.exec.chatMessage("<bv>The "..command.." is not available when the mode 4 teams is enabled<n>", name)
end


--[[ src/functions/utils/messages/messageLog.lua ]]--

function messageLog(message)
  for name, data in pairs(tfm.get.room.playerList) do
    if admins[name] then
      tfm.exec.chatMessage(message, name)
    end
  end
end



--[[ src/functions/utils/messages/messagePlayerIsBanned.lua ]]--

function messagePlayerIsBanned(name)
  if playerBan[name] then
    tfm.exec.chatMessage("<bv>You do not have access to this action because you are banned from the room<n>", name)
    return true
  end
  
  return false
end


--[[ src/functions/utils/quantityPlayers.lua ]]--

function quantityPlayers()
  local quantity = {red = 0, blue = 0}
  if gameStats.teamsMode then
    quantity = {red = 0, blue = 0, yellow = 0, green = 0}
  end

  if gameStats.threeTeamsMode then
    quantity = {red = 0, blue = 0, yellow = 0, green = 0}
  end

  for i = 1, #playersRed do
    if playersRed[i].name ~= '' then
      quantity.red = quantity.red + 1
    end
  end
  for i = 1, #playersBlue do
    if playersBlue[i].name ~= '' then
      quantity.blue = quantity.blue + 1
    end
  end

  if gameStats.threeTeamsMode then
    for i = 1, #playersGreen do
      if playersGreen[i].name ~= '' then
        quantity.green = quantity.green + 1
      end
    end
  end

  if gameStats.teamsMode then
    for i = 1, #playersYellow do
      if playersYellow[i].name ~= '' then
        quantity.yellow = quantity.yellow + 1
      end
    end
    for i = 1, #playersGreen do
      if playersGreen[i].name ~= '' then
        quantity.green = quantity.green + 1
      end
    end
  end

  return quantity
end


--[[ src/functions/utils/resetMapsToTest.lua ]]--

function resetMapsToTest()
  if not tfm.get.room.isTribeHouse then
    return
  end
  
  if mapsToTest[1] ~= "" then
    tfm.exec.chatMessage("<bv>The test maps were removed due to the game mode change, you need to add the map again with the command !np @map<n>", nil)
  end
  
  mapsToTest = {
    [1] = "",
    [2] = "",
    [3] = ""
  }
end


--[[ src/functions/utils/resetPlayersConfig.lua ]]--

function resetPlayerConfigs()
  for name, data in pairs(tfm.get.room.playerList) do
    playerCanTransform[name] = true
    playerInGame[name] = false
    playerCoordinates[name] = {x = 0, y = 0}
    playerPhysicId[name] = 0
    system.bindKeyboard(name, 32, true, true)
    system.bindKeyboard(name, 0, true, true)
    system.bindKeyboard(name, 1, true, true)
    system.bindKeyboard(name, 2, true, true)
    system.bindKeyboard(name, 3, true, true)
    system.bindKeyboard(name, 55, true, true)
    system.bindKeyboard(name, 56, true, true)
    system.bindKeyboard(name, 57, true, true)
    system.bindKeyboard(name, 48, true, true)
    system.bindKeyboard(name, 77, true, true)
    tfm.exec.setNameColor(name, 0xD1D5DB)
    tfm.exec.setPlayerScore(name, 0, false)
    canVote[name] = true
  end
end


--[[ src/functions/utils/setBadgeWinner.lua ]]--

function setBadgeWinner(badge, badgeGrayscale, playersWinner)
  local playersBadgeWinners = {"Jenji#1475", "Ramasevosaff#0000", "Rex#2654", "Raidensnd#0000", "Mulan#5042", "Basker#2338", "Ppoppohaejuseyo#2315", "Djadja#5590", "Lightning#7523", "Nkmk#3180", "Sfjoud#8638", "Raf02#4942", "Axeldoton#0000", "Badmice9#0000", "Nagi#6356"}
  
  for i = 1, #playersWinner do
    if playerAchievements[playersWinner[i].player] == nil then
      playerAchievements[playersWinner[i].player] = {}
    end

    local arrayLength = #playerAchievements[playersWinner[i].player]
    playerAchievements[playersWinner[i].player][arrayLength + 1] = { image = badge, quantity = playersWinner[i].quantity}

    for j = 1, #playersBadgeWinners do
      if playersWinner[i].player == playersBadgeWinners[j] then
        table.remove(playersBadgeWinners, j)

        break
      end
    end
  end

  for i = 1, #playersBadgeWinners do
    if playerAchievements[playersBadgeWinners[i]] == nil then
      playerAchievements[playersBadgeWinners[i]] = {}
    end
    
    local arrayLength = #playerAchievements[playersBadgeWinners[i]]
    playerAchievements[playersBadgeWinners[i]][arrayLength + 1] = { image = badgeGrayscale, quantity = 0 }
  end
end

setBadgeWinner("img@193d675bca7", "img@193d6763c82", { { player = "Jenji#1475", quantity = 1 }, { player = "Ramasevosaff#0000", quantity = 1 }, { player = "Rex#2654", quantity = 1 }, { player = "Raidensnd#0000", quantity = 1 }, { player = "Mulan#5042", quantity = 1 }, { player = "Basker#2338", quantity = 1 }, { player = "Axeldoton#0000", quantity = 1 }, { player = "Badmice9#0000", quantity = 1 }, { player = "Nagi#6356", quantity = 1 } })
setBadgeWinner("19636905a3c.png", "19636907e9e.png", { { player = "Mulan#5042", quantity = 1 }, { player = "Ppoppohaejuseyo#2315", quantity = 1 }, { player = "Djadja#5590", quantity = 1 } })
setBadgeWinner("197d9274460.png", "197d9272515.png", { { player = "Jenji#1475", quantity = 1 }, { player = "Ramasevosaff#0000", quantity = 1 }, { player = "Lightning#7523", quantity = 1 }, { player = "Nkmk#3180", quantity = 1 } })
setBadgeWinner("1984ac7a614.png", "1984ac78d52.png", { { player = "Sfjoud#8638", quantity = 1 }, { player = "Raf02#4942", quantity = 1 } })
setBadgeWinner("1984ac7c1ac.png", "1984ac773d3.png", { { player = "Sfjoud#8638", quantity = 1 }, { player = "Raf02#4942", quantity = 1 } })



--[[ src/functions/utils/split.lua ]]--

function split(inputstr, sep)
  if sep == nil then
    sep = "%s"
  end
  local t={}
  for str in string.gmatch(inputstr, "([^"..sep.."]+)") do
    table.insert(t, str)
  end
  return t
end


--[[ src/functions/utils/teamBlueIndex.lua ]]--

function teamBlueIndex(index)
  if gameStats.threeTeamsMode then
    return index
  end

  return index - 3
end



--[[ src/functions/utils/verifyMode.lua ]]--

function verifyMode()
  if gameStats.teamsMode then
    return "4 teams mode"
  elseif gameStats.threeTeamsMode then
    return "3 teams mode"
  elseif gameStats.twoTeamsMode then
    return "2 teams mode"
  elseif gameStats.realMode then
    return "Real mode"
  else
    return "Normal mode"
  end
end


--[[ src/functions/vote/resetMapsList.lua ]]--

function resetMapsList()
  mapsVotes = {}
  gameStats.totalVotes = 0

  for name, data in pairs(tfm.get.room.playerList) do
    canVote[name] = true
    
    if selectMapOpen[name] then
      selectMapPage[name] = 1
      selectMapUI(name)
    end
  end
end


--[[ src/functions/vote/showMapVotes.lua ]]--

function showMapVotes(maps, index)
  if mapsVotes[index] == nil then
    return 0
  end
  
  return mapsVotes[index]
end


--[[ src/functions/vote/verifyMostMapVoted.lua ]]--

function verifyMostMapVoted()
  local mostMapVotedIndex = 1
  local mapsTie = {}

  local maps = configSelectMap()

  for i = 2, #maps do
    if mapsVotes[i] ~= nil then
      if mapsVotes[mostMapVotedIndex] ~= nil then
        if mapsVotes[i] > mapsVotes[mostMapVotedIndex] then
          mostMapVotedIndex = i
        end
      else
        mostMapVotedIndex = i
      end
    end
  end

  mapsTie[#mapsTie + 1] = mostMapVotedIndex

  for i = 1, #maps do
    if mapsVotes[i] ~= nil then
      if mapsVotes[i] == mapsVotes[mostMapVotedIndex] and i ~= mostMapVotedIndex then
        mapsTie[#mapsTie + 1] = i
      end
    end
  end

  if #mapsTie > 1 then
    mostMapVotedIndex = mapsTie[math.random(1, #mapsTie)]
  end

  gameStats.mapIndexSelected = mostMapVotedIndex
end


--[[ src/ui/addWindow/addTrophie.lua ]]--

function ui.addTrophie(id, event, player, playerTarget, x, y, width, height, alpha)
  local indexImage = tonumber(string.sub(event, 8))
  id = tostring(id)
  ui.addTextArea(id.."0", "", player, x+1, y+1, width-2, height-2, 0x8a583c, 0x8a583c, alpha, true)
  ui.addTextArea(id.."00", "", player, x+3, y+3, width-6, height-6, 0x2b1f19, 0x2b1f19, alpha, true)
  ui.addTextArea(id.."000", "", player, x+4, y+4, width-8, height-8, 0xc191c, 0xc191c, alpha, true)
  ui.addTextArea(id.."0000", "", player, x+5, y+5, width-10, height-10, 0x2d5a61, 0x2d5a61, alpha, true)
  ui.addTextArea(id.."0000000", "", player, x+5, y+6, width-10, height-12, 0x142b2e, 0x142b2e, alpha, true)
  table.insert(playerAchievementsImages[player], tfm.exec.addImage(playerAchievements[playerTarget][indexImage].image, "~"..id.."0000000", x + 5, y + 7, player))
  ui.addTextArea(id.."00000", "<p align='right'><font size='10px'><font color='#000000'>x"..playerAchievements[playerTarget][indexImage].quantity.."", player, x+33, y+height-16, 20, 15, 0x161616, 0x161616, 0, true)
  ui.addTextArea(id.."000000", "<p align='right'><font size='10px'>x"..playerAchievements[playerTarget][indexImage].quantity.."", player, x+32, y+height-17, 20, 15, 0x161616, 0x161616, 0, true)
  ui.addTextArea(id.."00000000", "<a href='event:"..event.."'><font size='20px'><br> <br> </a>", player, x+5, y+6, width, height, 0x142b2e, 0x142b2e, 0, true)
end


--[[ src/ui/addWindow/addWindow.lua ]]--

function ui.addWindow(id, text, player, x, y, width, height, alpha, corners, closeButton, buttonText, showCornerImage)
  id = tostring(id)
  ui.addTextArea(id.."0", "", player, x+1, y+1, width-2, height-2, 0x8a583c, 0x8a583c, alpha, true)
  ui.addTextArea(id.."00", "", player, x+3, y+3, width-6, height-6, 0x2b1f19, 0x2b1f19, alpha, true)
  ui.addTextArea(id.."000", "", player, x+4, y+4, width-8, height-8, 0xc191c, 0xc191c, alpha, true)
  ui.addTextArea(id.."0000", "", player, x+5, y+5, width-10, height-10, 0x2d5a61, 0x2d5a61, alpha, true)
  ui.addTextArea(id.."00000", text, player, x+5, y+6, width-10, height-12, 0x142b2e, 0x142b2e, alpha, true)
  local imageId = {}

  if corners then
    if showCornerImage[1] == true then
      table.insert(imageId, tfm.exec.addImage("155cbe97a3f.png", "&1", x-7, (y+height)-22, player))
    end

    if showCornerImage[2] == true then
      table.insert(imageId, tfm.exec.addImage("155cbe99c72.png", "&1", x-7, y-7, player))
    end

    if showCornerImage[3] == true then
      table.insert(imageId, tfm.exec.addImage("155cbe9bc9b.png", "&1", (x+width)-20, (y+height)-22, player))
    end

    if showCornerImage[4] == true then
      table.insert(imageId, tfm.exec.addImage("155cbea943a.png", "&1", (x+width)-20, y-7, player))
    end
  end

  if closeButton then
    ui.addTextArea(id.."000000", "", player, x+8, y+height-22, width-16, 13, 0x7a8d93, 0x7a8d93, alpha, true)
    ui.addTextArea(id.."0000000", "", player, x+9, y+height-21, width-16, 13, 0xe1619, 0xe1619, alpha, true)
    ui.addTextArea(id.."00000000", "", player, x+9, y+height-21, width-17, 12, 0x314e57, 0x314e57, alpha, true)
    ui.addTextArea(id.."", buttonText, player, x+9, y+height-24, width-17, nil, 0x314e57, 0x314e57, 0, true)
  end

  return imageId
end


--[[ src/ui/addWindow/buttonNextOrPrev.lua ]]--

function buttonNextOrPrev(id, name, x, y, width, height, alpha, text)
  id = tostring(id)
  ui.addTextArea(id.."0000000000", "", name, x+8, y+height-22, width-16, 13, 0x7a8d93, 0x7a8d93, alpha, true)
  ui.addTextArea(id.."00000000000", "", name, x+9, y+height-21, width-16, 13, 0xe1619, 0xe1619, alpha, true)
  ui.addTextArea(id.."000000000000", "", name, x+9, y+height-21, width-17, 12, 0x314e57, 0x314e57, alpha, true)
  ui.addTextArea(id.."0000000000000", text, name, x+9, y+height-24, width-17, nil, 0x314e57, 0x314e57, 0, true)
end


--[[ src/ui/addWindow/lobby/eventNewGameShowLobbyTexts.lua ]]--

function eventNewGameShowLobbyTexts()
  if gameStats.threeTeamsMode then
    for i = 1, 4 do
      if playersRed[i].name == "" then
        ui.addTextArea(threeTeamsMode.id[i], "<p align='center'><font size='14px'><a href='event:joinTeamRed"..i.."'>Join", nil, threeTeamsMode.x[i], threeTeamsMode.y[i], 150, 40, 0xE14747, 0xE14747, 1, false)
      else
        ui.addTextArea(threeTeamsMode.id[i], "<p align='center'><font size='14px'><a href='event:leaveTeamRed"..i.."'>"..playersRed[i].name.."", nil, threeTeamsMode.x[i], threeTeamsMode.y[i], 150, 40, 0x871F1F, 0x871F1F, 1, false)
      end
    end

    for i = 5, 8 do
      if playersBlue[i - 4].name == "" then
        ui.addTextArea(threeTeamsMode.id[i], "<p align='center'><font size='14px'><a href='event:joinTeamBlue"..(i - 4).."'>Join", nil, threeTeamsMode.x[i], threeTeamsMode.y[i], 150, 40, 0x184F81, 0x184F81, 1, false)
      else
        ui.addTextArea(threeTeamsMode.id[i], "<p align='center'><font size='14px'><a href='event:leaveTeamBlue"..(i - 4).."'>"..playersBlue[i - 4].name.."", nil, threeTeamsMode.x[i], threeTeamsMode.y[i], 150, 40, 0x0B3356, 0x0B3356, 1, false)
      end
    end

    for i = 9, 12 do
      if playersGreen[i - 8].name == "" then
        ui.addTextArea(threeTeamsMode.id[i], "<p align='center'><font size='14px'><a href='event:joinTeamGreen"..(i - 8).."'>Join", nil, threeTeamsMode.x[i], threeTeamsMode.y[i], 150, 40, 0x109267, 0x109267, 1, false)
      else
        ui.addTextArea(threeTeamsMode.id[i], "<p align='center'><font size='14px'><a href='event:leaveTeamGreen"..(i - 8).."'>"..playersGreen[i - 8].name.."", nil, threeTeamsMode.x[i], threeTeamsMode.y[i], 150, 40, 0x0C6346, 0x0C6346, 1, false)
      end
    end

    return
  end

  for i = 1, 3 do
    if playersRed[i].name == "" then
      ui.addTextArea(i, "<p align='center'><font size='14px'><a href='event:joinTeamRed"..i.."'>Join", nil, x[i], y[i], 150, 40, 0xE14747, 0xE14747, 1, false)
    else
      ui.addTextArea(i, "<p align='center'><font size='14px'><a href='event:leaveTeamRed"..i.."'>"..playersRed[i].name.."", nil, x[i], y[i], 150, 40, 0x871F1F, 0x871F1F, 1, false)
    end
  end
  for i= 4, 6 do
    if playersBlue[i - 3].name == "" then
      ui.addTextArea(i, "<p align='center'><font size='14px'><a href='event:joinTeamBlue"..i.."'>Join", nil, x[i], y[i], 150, 40, 0x184F81, 0x184F81, 1, false)
    else
      ui.addTextArea(i, "<p align='center'><font size='14px'><a href='event:leaveTeamBlue"..i.."'>"..playersBlue[i - 3].name.."", nil, x[i], y[i], 150, 40, 0x0B3356, 0x0B3356, 1, false)
    end
  end
  if not gameStats.teamsMode then
    for i = 8, 10 do
      if playersRed[i - 4].name == "" then
        ui.addTextArea(i, "<p align='center'><font size='14px'><a href='event:joinTeamRed"..(i - 4).."'>Join", nil, x[i - 1], y[i - 1], 150, 40, 0xE14747, 0xE14747, 1, false)
      else
        ui.addTextArea(i, "<p align='center'><font size='14px'><a href='event:leaveTeamRed"..(i - 4).."'>"..playersRed[i - 4].name.."", nil, x[i - 1], y[i - 1], 150, 40, 0x871F1F, 0x871F1F, 1, false)
      end
    end
    for i = 11, 13 do
      if playersBlue[i - 7].name == "" then
        ui.addTextArea(i, "<p align='center'><font size='14px'><a href='event:joinTeamBlue"..(i - 4).."'>Join", nil, x[i - 1], y[i - 1], 150, 40, 0x184F81, 0x184F81, 1, false)
      else
        ui.addTextArea(i, "<p align='center'><font size='14px'><a href='event:leaveTeamBlue"..(i - 4).."'>"..playersBlue[i - 7].name.."", nil, x[i - 1], y[i- 1], 150, 40, 0x0B3356, 0x0B3356, 1, false)
      end
    end

    return
  end
  for i = 8, 10 do
    if playersYellow[i - 7].name == "" then
      ui.addTextArea(i, "<p align='center'><font size='14px'><a href='event:joinTeamYellow"..(i - 7).."'>Join", nil, x[i - 1], y[i - 1], 150, 40, 0xF59E0B, 0xF59E0B, 1, false)
    else
      ui.addTextArea(i, "<p align='center'><font size='14px'><a href='event:leaveTeamYellow"..(i - 7).."'>"..playersYellow[i - 7].name.."", nil, x[i - 1], y[i - 1], 150, 40, 0xB57200, 0xB57200, 1, false)
    end
  end

  for i = 11, 13 do
    if playersGreen[i - 10].name == "" then
      ui.addTextArea(i, "<p align='center'><font size='14px'><a href='event:joinTeamGreen"..(i - 10).."'>Join", nil, x[i - 1], y[i - 1], 150, 40, 0x109267, 0x109267, 1, false)
    else
      ui.addTextArea(i, "<p align='center'><font size='14px'><a href='event:leaveTeamGreen"..(i - 10).."'>"..playersGreen[i - 10].name.."", nil, x[i - 1], y[i - 1], 150, 40, 0x0C6346, 0x0C6346, 1, false)
    end
  end
end


--[[ src/ui/addWindow/lobby/updateLobbyTextAreas.lua ]]--

function updateLobbyTextAreas()
  resetPlayerConfigs()
  initGame = os.time() + 25000

  if gameStats.teamsMode then
    resetTeams = addTimer(function(i)
      if i == 1 then
        playersRed = {
          [1] = {name = ''},
          [2] = {name = ''},
          [3] = {name = ''},
        }
        playersBlue = {
          [1] = {name = ''},
          [2] = {name = ''},
          [3] = {name = ''},
        }
        playersYellow = {
          [1] = {name = ''},
          [2] = {name = ''},
          [3] = {name = ''}
        }

        playersGreen = {
          [1] = {name = ''},
          [2] = {name = ''},
          [3] = {name = ''}
        }
      end
    end, 1000, 1, "resetTeams")
    toggleTeams = addTimer(function(i)
      if i == 1 then
        for i = 1, 3 do
          ui.addTextArea(i, "<p align='center'><font size='14px'><a href='event:joinTeamRed"..i.."'>Join", nil, x[i], y[i], 150, 40, 0xE14747, 0xE14747, 1, false)
        end

        for i = 4, 6 do
          ui.addTextArea(i, "<p align='center'><font size='14px'><a href='event:joinTeamBlue"..i.."'>Join", nil, x[i], y[i], 150, 40, 0x184F81, 0x184F81, 1, false)
        end

        for i = 8, 10 do
          ui.addTextArea(i, "<p align='center'><font size='14px'><a href='event:joinTeamYellow"..(i - 7).."'>Join", nil, x[i - 1], y[i - 1], 150, 40, 0xF59E0B, 0xF59E0B, 1, false)
        end

        for i = 11, 13 do
          ui.addTextArea(i, "<p align='center'><font size='14px'><a href='event:joinTeamGreen"..(i - 10).."'>Join", nil, x[i - 1], y[i - 1], 150, 40, 0x109267, 0x109267, 1, false)
        end
      end
    end, 1500, 1, "toggleTeams")
    canJoin = addTimer(function(i)
      if i == 1 then
        gameStats.canJoin = true
      end
    end, 2500, 1, "canJoin")

    return
  end

  if gameStats.threeTeamsMode then
    resetTeams = addTimer(function(i)
      if i == 1 then
        playersRed = {
          [1] = {name = ''},
          [2] = {name = ''},
          [3] = {name = ''},
          [4] = {name = ''}, 
        }
        playersBlue = {
          [1] = {name = ''},
          [2] = {name = ''},
          [3] = {name = ''},
          [4] = {name = ''},
        }
        playersGreen = {
          [1] = {name = ''},
          [2] = {name = ''},
          [3] = {name = ''},
          [4] = {name = ''}
        }
      end
    end, 1000, 1, "resetTeams")
    toggleTeams = addTimer(function(i)
      if i == 1 then
        for i = 1, 4 do
          ui.addTextArea(threeTeamsMode.id[i], "<p align='center'><font size='14px'><a href='event:joinTeamRed"..i.."'>Join", nil, threeTeamsMode.x[i], threeTeamsMode.y[i], 150, 40, 0xE14747, 0xE14747, 1, false)
        end

        for i = 5, 8 do
          ui.addTextArea(threeTeamsMode.id[i], "<p align='center'><font size='14px'><a href='event:joinTeamBlue"..(i - 4).."'>Join", nil, threeTeamsMode.x[i], threeTeamsMode.y[i], 150, 40, 0x184F81, 0x184F81, 1, false)
        end

        for i = 9, 12 do
          ui.addTextArea(threeTeamsMode.id[i], "<p align='center'><font size='14px'><a href='event:joinTeamGreen"..(i - 8).."'>Join", nil, threeTeamsMode.x[i], threeTeamsMode.y[i], 150, 40, 0x109267, 0x109267, 1, false)
        end
      end
    end, 1500, 1, "toggleTeams")
    canJoin = addTimer(function(i)
      if i == 1 then
        gameStats.canJoin = true
      end
    end, 2500, 1, "canJoin")

    return
  end

  resetTeams = addTimer(function(i)
    if i == 1 then
      playersRed = {
        [1] = {name = ''},
        [2] = {name = ''},
        [3] = {name = ''},
        [4] = {name = ''},
        [5] = {name = ''},
        [6] = {name = ''}
      }
      playersBlue = {
        [1] = {name = ''},
        [2] = {name = ''},
        [3] = {name = ''},
        [4] = {name = ''},
        [5] = {name = ''},
        [6] = {name = ''}
      }
    end
  end, 1000, 1, "resetTeams")

  toggleTeams = addTimer(function(i)
    if i == 1 then
      for i = 1, 3 do
        ui.addTextArea(i, "<p align='center'><font size='14px'><a href='event:joinTeamRed"..i.."'>Join", nil, x[i], y[i], 150, 40, 0xE14747, 0xE14747, 1, false)
      end

      for i = 4, 6 do
        ui.addTextArea(i, "<p align='center'><font size='14px'><a href='event:joinTeamBlue"..i.."'>Join", nil, x[i], y[i], 150, 40, 0x184F81, 0x184F81, 1, false)
      end

      for i = 8, 10 do
        ui.addTextArea(i, "<p align='center'><font size='14px'><a href='event:joinTeamRed"..(i - 4).."'>Join", nil, x[i - 1], y[i - 1], 150, 40, 0xE14747, 0xE14747, 1, false)
      end

      for i = 11, 13 do
        ui.addTextArea(i, "<p align='center'><font size='14px'><a href='event:joinTeamBlue"..(i - 4).."'>Join", nil, x[i - 1], y[i - 1], 150, 40, 0x184F81, 0x184F81, 1, false)
      end
    end
  end, 1500, 1, "toggleTeams")

  canJoin = addTimer(function(i)
    if i == 1 then
      gameStats.canJoin = true
    end
  end, 2500, 1, "canJoin")

end


--[[ src/ui/addWindow/lobby/updateLobbyTexts.lua ]]--

function updateLobbyTexts(name)
  if gameStats.threeTeamsMode then
    for i = 1, 4 do
      if playersRed[i].name == name then
        playersRed[i].name = ''

        ui.addTextArea(threeTeamsMode.id[i], "<p align='center'><font size='14px'><a href='event:joinTeamRed"..i.."'>Join", nil, threeTeamsMode.x[i], threeTeamsMode.y[i], 150, 40, 0xE14747, 0xE14747, 1, false)
        
        return
      end
    end

    for i = 5, 8 do
      if playersBlue[i - 4].name == name then
        playersBlue[i - 4].name = ''

        ui.addTextArea(threeTeamsMode.id[i], "<p align='center'><font size='14px'><a href='event:joinTeamBlue"..(i - 4).."'>Join", nil, threeTeamsMode.x[i], threeTeamsMode.y[i], 150, 40, 0x184F81, 0x184F81, 1, false)

        return
      end
    end

    for i = 9, 12 do
      if playersGreen[i - 8].name == name then
        playersGreen[i - 8].name = ''

        ui.addTextArea(threeTeamsMode.id[i], "<p align='center'><font size='14px'><a href='event:joinTeamGreen"..(i - 8).."'>Join", nil, threeTeamsMode.x[i], threeTeamsMode.y[i], 150, 40, 0x109267, 0x109267, 1, false)

        return
      end
    end

    return
  end


  for i = 1, 3 do
    if playersRed[i].name == name then
      playersRed[i].name = ''
      ui.addTextArea(i, "<p align='center'><font size='14px'><a href='event:joinTeamRed"..i.."'>Join", nil, x[i], y[i], 150, 40, 0xE14747, 0xE14747, 1, false)
    end
    if playersBlue[i].name == name then
      playersBlue[i].name = ''
      ui.addTextArea(i + 3, "<p align='center'><font size='14px'><a href='event:joinTeamBlue"..(i + 3).."'>Join", nil, x[i + 3], y[i + 3], 150, 40, 0x184F81, 0x184F81, 1, false)
    end
  end
  if not gameStats.teamsMode then
    for i = 8, 10 do
      if playersRed[i - 4].name == name then
        playersRed[i - 4].name = ''
        ui.addTextArea(i, "<p align='center'><font size='14px'><a href='event:joinTeamRed"..(i - 4).."'>Join", nil, x[i - 1], y[i - 1], 150, 40, 0xE14747, 0xE14747, 1, false)
      end
    end
    for i = 11, 13 do
      if playersBlue[i - 7].name == name then
        playersBlue[i - 7].name = ''
        ui.addTextArea(i, "<p align='center'><font size='14px'><a href='event:joinTeamBlue"..(i - 4).."'>Join", nil, x[i - 1], y[i - 1], 150, 40, 0x184F81, 0x184F81, 1, false)
      end
    end
    return
  end
  for i = 8, 10 do
    if playersYellow[i - 7].name == name then
      playersYellow[i - 7].name = ''
      ui.addTextArea(i, "<p align='center'><font size='14px'><a href='event:joinTeamYellow"..(i - 7).."'>Join", nil, x[i - 1], y[i - 1], 150, 40, 0xF59E0B, 0xF59E0B, 1, false)
    end
  end

  for i = 11, 13 do
    if playersGreen[i - 10].name == name then
      playersGreen[i - 10].name = ''
      ui.addTextArea(i, "<p align='center'><font size='14px'><a href='event:joinTeamGreen"..(i - 10).."'>Join", nil, x[i - 1], y[i - 1], 150, 40, 0x109267, 0x109267, 1, false)
    end
  end
end


--[[ src/ui/addWindow/profileUi.lua ]]--

function profileUI(name, playerTarget)
  isOpenProfile[name] = true
  local images3 = ui.addWindow(26, "<textformat leading='55'><br>"..playerLanguage[name].tr.msgAchievements.."", name, 217, 120, 470, 240, 1, true, true, playerLanguage[name].tr.closeUIText, {true, false, true, false})
  local images1 = ui.addWindow(24, "<p align='center'><font size='16px'><textformat leading='-10'><br><v>"..string.sub(playerTarget, 1, #playerTarget - 5).."<n><bl>"..string.sub(playerTarget, #playerTarget -4).."<n>", name, 300, 105, 400, 50, 1, true, false, "", {false, false, true, true})
  local images2 = ui.addWindow(25, "<p align='center'><font size='30px'><textformat leading='-10'><br><j>#1<n>", name, 200, 80, 100, 100, 1, true, false, "", {true, true, true, true})
  ui.addTrophie(27, "trophie1", name, playerTarget, 230, 230, 50, 50, 1)
  ui.addTrophie(28, "trophie2", name, playerTarget, 295, 230, 50, 50, 1)
  ui.addTrophie(29, "trophie3", name, playerTarget, 355, 230, 50, 50, 1)
  ui.addTrophie(32, "trophie4", name, playerTarget, 420, 230, 50, 50, 1)
  ui.addTrophie(33, "trophie5", name, playerTarget, 485, 230, 50, 50, 1)
  
  appendAchievementsImages(name, images1)
  appendAchievementsImages(name, images2)
  appendAchievementsImages(name, images3)
end


--[[ src/ui/addWindow/selectMap/selectMapPointersNavigation.lua ]]--

function selectMapPointersNavigation(name, page, maxPage)
  local str = ""
  for i = 1, maxPage do
    if page == i then
      str = ""..str.." <j>•<n>"
    else
      str = ""..str.." <a href='event:nextSelectMap"..i.."'>•</a>"
    end
  end

  ui.addTextArea(9999999999, "<p align='center'><font size='18px'>"..str.."", name, 347, 300, 200, 20, 0x161616, 0x161616, 0, true)
end


--[[ src/ui/addWindow/selectMap/selectMapUi.lua ]]--

function selectMapUI(name)
  removeSelectUI(name)
  local maps = configSelectMap()
  local maxPage = getMaxPageMap(maps)
  local page = selectMapPage[name]

  for i = 1, 5 do
    local index = i + ((page - 1) * 5)

    if maps[index] ~= nil then
      local textSelect = "<a href='event:setmap"..index.."'>Select map</a>"
      local voteText = "<a href='event:votemap"..index.."'>Vote map ("..showMapVotes(maps, index)..")</a>"

      if index == gameStats.customMapIndex then
        textSelect = "<j>Selected map<n>"
      elseif not admins[name] then
        textSelect = "<n2>Select map<n>"
      end

      if not canVote[name] then
        voteText = "<n2>Vote map<n> ("..showMapVotes(maps, index)..")"
      end

      ui.addTextArea(""..tostring(99999)..""..tostring(i).."", "", name, (142 + ((i - 1) * 125)), 115, 110, 140, 0x142b2e, 0x8a583c, 1, true)
      ui.addTextArea(""..tostring(999999)..""..tostring(i).."", "", name, (147  + ((i - 1) * 125)), 120, 100, 43, 0x142b2e, 0x2d5a61, 1, true)
      ui.addTextArea(""..tostring(9999999)..""..tostring(i).."", "<p align='center'><font size='12px'><a href='event:map"..maps[index][3].."'>"..formatMapName(maps[index][3]).."</a>", name, (147  + ((i - 1) * 125)), 165, 100, 20, 0x142b2e, 0x2d5a61, 0, true)

      ui.addTextArea(""..tostring(99999999)..""..tostring(i).."", "<p align='center'><font size='12px'>"..textSelect.."", name, (147  + ((i - 1) * 125)), 190, 100, 20, 0x142b2e, 0x2d5a61, 1, true)
      ui.addTextArea(""..tostring(999999999)..""..tostring(i).."", "<p align='center'><font size='12px'>"..voteText.."", name, (147  + ((i - 1) * 125)), 225, 100, 20, 0x142b2e, 0x2d5a61, 1, true)

      table.insert(selectMapImages[name], tfm.exec.addImage(maps[index][6], "~999999"..i.."", (147 + ((i - 1) * 125 )), 118, name))
    end
  end

  selectMapPointersNavigation(name, page, maxPage)

  if page == 1 then
    buttonNextOrPrev(26, name, 135, 300, 200, 30, 1, "<n2>"..playerLanguage[name].tr.previousMessage.."</n>")
  else
    buttonNextOrPrev(26, name, 135, 300, 200, 30, 1, "<a href='event:prevSelectMap"..tostring(page - 1).."'>"..playerLanguage[name].tr.previousMessage.."</a>")
  end

  if page >= maxPage then
    buttonNextOrPrev(25, name, 560, 300, 200, 30, 1, "<n2>"..playerLanguage[name].tr.nextMessage.."</n>")
  else
    buttonNextOrPrev(25, name, 560, 300, 200, 30, 1, "<a href='event:nextSelectMap"..tostring(page + 1).."'>"..playerLanguage[name].tr.nextMessage.."</a>")
  end
end


--[[ src/ui/addWindow/settings/pages/settingsPageOne.lua ]]--

function settingsPageOne(name) 
  ui.addTextArea(99992, ""..playerLanguage[name].tr.textSettings.."", name, 150, 110, 500, 200, 0x161616, 0x161616, 0, true)
  
  if settingsMode[name] then
    local modes = getActionsModes()
    local str = ''

    for i = 1, #modes do
      str = ""..str..""..modes[i].."<br>"
    end

    ui.addWindow(25, "<p align='center'><font size='11px'><a href='event:closeMode'>Select a mode</a><br><br>"..str.."", name, 665, 100, 100, 100, 1, false, false)
  else
    ui.addWindow(25, "<p align='center'><font size='11px'><a href='event:openMode'>Select a mode</a>", name, 665, 100, 100, 30, 1, false, false)
  end

  ui.addWindow(25, "<p align='center'><font size='11px'><a href='event:openMode'>Select a mode</a>", name, 665, 100, 100, 30, 1, false, false)

  if globalSettings.randomBall then
    ui.addWindow(21, "<p align='center'><font size='11px'><a href='event:randomball'>Enabled</a>", name, 665, 150, 100, 30, 1, false, false)
  else
    ui.addWindow(21, "<p align='center'><font size='11px'><a href='event:randomball'>Disabled</a>", name, 665, 150, 100, 30, 1, false, false)
  end

  if globalSettings.randomMap then
    ui.addWindow(22, "<p align='center'><font size='11px'><a href='event:randommap'>Enabled</a>", name, 665, 200, 100, 30, 1, false, false)
  else
    ui.addWindow(22, "<p align='center'><font size='11px'><a href='event:randommap'>Disabled</a>", name, 665, 200, 100, 30, 1, false, false)
  end

  if globalSettings.twoBalls then
    ui.addWindow(44, "<p align='center'><font size='11px'><a href='event:twoballs'>Enabled</a>", name, 665, 250, 100, 30, 1, false, false)
  else
    ui.addWindow(44, "<p align='center'><font size='11px'><a href='event:twoballs'>Disabled</a>", name, 665, 250, 100, 30, 1, false, false)
  end
end


--[[ src/ui/addWindow/settings/pages/settingsPageTwo.lua ]]--

function settingsPageTwo(name) 
  ui.addTextArea(99992, ""..playerLanguage[name].tr.textSettings2.."", name, 150, 110, 500, 200, 0x161616, 0x161616, 0, true)
  
  if settingsMode[name] then
    local modes = getMapTypesActions()
    local str = ''

    for i = 1, #modes do
      str = ""..str..""..modes[i].."<br>"
    end

    ui.addWindow(25, "<p align='center'><font size='11px'><a href='event:closeMapType'>Select map</a><br><br>"..str.."", name, 665, 100, 100, 100, 1, false, false)
  else
    ui.addWindow(25, "<p align='center'><font size='11px'><a href='event:openMapType'>Select map</a>", name, 665, 100, 100, 30, 1, false, false)
  end

  ui.addWindow(25, "<p align='center'><font size='11px'><a href='event:openMapType'>Select map</a>", name, 665, 100, 100, 30, 1, false, false)

  if globalSettings.consumables then
    ui.addWindow(21, "<p align='center'><font size='11px'><a href='event:consumables'>Enabled</a>", name, 665, 150, 100, 30, 1, false, false)
  else
    ui.addWindow(21, "<p align='center'><font size='11px'><a href='event:consumables'>Disabled</a>", name, 665, 150, 100, 30, 1, false, false)
  end

  if globalSettings.threeBalls then
    ui.addWindow(44, "<p align='center'><font size='11px'><a href='event:threeballs'>Enabled</a>", name, 665, 200, 100, 30, 1, false, false)
  else
    ui.addWindow(44, "<p align='center'><font size='11px'><a href='event:threeballs'>Disabled</a>", name, 665, 200, 100, 30, 1, false, false)
  end
end


--[[ src/ui/addWindow/settings/updateSettingsUi.lua ]]--

function updateSettingsUI(playerName)
  if playerName ~= nil then
    local name = playerName

    if settings[name] then
      ui.addWindow(24, ""..playerLanguage[name].tr.titleSettings.."", name, 125, 60, 650, 300, 1, false, true, playerLanguage[name].tr.closeUIText)
      if pagePlayerSettings[name] == 1 then
        settingsPageOne(name)
      elseif pagePlayerSettings[name] == 2 then
        settingsPageTwo(name)
      end

      if pagePlayerSettings[name] == 1 then
        buttonNextOrPrev(26, name, 125, 300, 200, 30, 1, "<n2>"..playerLanguage[name].tr.previousMessage.."</n>")
      else
        buttonNextOrPrev(26, name, 125, 300, 200, 30, 1, "<a href='event:prevSettings"..tostring(pagePlayerSettings[name] - 1).."'>"..playerLanguage[name].tr.previousMessage.."</a>")
      end
      
      if pagePlayerSettings[name] == maxPageSettings then
        buttonNextOrPrev(27, name, 575, 300, 200, 30, 1, "<n2>"..playerLanguage[name].tr.nextMessage.."</n>")
      else
        buttonNextOrPrev(27, name, 575, 300, 200, 30, 1, "<a href='event:nextSettings"..tostring(pagePlayerSettings[name] + 1).."'>"..playerLanguage[name].tr.nextMessage.."</a>")
      end
    end

    return
  end

  for name, data in pairs(tfm.get.room.playerList) do
    if settings[name] then
      ui.addWindow(24, ""..playerLanguage[name].tr.titleSettings.."", name, 125, 60, 650, 300, 1, false, true, playerLanguage[name].tr.closeUIText)
      ui.addTextArea(99992, ""..playerLanguage[name].tr.textSettings.."", name, 150, 110, 500, 200, 0x161616, 0x161616, 0, true)
      if pagePlayerSettings[name] == 1 then
        settingsPageOne(name)
      elseif pagePlayerSettings[name] == 2 then
        settingsPageTwo(name)
      end

      if pagePlayerSettings[name] == 1 then
        buttonNextOrPrev(26, name, 125, 300, 200, 30, 1, "<n2>"..playerLanguage[name].tr.previousMessage.."</n>")
      else
        buttonNextOrPrev(26, name, 125, 300, 200, 30, 1, "<a href='event:prevSettings"..tostring(pagePlayerSettings[name] - 1).."'>"..playerLanguage[name].tr.previousMessage.."</a>")
      end
      
      if pagePlayerSettings[name] == maxPageSettings then
        buttonNextOrPrev(27, name, 575, 300, 200, 30, 1, "<n2>"..playerLanguage[name].tr.nextMessage.."</n>")
      else
        buttonNextOrPrev(27, name, 575, 300, 200, 30, 1, "<a href='event:nextSettings"..tostring(pagePlayerSettings[name] + 1).."'>"..playerLanguage[name].tr.nextMessage.."</a>")
      end
    end
  end
end



--[[ src/ui/addWindow/showMessageWinner.lua ]]--

function showMessageWinner()
  if gameStats.teamsMode or gameStats.threeTeamsMode then
    ui.addTextArea(6, "<p align='center'><font size='30px'><textformat leading='150'><br>"..messageWinners[1].."", nil, 0, 0, 800, 400, 0x161616, 0x161616, 0.8, true)
    return
  end
  if score_red >= gameStats.winscore then
    for name, data in pairs(tfm.get.room.playerList) do
      ui.addTextArea(6, "<p align='center'><font size='30px'><textformat leading='150'><br><r>"..playerLanguage[name].tr.msgRedWinner.."<n>", nil, 0, 0, 800, 400, 0x161616, 0x161616, 0.8, true)
    end
  elseif score_blue >= gameStats.winscore then
    for name, data in pairs(tfm.get.room.playerList) do
      ui.addTextArea(6, "<p align='center'><font size='30px'><textformat leading='150'><br><bv>"..playerLanguage[name].tr.msgBlueWinner.."<n>", nil, 0, 0, 800, 400, 0x161616, 0x161616, 0.8, true)
    end
  end
end


--[[ src/ui/addWindow/showTheScore.lua ]]--

function showTheScore()
  if gameStats.realMode then
    ui.addTextArea(0, "<p align='center'><font size='40px'><r>"..score_red.."<n>", nil, 1150, 20, 100, 100, 0x161616, 0x161616, 0, false)
    ui.addTextArea(1, "<p align='center'><font size='40px'><bv>"..score_blue.."<n>", nil, 1350, 20, 100, 100, 0x161616, 0x161616, 0, false)
    ui.addTextArea(899899, "<p align='center'><font size='20px'><b><r>"..gameStats.redQuantitySpawn.."/"..gameStats.redLimitSpawn.."<n></b>", nil, 200, 20, 100, 100, 0x161616, 0x161616, 0, true)
    ui.addTextArea(8998991, "<p align='center'><font size='20px'><b><bv>"..gameStats.blueQuantitySpawn.."/"..gameStats.blueLimitSpawn.."<n></b>", nil, 600, 20, 100, 100, 0x161616, 0x161616, 0, true)
    return
  end
  if gameStats.twoTeamsMode then
    ui.addTextArea(899899, "<p align='center'><font size='40px'><bv>"..score_blue.."<n>", nil, 200, 20, 100, 100, 0x161616, 0x161616, 0, false)
    ui.addTextArea(0, "<p align='center'><font size='40px'><r>"..score_red.."<n>", nil, 550, 20, 100, 100, 0x161616, 0x161616, 0, false)
    ui.addTextArea(1, "<p align='center'><font size='40px'><bv>"..score_blue.."<n>", nil, 950, 20, 100, 100, 0x161616, 0x161616, 0, false)
    ui.addTextArea(8998991, "<p align='center'><font size='40px'><r>"..score_red.."<n>", nil, 1300, 20, 100, 100, 0x161616, 0x161616, 0, false)

    return
  end
  if gameStats.threeTeamsMode and gameStats.typeMap == "large4v4" then
    ui.addTextArea(0, "<p align='center'><font size='40px'><r>"..teamsLifes[2].red.."<n>", nil, 350, 20, 100, 100, 0x161616, 0x161616, 0, false)
    ui.addTextArea(1, "<p align='center'><font size='40px'><bv>"..teamsLifes[3].blue.."<n>", nil, 850, 20, 100, 100, 0x161616, 0x161616, 0, false)
    ui.addTextArea(8998991, "<p align='center'><font size='40px'><vp>"..teamsLifes[4].green.."<n>", nil, 1350, 20, 100, 100, 0x161616, 0x161616, 0, false)

    return
  elseif gameStats.threeTeamsMode and gameStats.typeMap == "large3v3" then
    if getTeamsLifes[1] == nil or getTeamsLifes[2] == nil then
      return
    end
    if getTeamsColors[1] == nil or getTeamsColors[2] == nil then
      return
    end

    ui.removeTextArea(1)
    ui.removeTextArea(8998991)

    ui.addTextArea(899899, "<p align='center'><font size='40px'>"..getTeamsColors[1]..""..getTeamsLifes[1].."<n>", nil, 200, 20, 100, 100, 0x161616, 0x161616, 0, false)
    ui.addTextArea(0, "<p align='center'><font size='40px'>"..getTeamsColors[2]..""..getTeamsLifes[2].."<n>", nil, 900, 20, 100, 100, 0x161616, 0x161616, 0, false)

    return
  end

  if gameStats.teamsMode and gameStats.typeMap == "large4v4" then
    ui.addTextArea(899899, "<p align='center'><font size='40px'><j>"..teamsLifes[1].yellow.."<n>", nil, 200, 20, 100, 100, 0x161616, 0x161616, 0, false)
    ui.addTextArea(0, "<p align='center'><font size='40px'><r>"..teamsLifes[2].red.."<n>", nil, 550, 20, 100, 100, 0x161616, 0x161616, 0, false)
    ui.addTextArea(1, "<p align='center'><font size='40px'><bv>"..teamsLifes[3].blue.."<n>", nil, 950, 20, 100, 100, 0x161616, 0x161616, 0, false)
    ui.addTextArea(8998991, "<p align='center'><font size='40px'><vp>"..teamsLifes[4].green.."<n>", nil, 1300, 20, 100, 100, 0x161616, 0x161616, 0, false)
    return
  end

  if gameStats.teamsMode and gameStats.typeMap == "large3v3" then
    if getTeamsLifes[1] == nil or getTeamsLifes[2] == nil or getTeamsLifes[3] == nil then
      return
    end
    if getTeamsColors[1] == nil or getTeamsColors[2] == nil or getTeamsColors[3] == nil then
      return
    end
    ui.addTextArea(899899, "<p align='center'><font size='40px'>"..getTeamsColors[1]..""..getTeamsLifes[1].."<n>", nil, 200, 20, 100, 100, 0x161616, 0x161616, 0, false)
    ui.addTextArea(0, "<p align='center'><font size='40px'>"..getTeamsColors[2]..""..getTeamsLifes[2].."<n>", nil, 550, 20, 100, 100, 0x161616, 0x161616, 0, false)
    ui.addTextArea(1, "<p align='center'><font size='40px'>"..getTeamsColors[3]..""..getTeamsLifes[3].."<n>", nil, 900, 20, 100, 100, 0x161616, 0x161616, 0, false)
    return
  end

  if gameStats.teamsMode and gameStats.typeMap == "small" then
    if getTeamsLifes[1] == nil or getTeamsLifes[2] == nil then
      return
    end
    if getTeamsColors[1] == nil or getTeamsColors[2] == nil then
      return
    end
    ui.addTextArea(0, "<p align='center'><font size='40px'>"..getTeamsColors[1]..""..getTeamsLifes[1].."<n>", nil, 0, 20, 100, 100, 0x161616, 0x161616, 0, false)
    ui.addTextArea(1, "<p align='center'><font size='40px'>"..getTeamsColors[2]..""..getTeamsLifes[2].."<n>", nil, 700, 20, 100, 100, 0x161616, 0x161616, 0, false)
    return
  end

  if gameStats.gameMode == "3v3" then
    ui.addTextArea(0, "<p align='center'><font size='40px'><r>"..score_red.."<n>", nil, 0, 20, 100, 100, 0x161616, 0x161616, 0, false)
    ui.addTextArea(1, "<p align='center'><font size='40px'><bv>"..score_blue.."<n>", nil, 700, 20, 100, 100, 0x161616, 0x161616, 0, false)
  elseif gameStats.gameMode == "4v4" then
    ui.addTextArea(0, "<p align='center'><font size='40px'><r>"..score_red.."<n>", nil, 200, 20, 100, 100, 0x161616, 0x161616, 0, false)
    ui.addTextArea(1, "<p align='center'><font size='40px'><bv>"..score_blue.."<n>", nil, 900, 20, 100, 100, 0x161616, 0x161616, 0, false)
  else
    ui.addTextArea(0, "<p align='center'><font size='40px'><r>"..score_red.."<n>", nil, 200, 20, 100, 100, 0x161616, 0x161616, 0, false)
    ui.addTextArea(1, "<p align='center'><font size='40px'><bv>"..score_blue.."<n>", nil, 1500, 20, 100, 100, 0x161616, 0x161616, 0, false)
  end
end


--[[ src/ui/addWindow/windowForHelp.lua ]]--

function windowForHelp(name, pageOfPlayer, textNext, textPrev)
  removeUITrophies(name)
  local pageList = #trad.helpText
  ui.addWindow(24, ""..playerLanguage[name].tr.helpTitle..""..playerLanguage[name].tr.helpText[pageOfPlayer].text.."", name, 125, 60, 650, 300, 1, false, true, playerLanguage[name].tr.closeUIText)
  if pageOfPlayer >= 1 and pageOfPlayer < pageList then
    local page = pageOfPlayer + 1
    buttonNextOrPrev(25, name, 540, 300, 200, 30, 1, "<a href='event:nextHelp"..tostring(page).."'>"..textNext.."</a>")
  else
    buttonNextOrPrev(25, name, 540, 300, 200, 30, 1, "<n2>"..textNext.."")
  end
  if pageOfPlayer > 1 then
    local page = pageOfPlayer - 1
    buttonNextOrPrev(26, name, 160, 300, 200, 30, 1, "<a href='event:prevHelp"..tostring(page).."'>"..textPrev.."</a>")
  else
    buttonNextOrPrev(26, name, 160, 300, 200, 30, 1, "<n2>"..textPrev.."")
  end
end


--[[ src/ui/addWindow/windowUiSync.lua ]]--

function windowUISync(name)
  local playersSync = {}
  closeRankingUI(name)
  openRank[name] = false
  for name1, data in pairs(tfm.get.room.playerList) do
    local playerSync = tfm.get.room.playerList[name1].averageLatency
    local syncCondition = textSyncCondition(tfm.get.room.playerList[name1].averageLatency)
    
    if not playerLeft[name1] then
      playersSync[#playersSync + 1] = { name = name1, sync = tfm.get.room.playerList[name1].averageLatency, syncCondition = syncCondition }
    end
  end
  
  table.sort(playersSync, function(a, b) return a.sync < b.sync end)
  
  local str = ""
  for i = 1, 3 do
    if playersSync[i] ~= nil then
      str = ""..str.."<p align='left'><font size='12px'><a href='event:sync"..playersSync[i].name.."'>"..playersSync[i].name.."</a></p><p align='right'><font size='12px'>"..playersSync[i].syncCondition.."</p><br><br>"
    end
  end
  
  ui.addWindow(24, "<p align='center'><font size='14px'>Select player sync (click on player name to select the sync)</p><br><br><p align='left'><font size='12px'>Player</p><p align='right'><font size='12px'>Sync condition</p><br>"..str.."", name, 125, 60, 650, 300, 1, false, true, playerLanguage[name].tr.closeUIText)
end


--[[ src/ui/removeWindow/closeAllWindows.lua ]]--

function closeAllWindows(name)
  openRank[name] = false
  selectMapOpen[name] = false
  selectMapPage[name] = 1
  local ids = {21, 22, 24, 25, 44}
  for i=1, #ids do
    closeWindow(ids[i], name)
  end
  removeUITrophies(name)
  removeSelectUI(name)
  ui.removeTextArea(99992, name)
  closeWindow(266, name)
  removeButtons(25, name)
  removeButtons(26, name)
  removeButtons(27, name)
  settings[name] = false
  settingsMode[name] = false
  
  closeRankingUI(name)
end


--[[ src/ui/removeWindow/closeRankingUi.lua ]]--

function closeRankingUI(name)
  for i = 9999543, 9999565 do
    ui.removeTextArea(i, name)
  end
end


--[[ src/ui/removeWindow/closeWindow.lua ]]--

function closeWindow(id, name)
  local id = tostring(id)
  local str = "0"
  ui.removeTextArea(id, name)
  for i = 1, 9 do
    ui.removeTextArea(id..""..str.."", name)
    str = ""..str.."0"
  end
end



--[[ src/ui/removeWindow/removeButtons.lua ]]--

function removeButtons(id, name)
  local id = tostring(id)
  local str = "000000000"
  ui.removeTextArea(id, name)
  for i = 10, 14 do
    ui.removeTextArea(id..""..str.."", name)
    str = ""..str.."0"
  end
end


--[[ src/ui/removeWindow/removeSelectUi.lua ]]--

function removeSelectUI(name)
  local ids = {99999, 999999, 9999999, 99999999, 999999999}

  for i = 1, 5 do
    for j = 1, 5 do
      ui.removeTextArea(""..tostring(ids[i])..""..j.."", name)
    end
  end

  ui.removeTextArea(9999999999, name)

  for i = 1, #selectMapImages[name] do
    tfm.exec.removeImage(selectMapImages[name][i])
  end
end


--[[ src/ui/removeWindow/removeTextAreasOfLobby.lua ]]--

function removeTextAreasOfLobby()
  for i = 1, 13 do
    ui.removeTextArea(i)
  end
end


--[[ src/ui/removeWindow/removeWindowsOnBottom.lua ]]--

function removeWindowsOnBottom()
  closeWindow(30, nil)
  closeWindow(31, nil)
end


--[[ src/ui/removeWindow/trophies/removePlayerTrophy.lua ]]--

function removePlayerTrophy(name)
  if playerTrophyImage[name] ~= 0 then
    tfm.exec.removeImage(playerTrophyImage[name])
    playerTrophyImage[name] = 0
    removeTimer("trophy"..name.."")
  end
end


--[[ src/ui/removeWindow/trophies/removePlayerTrophyImage.lua ]]--

function removePlayerTrophyImage(name)
  local removeImage = addTimer(function(i)
    if i == 1 then
      if playerTrophyImage[name] ~= 0 then
        tfm.exec.removeImage(playerTrophyImage[name])
        playerTrophyImage[name] = 0
      end
    end
  end, 10000, 1, "trophy"..name.."")
end


--[[ src/ui/removeWindow/trophies/removeUiTrophies.lua ]]--

function removeUITrophies(name)
  isOpenProfile[name] = false
  
  local ids = {26, 27, 28, 29, 32, 33}
  for i = 1, #ids do
    closeWindow(ids[i], name)
  end
  
  for i = 1, #playerAchievementsImages[name] do
    tfm.exec.removeImage(playerAchievementsImages[name][i])
  end
  
  playerAchievementsImages[name] = {}
end


--[[ src/init.lua ]]--

function init()
  spawnBallArea400 = {}
  spawnBallArea800 = {}
  spawnBallArea1200 = {}
  spawnBallArea1600 = {}
  
  lobbySpawn = {}
  
  playersSpawn400 = {}
  playersSpawn800 = {}
  playersSpawn1200 = {}
  playersSpawn1600 = {}
  
  durationDefault = 300
  duration = os.time() + durationDefault * 1000
  durationTimerPause = durationDefault

  playersOnGameHistoric = {}
  mode = "startGame"
  removeTimer('verifyBallCoordinates')
  playerConsumables = {}
  
  ballOnGame = false
  ballOnGame2 = false
  ballOnGame3 = false
  ballOnGameTwoBalls = {ballOnGame, ballOnGame2, ballOnGame3}
  ballsId = {nil, nil, nil}
  tfm.exec.disableAllShamanSkills(true)
  
  playerCanTransform = {}
  playerInGame = {}
  
  twoTeamsPlayerRedPosition = { [1] = "", [2] = "", [3] = "", [4] = "", [5] = "", [6] = "" }
  twoTeamsPlayerBluePosition = { [1] = "", [2] = "", [3] = "", [4] = "", [5] = "", [6] = "" }
  
  playersRed = {
    [1] = {name = ''},
    [2] = {name = ''},
    [3] = {name = ''},
    [4] = {name = ''},
    [5] = {name = ''},
    [6] = {name = ''}
  }
  playersBlue = {
    [1] = {name = ''},
    [2] = {name = ''},
    [3] = {name = ''},
    [4] = {name = ''},
    [5] = {name = ''},
    [6] = {name = ''} 
  }
  playersYellow = {
    [1] = {name = ''},
    [2] = {name = ''},
    [3] = {name = ''}
  }

  playersGreen = {
    [1] = {name = ''},
    [2] = {name = ''},
    [3] = {name = ''}
  }

  teamsLifes = { [1] = {yellow = 3}, [2] = {red = 3}, [3] = {blue = 3}, [4] = {green = 3} }

  mapsToTest = { [1] = "", [2] = "", [3] = "" }

  getTeamsLifes = {}

  getTeamsColors = {}
  teamsPlayersOnGame = {}

  messageTeamsLifes = {}
  messageTeamsLostOneLife = {}
  messageTeamsLifesTextChat = {}
  messageWinners = {}
  
  getTeamsColorsName = {0xF59E0B, 0xEF4444, 0x3B82F6, 0x109267}

  for i = 1, #customMaps do
    mapsVotes[i] = 0
  end

  gameStats = {
    gameMode = '', redX = 0, blueX = 0, yellowX = 0, greenX = 0, redX2 = 0, blueX2 = 0,
    setMapName = '', winscore = 7, initTimer = 0,
    isCustomMap = false, randomMap = false, customMapIndex = 0, totalVotes = 0,
    mapIndexSelected = 0, canTransform = false, teamsMode = false, canJoin = true,
    customBall = true, customBallId = 12,
    banCommandIsEnabled = true, killSpec = false, isGamePaused = false,
    psyhicObjectForce = 1, twoTeamsMode = false, enableAfkMode = false,
    realMode = false, redServeIndex = 1, blueServeIndex = 1, redPlayerServe = "",
    bluePlayerServe = "", redServe = false, blueServe = false,
    redQuantitySpawn = 0, redLimitSpawn = 3, blueQuantitySpawn = 0, blueLimitSpawn = 3,
    lastPlayerRed = "", lastPlayerBlue = "", teamWithOutAce = "",
    reduceForce = false, aceRed = false, aceBlue = false,
    twoBalls = false, consumables = false, actualMode = "", stopTimer = false, threeTeamsMode = false,
    threeBalls = false, admins = ""
  }

  playerCoordinates = {}
  countId = 1
  playerPhysicId = {}
  score_red = 0
  score_blue = 0
  ball_id = 0
  lobby_map = '<C><P/><Z><S><S T="6" X="400" Y="385" L="800" H="50" P="0,0,0.3,0.2,0,0,0,0"/><S T="12" X="-5" Y="205" L="10" H="410" P="0,0,0,0.2,0,0,0,0" o="FF0000" m=""/><S T="12" X="805" Y="205" L="10" H="410" P="0,0,0,0.2,0,0,0,0" o="FF0000" m=""/><S T="12" X="400" Y="5" L="810" H="10" P="0,0,0,0.2,0,0,0,0" o="FF0000" m=""/><S T="12" X="445" Y="95" L="710" H="10" P="0,0,0.3,0.2,0,0,0,0" o="FF0000" m=""/><S T="9" X="45" Y="225" L="90" H="270" P="0,0,0,0,0,0,0,0" m=""/></S><D><P X="217" Y="359" T="6" P="0,0"/><P X="580" Y="363" T="4" P="0,0"/><P X="319" Y="360" T="5" P="0,0"/><P X="0" Y="0" T="257" P="0,0"/><DS X="400" Y="349"/></D><O/><L/></Z></C>'
  
  tfm.exec.newGame(lobby_map)

  if globalSettings.mode == "4 teams mode" then
    gameStats.teamsMode = true
    getTeamsColorsName = {0xF59E0B, 0xEF4444, 0x3B82F6, 0x109267}
    teamsLifes = { [1] = {yellow = 3}, [2] = {red = 3}, [3] = {blue = 3}, [4] = {green = 3} }
    updateLobbyTextAreas()
    tfm.exec.chatMessage("<bv>Room Setup: The room has been configured for "..globalSettings.mode.."<n>", nil)
  elseif globalSettings.mode == "3 teams mode" then
    gameStats.threeTeamsMode = true
    getTeamsColorsName = {0xEF4444, 0x3B82F6, 0x109267}
    playersYellow = {
      [1] = {name = ''},
      [2] = {name = ''},
      [3] = {name = ''},
      [4] = {name = ''}
    }

    playersGreen = {
      [1] = {name = ''},
      [2] = {name = ''},
      [3] = {name = ''},
      [4] = {name = ''}
    }

    teamsLifes = { [1] = {yellow = 5}, [2] = {red = 5}, [3] = {blue = 5}, [4] = {green = 5} }
    updateLobbyTextAreas()
    tfm.exec.chatMessage("<bv>Room Setup: The room has been configured for "..globalSettings.mode.."<n>", nil)
  elseif globalSettings.mode == "2 teams mode" then
    gameStats.twoTeamsMode = true
    tfm.exec.chatMessage("<bv>Room Setup: The room has been configured for "..globalSettings.mode.."<n>", nil)
  elseif globalSettings.mode == "Real mode" then
    gameStats.realMode = true
    tfm.exec.chatMessage("<bv>Room Setup: The room has been configured for "..globalSettings.mode.."<n>", nil)
  end

  if globalSettings.threeBalls then
    gameStats.threeBalls = true
    tfm.exec.chatMessage("<bv>Room Setup: The three-ball mode has been activated", nil)
  end

  if globalSettings.twoBalls then
    gameStats.twoBalls = true
    tfm.exec.chatMessage("<bv>Room Setup: The two-ball mode has been activated<n>", nil)
  end

  if globalSettings.randomBall then
    gameStats.customBall = true

    tfm.exec.chatMessage("<bv>Room Setup: The random ball mode has been activated<n>", nil)
    
    local indexBall= math.random(1, #balls)
    gameStats.customBallId = indexBall
    
  end

  if globalSettings.randomMap then
    gameStats.randomMap = true
    gameStats.isCustomMap = true
    local indexMap = ''
    
    tfm.exec.chatMessage("<bv>Room Setup: The random map mode has been activated<n>", nil)
    
    for name1, data in pairs(tfm.get.room.playerList) do
      if selectMapOpen[name1] then
        selectMapUI(name1)
      end
    end
    
    if gameStats.twoTeamsMode or gameStats.teamsMode then
      indexMap = math.random(1, #customMapsFourTeamsMode)
      gameStats.customMapIndex = indexMap
      tfm.exec.chatMessage('<bv>'..customMapsFourTeamsMode[gameStats.customMapIndex][3]..' map (created by '..customMapsFourTeamsMode[gameStats.customMapIndex][4]..') selected randomly<n>', nil)
      print('<bv>'..customMapsFourTeamsMode[gameStats.customMapIndex][3]..' map (created by '..customMapsFourTeamsMode[gameStats.customMapIndex][4]..') selected randomly<n>')
    elseif gameStats.threeTeamsMode then
      indexMap = math.random(1, #customMapsThreeTeamsMode)
      gameStats.customMapIndex = indexMap
      tfm.exec.chatMessage('<bv>'..customMapsFourTeamsMode[gameStats.customMapIndex][3]..' map (created by '..customMapsFourTeamsMode[gameStats.customMapIndex][4]..') selected randomly<n>', nil)
      
    elseif not gameStats.realMode then
      indexMap = math.random(1, #customMaps)
      gameStats.customMapIndex = indexMap
      
      tfm.exec.chatMessage('<bv>'..customMaps[gameStats.customMapIndex][3]..' map (created by '..customMaps[gameStats.customMapIndex][4]..') selected randomly<n>', nil)
    end
  end

  if not gameStats.teamsMode and not gameStats.twoTeamsMode and not gameStats.realmode then
    if globalSettings.consumables then
      gameStats.consumables = true

      tfm.exec.chatMessage("<bv>Room Setup: Consumables has been activated in normal mode<n>", nil)
    end

    if globalSettings.mapType ~= '' then
      gameStats.setMapName = globalSettings.mapType

      tfm.exec.chatMessage("<bv>Room Setup: The map size has been set to "..globalSettings.mapType.."<n>", nil)
    end
  end

  for name, data in pairs(tfm.get.room.playerList) do
    playerLeftRight[name] = 0
    playerConsumableKey[name] = 56
    playerConsumable[name] = true
    playerConsumableItem[name] = 80
    playerForce[name] = 0
    playerCanTransform[name] = true
    playerInGame[name] = false
    playerCoordinates[name] = {x = 0, y = 0}
    playerPhysicId[name] = 0
    playersOnGameHistoric[name] = { teams = {} }

    for i = 1, #keys do
      system.bindKeyboard(name, keys[i], true, true)
    end

    tfm.exec.setNameColor(name, 0xD1D5DB)
    tfm.exec.setPlayerScore(name, 0, false)
    pagesList[name] = {helpPage = 1}
    canVote[name] = true
    
    if selectMapOpen[name] then
      selectMapPage[name] = 1
      selectMapUI(name)
    end
    
    if admins[name] then
      ui.addWindow(31, "<p align='center'><font size='13px'><a href='event:settings'>Room settings", name, 180, 370, 150, 30, 1, false, false, _)
    end
  end

  ui.addWindow(23, "<p align='center'><font size='13px'><a href='event:menuOpen'>Menu", nil, 5, 15, 100, 30, 0.2, false, false, _)
  ui.addWindow(30, "<p align='center'><font size='13px'><a href='event:selectMap'>Select a map", nil, 10, 370, 150, 30, 1, false, false, _)
  
  ui.removeTextArea(0)
  ui.addTextArea(7, "<p align='center'>", nil, 375, 50, 30, 20, 0x161616, 0x161616, 1, false)

  if not gameStats.teamsMode then
    for i = 1, 3 do
      ui.addTextArea(i, "<p align='center'><font size='14px'><a href='event:joinTeamRed"..i.."'>Join", nil, x[i], y[i], 150, 40, 0xE14747, 0xE14747, 1, false)
    end
    
    for i = 4, 6 do
      ui.addTextArea(i, "<p align='center'><font size='14px'><a href='event:joinTeamBlue"..i.."'>Join", nil, x[i], y[i], 150, 40, 0x184F81, 0x184F81, 1, false)
    end
    
    for i = 8, 10 do
      ui.addTextArea(i, "<p align='center'><font size='14px'><a href='event:joinTeamRed"..(i - 4).."'>Join", nil, x[i - 1], y[i - 1], 150, 40, 0xE14747, 0xE14747, 1, false)
    end
    
    for i = 11, 13 do
      ui.addTextArea(i, "<p align='center'><font size='14px'><a href='event:joinTeamBlue"..(i - 4).."'>Join", nil, x[i - 1], y[i - 1], 150, 40, 0x184F81, 0x184F81, 1, false)
    end
  end

  afkSystem() 

  initGame = os.time() + 25000

  if not checkRoomkAdmins() then
    spawnGetAdminButton()
  end
end

init()
